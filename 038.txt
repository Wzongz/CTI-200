{
    "event_id": "038",
    "claim": "The document 'BITTER APT: Not So Sweet' analyzes the sophisticated cyber espionage tactics of the BITTER APT group, specifically targeting Pakistani entities, and explores the technical and geopolitical ramifications of their operations.",
    "original_label": "true",
    "label": "true",
    "explain": "BITTER, an APT group which has been active since 2015, has been observed ramping up their activity lately. In this post, I will review recent infrastructure that is actively being used by this APT, which is suspected of being used to carry out attacks against Pakistani organizations.The BITTER APT group has notably been observed targeting Chinese and Pakistani interests in the past, and is suspected of being belonging to a country in South Asia. Recent reports from QiAnXin Technology’s “RedDrip” team, a Chinese security vendor, suggest that the BITTER APT group is actively launching attacks targeting Pakistani organizations. According to this , they are seeing malicious documents causing users to download payloads from maq.com.pk/wehs, which looks to be ArtraDownloader. ArtraDownloader is a Trojan Downloader that was discovered by PaloAlto’s UNIT42, and has also been observed downloading BitterRAT Remote Access Trojan, both of which have been associated with BITTER APT groups operations. Researching for activity related to ArtraDownloader on App.Any.Run reveals numerous examples of malicious Microsoft Word documents exploiting the CVE-2017-11882 vulnerability to download an executable payload from the aforementioned URL identified by RedDrip (maq.com.pk). CVE-2017-11882, which was patched by Microsoft in November of 2017, is a memory corruption vulnerability which grants the attacker RCE (remote code execution) upon the user opening a specially crafted file (see here for the Microsoft advisory). These Any.Run analyses indicate that, after exploitation and download of the ArtraDownloader from maq.com.pk, there is Command & Control activity beaconing to the URL onlinejohnline99.org/kvs06v.php. Pivoting off of Any.Run and into VirusTotal we can see that onlinejohnline99.org appears to be the Command & Control for several binaries, which are actively being distributed from several undiscovered domains. We already know about maq.com.pk, however because of VirusTotal’s relational graphing abilities, we are able to see that these binaries are also being served from biocons.pk, gandharaart.org, and sartetextile.com. One thing of interest, however notable, is all of the domains delivering these binaries are hosted by the same ISP (COMSATS, a Pakistani ISP). Digging deeper into the IP addresses hosting these domains (203.124.44.31, 203.124.44.66, 203.124.44.93, and 203.124.43.227) revealed that they were only hosting a very limited amount of domains, many of which appeared to be very suspect in naming convention or content. While these were suspicious, I could not directly relate them to BITTER APT activity at this time.Analysis of the discovered binaries confirm them to be ArtraDownloader samples, with variations in naming and hash values (such as intelx.exe, lsasw.exe, advrt.exe, wehs.exe, reportstableregular.doc.exe, and more). I won’t go into details surrounding the actual analysis of the malware samples as PaloAlto’s UNIT42 has already gone over this at length in their article found here and the binaries I reviewed do not appear to differ significantly from what was described in their write-up. All of the samples I reviewed utilized onlinejohnline99.org as their primary Command & Control infrastructure, with the exception of one sample which instead beaconed to the domain advas.zhongwenchuantongqiye.com, which was documented as being related to BITTER operations targeting the Chinese government in May of 2019 by 360-CERT. The Command & Control communications are typical for what we would see from ArtraDownloader, with all of the samples performing HTTP POST requests to their respective Command & Control domains with differing .php URI structures. Various strings within these samples are obfuscated by adding or subtracting from each byte within a string, and the data being POST’d to these C2 servers is no exception. In order to decode this data, you can use the following Python script provided by UNIT42 in their analysis of the downloader. Once you have deobfuscated the data, you’ll quickly see that it contains the typical identifying information that is obtained during initial infections, such as hostname, Windows version, username, unique identifier, and a Boolean value indicating if the second stage payload was downloaded and executed successfully.During my analysis, I was unable to obtain a second stage payload to further examine the BITTER APT infrastructure. However the additional payload would likely have been the BitterRAT Remote Access Trojan, which is routinely distributed by ArtraDownloader variants. Once installed, the BITTER actors could then pivot and perform various other action on objectives. At this time, the motives of this group is unknown, however it is likely that this campaign is in pursuit of some form of espionage due to the reports of them being backed by a south Asian country (some reports indicate India). Based on much of the infrastructure observed being hosted in Pakistan, I would agree with the initial suspicion that Pakistan is being targeted in these attacks. This would also further reaffirm the possible Indian attribution to BITTER APT, due to the long-running unrest regarding the Kashmir territorial conflict between India and Pakistan over the Kashmir region.\n\n\n",
    "reports": [
        {
            "link": "https://blog.talosintelligence.com/bitter-apt-adds-bangladesh-to-their/",
            "content": "Next, the malware requests the program data. The Malicious RTF document is weaponized to exploit the stack overflow vulnerability CVE-2017-11882, which enables arbitrary code execution on victims' machines running vulnerable versions of Microsoft Office. The adversary typically downloads malware onto compromised endpoints from their hosting server via HTTP and uses DNS to establish contact with the command and control. The trojan masquerades as a Windows Security update service and allows the malicious actor to perform remote code execution, opening the door to other activities by installing other tools. This trojan is a downloader that downloads and executes the remote file. We assess with moderate confidence that this campaign is operated by Bitter based on the use of the same C2 IP address from previous campaigns and similarities in the decrypted strings of the payload, such as module names, payload executable name, paths and the constants.",
            "domain": "blog.talosintelligence.com",
            "tokenized": [
                {
                    "sent":  "Next, the malware requests the program data.",
                    "is_evidence": 1,
                    "is_repeat": 0
                },
                {
                    "sent":   "The Malicious RTF document is weaponized to exploit the stack overflow vulnerability CVE-2017-11882, which enables arbitrary code execution on victims' machines running vulnerable versions of Microsoft Office.",
                    "is_evidence": 0
                },
                {
                    "sent": "The adversary typically downloads malware onto compromised endpoints from their hosting server via HTTP and uses DNS to establish contact with the command and control.",
                    "is_evidence": 0
                },
                {
                    "sent": "The trojan masquerades as a Windows Security update service and allows the malicious actor to perform remote code execution, opening the door to other activities by installing other tools.",
                    "is_evidence": 0
                },
                {
                    "sent": "This trojan is a downloader that downloads and executes the remote file.",
                    "is_evidence": 0
                },
                {
                    "sent": "We assess with moderate confidence that this campaign is operated by Bitter based on the use of the same C2 IP address from previous campaigns and similarities in the decrypted strings of the payload, such as module names, payload executable name, paths and the constants.",
                     "is_evidence": 0
                }
            ]
        },
        {
            "link": "https://meltx0r.github.io/tech/2019/09/06/bitter-apt-not-so-sweet.html/",
            "content":  "According to this , they are seeing malicious documents causing users to download payloads from maq.com.pk/wehs, which looks to be ArtraDownloader. ArtraDownloader is a Trojan Downloader that was discovered by PaloAlto’s UNIT42, and has also been observed downloading BitterRAT Remote Access Trojan, both of which have been associated with BITTER APT groups operations. However the additional payload would likely have been the BitterRAT Remote Access Trojan, which is routinely distributed by ArtraDownloader variants. In this post, I will review recent infrastructure that is actively being used by this APT, which is suspected of being used to carry out attacks against Pakistani organizations. Recent reports from QiAnXin Technology’s “RedDrip” team, a Chinese security vendor, suggest that the BITTER APT group is actively launching attacks targeting Pakistani organizations. Run reveals numerous examples of malicious Microsoft Word documents exploiting the CVE-2017-11882 vulnerability to download an executable payload from the aforementioned URL identified by RedDrip (maq.com.pk).",
            "domain": "meltx0r.github.io",
            "tokenized": [
                {
                    "sent":  "According to this , they are seeing malicious documents causing users to download payloads from maq.com.pk/wehs, which looks to be ArtraDownloader.",
                    "is_evidence": 1,
                    "is_repeat": 0
                },
                {
                    "sent":  "ArtraDownloader is a Trojan Downloader that was discovered by PaloAlto’s UNIT42, and has also been observed downloading BitterRAT Remote Access Trojan, both of which have been associated with BITTER APT groups operations.",
                    "is_evidence": 0
                },
                {
                    "sent": "However the additional payload would likely have been the BitterRAT Remote Access Trojan, which is routinely distributed by ArtraDownloader variants.",
                    "is_evidence": 1,
                    "is_repeat": 0
                },
                {
                    "sent": "In this post, I will review recent infrastructure that is actively being used by this APT, which is suspected of being used to carry out attacks against Pakistani organizations.",
                    "is_evidence": 1,
                    "is_repeat": 0
                },
                {
                    "sent": "Recent reports from QiAnXin Technology’s “RedDrip” team, a Chinese security vendor, suggest that the BITTER APT group is actively launching attacks targeting Pakistani organizations.",
                    "is_evidence": 1,
                    "is_repeat": 0
                },
                {
                    "sent": "Run reveals numerous examples of malicious Microsoft Word documents exploiting the CVE-2017-11882 vulnerability to download an executable payload from the aforementioned URL identified by RedDrip (maq.com.pk).",
                    "is_evidence": 1,
                    "is_repeat": 0
                }
            ]
        },
        {
            "link": "https://securelist.com/zero-day-vulnerability-in-desktop-window-manager-cve-2021-28310-used-in-the-wild/101898/",
            "content":  "It is an escalation of privilege (EoP) exploit that is likely used together with other browser exploits to escape sandboxes or get system privileges for further access. Microsoft released a patch to this vulnerability as a part of its April security updates. More information about BITTER APT and IOCs are available to customers of the Kaspersky Intelligence Reporting service. The exploit was initially identified by our advanced exploit prevention technology and related detection records. We believe this exploit is used in the wild, potentially by several threat actors. While analyzing the CVE-2021-1732 exploit originally discovered by the DBAPPSecurity Threat Intelligence Center and used by the BITTER APT group, we discovered another zero-day exploit we believe is linked to the same actor.",
            "domain": "securelist.com",
            "tokenized": [
                {
                    "sent": "It is an escalation of privilege (EoP) exploit that is likely used together with other browser exploits to escape sandboxes or get system privileges for further access.",
                    "is_evidence": 1,
                    "is_repeat": 0
                },
                {
                    "sent": "Microsoft released a patch to this vulnerability as a part of its April security updates.",
                    "is_evidence": 0
                },
                {
                    "sent": "More information about BITTER APT and IOCs are available to customers of the Kaspersky Intelligence Reporting service.",
                    "is_evidence": 0
                },
                {
                    "sent":  "The exploit was initially identified by our advanced exploit prevention technology and related detection records.",
                    "is_evidence": 0
                },
                {
                    "sent": "We believe this exploit is used in the wild, potentially by several threat actors.",
                    "is_evidence": 0
                },
                {
                    "sent":  "While analyzing the CVE-2021-1732 exploit originally discovered by the DBAPPSecurity Threat Intelligence Center and used by the BITTER APT group, we discovered another zero-day exploit we believe is linked to the same actor.",
                    "is_evidence": 0
                }
            ]
         },
         {
            "link": "https://starmap.dbappsecurity.com.cn/blog/articles/2021/02/10/windows-kernel-zero-day-exploit-is-used-by-bitter-apt-in-targeted-attack/",
            "content":  "In December 2020, DBAPPSecurity Threat Intelligence Center found a new component of BITTER APT. Over the years, vendors over the world have investment a lot on detecting APT attacks. The DBAPPSecurity APT Attack Early Warning Platform (http://dbappsecurity.com/html/show-62-4-1.html) could find known/unknown threat. The detection capability completely covers the entire APT attack chain, effectively discovering APT attacks, unknown threats and network security incidents that users care about. The platform can monitor, capture and analyze the threats of malicious files or programs in real time, and can conduct powerful monitoring of malicious samples such as Trojan horses associated with each stage of email delivery, vulnerability exploitation, installation/implantation and C2. The quality of this vulnerability high and the exploit is sophisticated.",
            "domain": "starmap.dbappsecurity.com.cn",
            "tokenized": [
                {
                    "sent": "In December 2020, DBAPPSecurity Threat Intelligence Center found a new component of BITTER APT.",
                    "is_evidence": 1,
                    "is_repeat": 0
                },
                {
                    "sent":  "Over the years, vendors over the world have investment a lot on detecting APT attacks.",
                    "is_evidence": 0
                },
                {
                    "sent": "The DBAPPSecurity APT Attack Early Warning Platform (http://dbappsecurity.com/html/show-62-4-1.html) could find known/unknown threat.",
                    "is_evidence": 0
                },
                {
                    "sent": "The detection capability completely covers the entire APT attack chain, effectively discovering APT attacks, unknown threats and network security incidents that users care about.",
                    "is_evidence": 0
                },
                {
                    "sent": "The platform can monitor, capture and analyze the threats of malicious files or programs in real time, and can conduct powerful monitoring of malicious samples such as Trojan horses associated with each stage of email delivery, vulnerability exploitation, installation/implantation and C2.",
                    "is_evidence": 0
                },
                {
                    "sent":  "The quality of this vulnerability high and the exploit is sophisticated.",
                    "is_evidence": 0
                }
            ]
        }
    ]
}