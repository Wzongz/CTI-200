{
    "event_id": "190",
    "claim": "Gallmaker: New Attack Group Eschews Malware to Live off the Land,This group eschews custom malware and uses living off the land (LotL) tactics and publicly available hack tools to carry out activities that bear all the hallmarks of a cyber espionage campaign.",
    "original_label": "true",
    "label": "true",
    "explain": "This blog has been updated with a revised list of IoCs. An earlier list of IOCs attached to this blog was generated through an automated system and, due to the dual-use nature of the tools used by the group, erroneously included some low fidelity IoCs. Symantec researchers have uncovered a previously unknown attack group that is targeting government and military targets, including several overseas embassies of an Eastern European country, and military and defense targets in the Middle East. This group eschews custom malware and uses living off the land (LotL) tactics and publicly available hack tools to carry out activities that bear all the hallmarks of a cyber espionage campaign.The group, which we have given the name Gallmaker, has been operating since at least December 2017, with its most recent activity observed in June 2018.The most interesting aspect of Gallmaker’s approach is that the group doesn’t use malware in its operations. Rather, the attack activity we observed is carried out exclusively using LotL tactics and publicly available hack tools. The group takes a number of steps to gain access to a victim’s device and then deploys several different attack tools, as follows: The group delivers a malicious Office lure document to victims, most likely via a spear-phishing email. These lure documents use titles with government, military, and diplomatic themes, and the file names are written in English or Cyrillic languages. These documents are not very sophisticated, but evidence of infections shows that they’re effective. The attackers use filenames that would be of interest to a variety of targets in Eastern Europe, including: bg embassy list.docx Navy.ro members list.docx These lure documents attempt to exploit the Microsoft Office Dynamic Data Exchange (DDE) protocol in order to gain access to victim machines. When the victim opens the lure document, a warning appears asking victims to “enable content” (See Figure 1). Should a user enable this content, the attackers are then able to use the DDE protocol to remotely execute commands in memory on the victim’s system. By running solely in memory, the attackers avoid leaving artifacts on disk, which makes their activities difficult to detect. Once the Gallmaker attackers gain access to a device, they execute various tools, including: WindowsRoamingToolsTask: Used to schedule PowerShell scripts and tasks. A \"reverse_tcp\" payload from Metasploit: The attackers use obfuscated shellcode that is executed via PowerShell to download this reverse shell. A legitimate version of the WinZip console: This creates a task to execute commands and communicate with the command-and-control (C&C) server. It’s likely this WinZip console is used to archive data, probably for exfiltration. The Rex PowerShell library, which is publicly available on GitHub, is also seen on victim machines. This library helps create and manipulate PowerShell scripts for use with Metasploit exploits. Gallmaker is using three primary IP addresses for its C&C infrastructure to communicate with infected devices. There is also evidence that it is deleting some of its tools from victim machines once it is finished, to hide traces of its activity.The DDE protocol can be used for legitimate purposes to send messages between Microsoft applications that share data through shared memory, e.g. to share data between Excel and Word. However, the DDE protocol was flagged as unsecure last year, when researchers discovered it could be exploited to execute code on victim machines via Excel and Word, without macros being enabled in those applications. Microsoft said at the time that this capability was a feature and the company did not consider it a vulnerability because Office always warned users before enabling DDE in documents, as seen in Figure 1. However, after the DDE protocol was subsequently exploited in a number of malware campaigns, Microsoft issued an update to Office in December 2017 that disabled DDE by default in Word and Excel. DDE can be enabled manually after this update is applied but only if the registry is altered by an admin account. The Gallmaker victims we have seen did not have this patch installed and therefore were still vulnerable to exploit via the DDE protocol.Gallmaker’s activity appears to be highly targeted, with its victims all related to government, military, or defense sectors. Several targets are embassies of an Eastern European country. The targeted embassies are located in a number of different regions globally, but all have the same home country. The other targets we have seen are a Middle Eastern defense contractor and a military organization. There are no obvious links between the Eastern European and Middle Eastern targets, but it is clear that Gallmaker is specifically targeting the defense, military, and government sectors: its targets appear unlikely to be random or accidental. Gallmaker’s activity has been quite consistent since we started tracking it. The group has carried out attacks most months since December 2017. Its activity subsequently increased in the second quarter of 2018, with a particular spike in April 2018.Gallmaker’s activity points strongly to it being a cyber espionage campaign, likely carried out by a state-sponsored group. Gallmaker may well have continued to avoid detection were it not for Symantec’s Targeted Attack Analytics (TAA) technology.The fact that Gallmaker appears to rely exclusively on LotL tactics and publicly available hack tools makes its activities extremely hard to detect. We have written extensively about the increasing use of LotL tools and publicly available hack tools by cyber criminals. One of the primary reasons for the increased popularity of these kinds of tools is to avoid detection; attackers are hoping to “hide in plain sight”, with their malicious activity hidden in a sea of legitimate processes. Gallmaker may well have continued to avoid detection were it not for Symantec’s Targeted Attack Analytics (TAA) technology. TAA combines the capabilities of Symantec’s world-leading security experts with advanced artificial intelligence and machine learning to provide organizations with their own “virtual analysts”, via our Advanced Threat Protection (ATP) product. Since its inception, TAA has detected security incidents at thousands of organizations, automating what would have taken many hours of analyst time. In this instance, TAA identified the specific PowerShell commands used by Gallmaker as being suspicious, leading to the discovery of this new campaign. Without TAA’s advanced AI-based capabilities, Gallmaker’s activities may well have remained undetected.Gallmaker also used tools that were available in open source projects. Yara rule and methods shared below were used by Gallmaker but aren't exclusive to the group's activity. Detection of these in one's environment is only indicative of possible unauthorized activity. Each occurrence of triggers must be examined to determine intent.",
    "reports": [
        {
            "link": "https://socprime.com/news/gallmaker-apt-group-attacks-government-and-military-targets/",
            "content": "According to Symantec research, the group was most active in April 2018.As the group uses PowerShell scripts, it is extremely difficult to detect their attacks and malicious activity on infected systems.Delaware, USA – October 11, 2018 — The newly discovered APT group Gallmaker has been active at least since last December and is aimed at the government, military and defense targets in the Middle East and Eastern Europe.Gallmaker uses WindowsRoamingToolsTask to schedule PowerShell scripts and tasks, publicly available Metasploit exploits with the Rex PowerShell library and WinZip console to communicate with command and control servers and exfiltrate data.Gallmaker uses WindowsRoamingToolsTask to schedule PowerShell scripts and tasks, publicly available Metasploit exploits with the Rex PowerShell library and WinZip console to communicate with command and control servers and exfiltrate data.Usually, during an attack, Gallmaker send spear-phishing emails with an attached MS Office document.",
            "domain": "socprime.com",
            "tokenized": [
                {
                    "sent": "According to Symantec research, the group was most active in April 2018.",
                    "is_evidence": 0,
                    "is_repeat": 0
                },
                {
                    "sent": "As the group uses PowerShell scripts, it is extremely difficult to detect their attacks and malicious activity on infected systems.",
                    "is_evidence": 0
                },
                {
                    "sent": "Delaware, USA – October 11, 2018 — The newly discovered APT group Gallmaker has been active at least since last December and is aimed at the government, military and defense targets in the Middle East and Eastern Europe.",
                    "is_evidence": 0
                },
                {
                    "sent": "Despite the fact that last year Microsoft released updates to disable DDE protocol in Word and Excel by default, many organizations remain vulnerable to this infection vector, and attackers continue to exploit it successfully.",
                    "is_evidence": 0
                },
                {
                    "sent": "Gallmaker uses WindowsRoamingToolsTask to schedule PowerShell scripts and tasks, publicly available Metasploit exploits with the Rex PowerShell library and WinZip console to communicate with command and control servers and exfiltrate data.",
                    "is_evidence": 0
                },
                {
                    "sent": "Usually, during an attack, Gallmaker send spear-phishing emails with an attached MS Office document.",
                    "is_evidence": 0
                }
            ]
        },
        {
            "link": "https://securityaffairs.com/77041/apt/gallmaker-apt-emerges.html",
            "content": "A new cyber espionage group tracked as Gallmaker appeared in the threat landscape.A previously unknown cyber espionage group, tracked as Gallmaker, has been targeting entities in the government, military and defense sectors since at least 2017.According to researchers from Symantec, who first spotted the threat actor, the group has launched attacks on several overseas embassies of an unnamed Eastern European country, and military and defense organizations in the Middle East.“The fact that Gallmaker appears to rely exclusively on LotL tactics and publicly available hack tools makes its activities extremely hard to detect.“The most interesting aspect of Gallmaker’s approach is that the group doesn’t use malware in its operations.“This group eschews custom malware and uses living off the land (LotL) tactics and publicly available hack tools to carry out activities that bear all the hallmarks of a cyber espionage campaign,” reads the analysis published by Symantec.",
            "domain": "securityaffairs.com",
            "tokenized": [
                {
                    "sent": "A new cyber espionage group tracked as Gallmaker appeared in the threat landscape.",
                    "is_evidence": 0,
                    "is_repeat": 0
                },
                {
                    "sent": "A previously unknown cyber espionage group, tracked as Gallmaker, has been targeting entities in the government, military and defense sectors since at least 2017.",
                    "is_evidence": 0
                },
                {
                    "sent": "According to researchers from Symantec, who first spotted the threat actor, the group has launched attacks on several overseas embassies of an unnamed Eastern European country, and military and defense organizations in the Middle East.",
                    "is_evidence": 0,
                    "is_repeat": 0
                },
                {
                    "sent": "“The fact that Gallmaker appears to rely exclusively on LotL tactics and publicly available hack tools makes its activities extremely hard to detect.",
                    "is_evidence": 0,
                    "is_repeat": 0
                },
                {
                    "sent": "“The most interesting aspect of Gallmaker’s approach is that the group doesn’t use malware in its operations.",
                    "is_evidence": 0
                },
                {
                    "sent": "“This group eschews custom malware and uses living off the land (LotL) tactics and publicly available hack tools to carry out activities that bear all the hallmarks of a cyber espionage campaign,” reads the analysis published by Symantec.",
                    "is_evidence": 0
                }
            ]
        },
        {
            "link": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/gallmaker-attack-group",
            "content": "Its activity subsequently increased in the second quarter of 2018, with a particular spike in April 2018.Gallmaker’s activity points strongly to it being a cyber espionage campaign, likely carried out by a state-sponsored group.Once the Gallmaker attackers gain access to a device, they execute various tools, including: WindowsRoamingToolsTask: Used to schedule PowerShell scripts and tasks.Symantec researchers have uncovered a previously unknown attack group that is targeting government and military targets, including several overseas embassies of an Eastern European country, and military and defense targets in the Middle East.The fact that Gallmaker appears to rely exclusively on LotL tactics and publicly available hack tools makes its activities extremely hard to detect.The group, which we have given the name Gallmaker, has been operating since at least December 2017, with its most recent activity observed in June 2018.The most interesting aspect of Gallmaker’s approach is that the group doesn’t use malware in its operations.This group eschews custom malware and uses living off the land (LotL) tactics and publicly available hack tools to carry out activities that bear all the hallmarks of a cyber espionage campaign.",
            "domain": "symantec-enterprise-blogs.security.com",
            "tokenized": [
                {
                    "sent": "Its activity subsequently increased in the second quarter of 2018, with a particular spike in April 2018.Gallmaker’s activity points strongly to it being a cyber espionage campaign, likely carried out by a state-sponsored group.",
                    "is_evidence": 0,
                    "is_repeat": 0
                },
                {
                    "sent": "Once the Gallmaker attackers gain access to a device, they execute various tools, including: WindowsRoamingToolsTask: Used to schedule PowerShell scripts and tasks.",
                    "is_evidence": 0
                },
                {
                    "sent": "Symantec researchers have uncovered a previously unknown attack group that is targeting government and military targets, including several overseas embassies of an Eastern European country, and military and defense targets in the Middle East.",
                    "is_evidence": 0
                },
                {
                    "sent": "The fact that Gallmaker appears to rely exclusively on LotL tactics and publicly available hack tools makes its activities extremely hard to detect.",
                    "is_evidence": 0
                },
                {
                    "sent": "The group, which we have given the name Gallmaker, has been operating since at least December 2017, with its most recent activity observed in June 2018.The most interesting aspect of Gallmaker’s approach is that the group doesn’t use malware in its operations.",
                    "is_evidence": 0
                },
                {
                    "sent": "This group eschews custom malware and uses living off the land (LotL) tactics and publicly available hack tools to carry out activities that bear all the hallmarks of a cyber espionage campaign.",
                    "is_evidence": 0
                }
            ]
        },
        {
            "link": "https://securelist.com/apt-review-of-the-year/89117/",
            "content": "All the above, and several other cases, shows how there seems to be a new doctrine in dealing with such hacking attempts, making them public and providing tools for media campaigns, future negotiations and diplomacy, as well as directly targeting operatives.In its more recent campaigns it has started deploying a new malware we call ThreatNeedle.Many of these attacks involved malware developed by companies that provide surveillance tools to governments.Other than the technical details themselves, what is also worth considering is the real purpose of this attack, and why these sophisticated false flags were planted in the malware.This campaign, attributed to a Russian-speaking set of activity, allowed attackers to infect hundreds of thousands of devices, providing control of the network traffic as well as allowing MITM attacks.We discovered this actor using a new variant of its Carbon malware in its traditional activity of targeting embassies and foreign affairs institutions throughout the year.",
            "domain": "securelist.com",
            "tokenized": [
                {
                    "sent": "All the above, and several other cases, shows how there seems to be a new doctrine in dealing with such hacking attempts, making them public and providing tools for media campaigns, future negotiations and diplomacy, as well as directly targeting operatives.",
                    "is_evidence": 0,
                    "is_repeat": 0
                },
                {
                    "sent": "In its more recent campaigns it has started deploying a new malware we call ThreatNeedle.",
                    "is_evidence": 0
                },
                {
                    "sent": "Many of these attacks involved malware developed by companies that provide surveillance tools to governments.",
                    "is_evidence": 0
                },
                {
                    "sent": "Other than the technical details themselves, what is also worth considering is the real purpose of this attack, and why these sophisticated false flags were planted in the malware.",
                    "is_evidence": 0,
                    "is_repeat": 0
                },
                {
                    "sent": "This campaign, attributed to a Russian-speaking set of activity, allowed attackers to infect hundreds of thousands of devices, providing control of the network traffic as well as allowing MITM attacks.",
                    "is_evidence": 0
                },
                {
                    "sent": "We discovered this actor using a new variant of its Carbon malware in its traditional activity of targeting embassies and foreign affairs institutions throughout the year.",
                    "is_evidence": 0
                }
            ]
        }
    ]
}