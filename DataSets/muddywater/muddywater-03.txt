MuddyWater is an Iranian government-sponsored threat actor, part of Iran's Ministry of Intelligence and Security (MOIS). Since Q4 of 2022 the group has been active against Israeli organizations. The malicious activities were detected as a result of in-depth knowledge of the threat actor TTPs and infrastructure. The threat actor targeted various sectors including finance, academia and government. On February 2022, the threat actor conducted a ransomware attack against an organization in the academic sector. Indications show that ransom was not the main purpose for this attack, but disseminating disinformation with Anti-Israeli content. The group is exploiting the Log4j vulnerability, and deploys RAT tools, including lately the SyncroRAT tool.1. MuddyWater is also known as Static Kitten, Mercury, Temp.Zagros, Seedworm and Earth Vetala, and has been active since 2017. The threat actor conducts cyber espionage operations using social engineering in its phishing campaigns, exploiting 1-day vulnerabilities and using malicious tools such as PowerShower, PowerStallion and MuddyWater proxy. Over the last 2 years, the threat actor has been connected to several attacks, against government organizations and other sectors. Cyber Attack Analysis On February 2023, for the first time, the threat actor combined a destructive operation with an influence campaign against an Israeli target. A few days before the attack the threat actor launched a Telegram channel under the name "Darkbit", in order to publish leaked data from that attack. MuddyWater chose to conceal its identity behind the name "Darkbit" in order to avoid being identified as a state-sponsored threat actor. This concealment involved several aspects: Publishing Anti-Israeli narrative, including criticism on the Israeli government regarding the Israeli-Palestinian conflict. This type of publications are usually expressed by hacktivists, rather than government-sponsored groups. The ransomware file extension was "darkbit". Ransom demand was significantly higher than the average ransomware attack in Israel, demanding 80 Bitcoin (more than $1.6 Million). The threat actor conducted the attack using 2 methods, CNA and CNE: CNE – the attackers published they stole 4TB of data from the victim organization. CNA – the attackers encrypted servers and end points in order to disrupt business-critical systems. After the encryption phase, a text file named "RECOVERY_DARKBIT" was left as a message to the attacked organization. Analysis of malware used by the threat actor First variant, used to encrypt Windows systems Filename is 8thcurse.exe, size 5.1MB, compiled by the open source tool MinGW. The malware is written in the Go Programming language. The malware is 64-bit version, and was compiled at 12/2/2023 00:10:5. A copy was uploaded to virustotal.com at 13/2/2023. Identified by 50 AV engines as malicious (as of 9/3/23). MD5: 9880fae6551d1e9ee921f39751a6f3c0 SHA1: 30466ccd4ec7bcafb370510855da2cd631f74b7a SHA256:9107be160f7b639d68fe3670de58ed254d81de6aec9a41ad58d91aa814a247ff The malware uses AES symmetrical encryption to encrypt files located on the filesystem. The key used for the encryption is kept in a file encrypted by Asymmetrical RSA encryption. Decryption is only possible using the private key associated with the public key used for encryption. Files that have been encrypted, get their extension changed to darkbit. The string DARKBIT_ENCRYPTED_FILES is added to the file content, to indicate to the malware that the file was encrypted and prevent a second encryption. Information about the encryption process (key and IV used for the AES encryption), is encrypted using an RSA public key. The corresponding private key is kept by the attacker and can be used to decrypt the file. By default, the malware waits 10 seconds before starting to encrypt files. At that point, the malware is stoppable. The malware supports using multiple threads for parallel execution. The malware uses built-in commands to prevent restoring files after the encryption phase. It erases Shadow Copies using the built-in command vssadmin, running to following command: vssadmin.exe delete shadow /all /Quiet Indications show that the malware was specifically built to attack the Technion: The ransom note was addressed to the Technion. The malware included a hard-coded list of servers on the Technion network. Based on the above list, it is probable that the attacker mapped the Technion's network prior to the attack. The malware contains a list of file extensions that will not be encrypted, to prevent operating system failure. These files are: msilog,log,ldf,lock,theme,msi,sys,wpx,cpl,adv,msc,scr,key,ico,dll,hta,deskthemepack,nomedia,msu,rtp,msp,idx,ani,386,diagcfg,bin,mod,ics,com,hlp,spl,nls,cab,diagpkg,icl,ocx,rom,prf,themepack,msstyles,icns,mpa,drv,cur,diagcab,exe,cmd,shs,Darkbit The malware uses configuration definitions for the encryption process. In this version, large files are not encrypted as a whole, but broken down to multiple parts that are encrypted separately. Extension that is labeled "1" in the configuration, is not encrypted. The malware code can be modified modularly and simply, to fit the attacker's purpose.