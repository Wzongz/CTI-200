Hagga is a threat organization motivated by information theft, first publicly disclosed by Unit 42 researchers in March 2019 [1]. Initially, researchers believed that these activities targeted internal organizations in the Middle East. Further research indicated that these activities might be part of a larger group, affecting not only the Middle East but also the United States, Europe, and Asia as a whole. Unit 42 referred to this group as Aggah. In the early stages of the attacks, when the Trojan sent data to the C2 server, it used the string "hagga" to separate information. This string was also the name of the PasteBin account hosting the payload information, leading to the name "Aggah" for this activity. Subsequently, foreign security researchers referred to this organization as Hagga/Aggah, and we will use the name Hagga in the following description. Initially, Unit 42 believed that due to TTP similarities and the use of Revenge RAT, Hagga might be associated with the Gorgon Group, a Pakistani organization known for targeting Western governments. However, no prominent Gorgon Group indicators were observed in that investigation, so Unit 42 could not definitively link Hagga to the Gorgon Group. Hagga has been active since 2019, with traces dating back to 2018. They typically use the same TTPs in their attack activities. In the early stages, the organization used Internet Archive, Pastebin, and Blogspot to host malicious scripts and payloads, often employing RevengeRAT. Subsequently, RATs such as LimeRAT, NjRAT, AsyncRAT, NanoCoreRAT, RemcosRAT, and Agent Tesla have been observed.Blind Eagle (internally identified as APT-Q-98 by QiAnXin) is an APT organization independently discovered and first disclosed by QiAnXin. The Blind Eagle organization is a suspected APT group originating from South America, primarily targeting Colombia. Since April 2018, this organization has carried out organized, planned, and targeted long-term attacks against Colombian government institutions and large companies in vital sectors such as finance, oil, and manufacturing. In the early stages, the TTPs of the Blind Eagle organization involved intrusions into Spanish-language websites or registering domain names with privacy protection and uploading payload files and documents for attacks. They delivered bait documents in MHTML format with malicious macros, encrypted with RAR, through spear-phishing emails. The RAR decryption password was then included in the email body, effectively evading email gateway scans. The Blind Eagle organization often disguises itself as the Colombian National Civil Registry, National Tax and Customs Administration, National Statistical Office, National Cyber Police, and National Department of Justice, targeting the government and financial institutions in Colombia, as well as large domestic or multinational companies' Colombian branches. They use commercial Trojans for remote control of the targets and employ dynamic domain-based remote control techniques. Their ultimate goal is to implant backdoors to gain control over the target computers, providing a foundation for lateral movement in subsequent stages. Throughout the investigation, the Hagga organization and the Blind Eagle organization have been tracked as two separate entities. However, there are certain similarities in TTPs between Hagga and Blind Eagle. Moreover, both organizations primarily use commercial or open-source Trojans as their final payloads, making it difficult to differentiate them based on TTPs. Currently, there is no strong evidence to establish a direct relationship between the Hagga and Blind Eagle organizations. However, some foreign security researchers speculate that Hagga may offer its hacking services for sale [2].The QiAnXin Threat Intelligence Center's RedDrIp team has been continuously tracking major APT organizations worldwide. During the investigation of the Blind Eagle APT-Q-98 group, which is active in South America, we discovered that since 2022, hundreds of bait PDF files have been uploaded from Colombia. These bait PDFs are primarily distributed via email, often masquerading as various Colombian institutions, including the Ministry of Justice, Tax and Customs Administration, Davivienda Bank, Ministry of Finance, Ministry of Transportation, and law firms. These PDF files embed compressed file passwords within the body and entice victims to click on short links to download the compressed files. Upon extraction, victims are tricked into executing VBS scripts disguised as PDFs, initiating a complex multi-stage fileless infection chain that ultimately loads remote control software.Initially, we investigated a large number of bait files, which exhibited TTPs nearly identical to those of Blind Eagle. The bait files were written in Spanish and uploaded from Colombia, aligning with Blind Eagle's attack targets and technical characteristics. Therefore, we initially attributed these attack activities to the Blind Eagle organization.During the analysis of these files, we discovered an IP address, 172.174.176.153, hosting an open directory used to store subsequent payloads. This finding aligns with the blog published by the foreign company BlackBerry regarding the disclosure of Blind Eagle activities [3]. However, after some time, the hosted content in the open directory of this IP address was updated, which caught our attention.After analyzing the new payload, we discovered that it is still a C# injector commonly used by the Blind Eagle organization. However, on the same day, we came across a new phishing email related to that IP, which appeared to be a spear-phishing attack targeting a Chinese company based on its content. However, both the email content and the bait attachment seemed quite crude and resembled more the work of ordinary hacking groups rather than a professional APT organization.Reviewing the attack activities of Blind Eagle since their disclosure, we haven't found any examples of them targeting China. However, the arrival of this attack email forced us to reevaluate the organization behind the attack activities previously attributed to Blind Eagle.As can be seen, this recent attack activity aligns with Blind Eagle's previous TTPs to a large extent. It has not only improved certain details of the activities but also expanded the range of initial bait documents, including office documents carrying vulnerabilities and highly effective bait PDF documents for bypassing antivirus detection. The main difference lies in the variation of the final loaded Remote Access Trojan (RAT). Based on the above comparison, we cannot differentiate the Blind Eagle organization from the Hagga organization based on TTPs alone. Therefore, we attempted to attribute them based on the following details. Known Blind Eagle organization primarily targets locations within Colombia and some regions in South America, such as Ecuador, Panama, Chile, etc. On the other hand, the known targets of the Hagga organization include countries in the Middle East, Europe, Asia, and the Americas. Although most of the captured samples originate from the Colombian region, due to the discovery of attack samples targeting Chinese companies and considering the previous instances of Hagga organization targeting Taiwan [6], we are inclined to attribute this activity to the Hagga organization. The IP hosting the malicious payload, 172.174.176.153, shares the same directory structure and file name suffix as the one disclosed by another cybersecurity company for the Hagga organization [7].In 2022, a foreign cybersecurity company disclosed that the Hagga organization appeared to be using XAMPP as a web server and hosting the Mana Tools C2 panel on a Windows virtual server [8]. The IP hosting the malicious payload, 172.174.176.153, is also using XAMPP and the default port 3306 (MySQL server's default port).Language and Sender Address of the Spear-phishing Email The Blind Eagle organization primarily uses Spanish to create bait for their attacks, while the spear-phishing email in this case is in English. Additionally, the actual sender domain of the captured email is slot0.cedarstz.top, which resolves to IP 185.28.39.60, a known zombie network. As early as 2020, a foreign cybersecurity company described how the Hagga organization operates a zombie network without renting serversã€‚The commercial and open-source Trojans observed being used by the Hagga organization include RevengeRAT, LimeRAT, NjRAT, AsyncRAT, NanoCoreRAT, WarzoneRAT, RemcosRAT, Agent Tesla, etc., whereas the Trojans observed being used by the Blind Eagle organization include LimeRAT, NjRAT, AsyncRAT, Imminent Monitor RAT, QuasarRAT, etc. Based on existing reports, the collection of Trojans used by the Hagga organization is greater than that used by the Blind Eagle organization, indicating that the Hagga organization has a wider range of activities and higher frequency.Possibility 1: Is the Hagga Group a Sub-group of the Blind Eagle Group? From the TTP perspective, the two are very similar. Both use Spanish for spear-phishing attacks targeting Colombia, both download payloads from public repositories, both use dynamic domains for C2, both employ publicly available commercial Trojans as final payloads, and both have information theft as their objective. Although there is no strong evidence to prove a direct relationship between the Hagga and Blind Eagle organizations, we speculate that they may have a complementary relationship. One focuses on attacking Colombia while the other establishes a zombie network and shows interest in major countries worldwide. Possibility 2: Does the Hagga Group Provide Cyber Weapons to the Blind Eagle Group? In 2020, the Hagga organization not only targeted Europe but was also discovered engaging in Bitcoin theft activities. In their recent activities, the attackers impersonated B2B companies in Europe, the Middle East, and Asia, indicating that their targets are not limited to specific regions. The targeted victims' sectors and locations also indicate that the attackers are attempting to disrupt businesses across various industries, from manufacturing to agriculture. Additionally, on the Medium platform, Paul Burbage pointed out that the Hagga organization sells or provides malicious software for free to Nigerian threat actors, which aligns with the data they have discovered [10]. This suggests that the Hagga organization could potentially sell their TTPs and malicious software to the Blind Eagle organization as well.Throughout the entire attack chain, whether it's the hosting platforms or the VBS, PowerShell, and C# code, these can be considered open-source code for reverse engineers, allowing for direct replication and debugging. Therefore, the possibility of imitating TTPs cannot be ruled out.The attachment INV20230503.xlsx in the aforementioned spear-phishing email carries the document with the CVE-2017-11882 vulnerability. Through the vulnerability, it accesses the GEE.vbs hosted on 109.206.240.64, then releases and executes KJH.vbs in the %appdata% directory. KJH.vbs ultimately invokes PowerShell to request new_rump_vb.net.txt from 172.174.176.153 for execution.Within the GEE.vbs hosted on 109.206.240.64, there are numerous harmless or even open-source code snippets, while the actual malicious code is hidden within a few lines.The PowerShell script calls the VAI function, which, internally, first performs string replacements and downloads the subsequent payload. The replaced strings are relatively fixed, and during our tracking process, they remained unchanged for a considerable period of time. For this reason, we copied their code and created a dedicated string replacement function.The subsequent payload is downloaded from https://paste.ee/d/2cSTI/0, and a puppet process is created to run it.The final injected payload is RemcosRAT.It is worth mentioning that since the upload of new_rump_vb.net.txt on May 1st, within just two weeks, we have identified 66 malicious documents related to it. These include lure documents in xlsx and RTF formats, executable documents in RAR and VBS formats, and even HTML pages.Based on our tracking findings and the analysis of open-source reports, we believe that the Blind Eagle and Hagga organizations share highly similar TTPs, making it difficult to distinguish between them. In the absence of definitive evidence, we have put forward some hypotheses, hoping to discover more clues to substantiate them in the subsequent threat hunting process. Given the complexity of APT organization attacks and the indiscriminate nature of Hagga organization's attacks on major countries worldwide, the QiAnXin Threat Intelligence Center will conduct long-term tracing and monitoring to promptly detect security threats and respond effectively. APT organization attacks have always posed significant cybersecurity threats to nations and enterprises. They are typically carefully planned by individuals driven by commercial or political motives, targeting specific organizations or countries. These attacks maintain a high level of stealthiness over an extended period, necessitating constant vigilance.