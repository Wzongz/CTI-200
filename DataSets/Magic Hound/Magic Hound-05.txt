Magic Hound, also known as APT35, is an Iranian state-sponsored threat group known for its sophisticated cyber espionage campaigns targeting organizations across various industries and geographic regions. This Threat Research aims to meticulously examine the tactics, techniques, and procedures (TTPs) employed by Magic Hound in its cyber espionage operations.Magic Hound, believed to be operating since at least 2014, is one of the most active and persistent threat actors originating from Iran. The group's primary mission revolves around conducting cyber espionage on behalf of the Iranian government. They have targeted government agencies, financial institutions, energy companies, and other organizations of strategic importance worldwide.While attribution in the cyber domain can be complex, researchers and security experts have linked Magic Hound to Iran based on various indicators of compromise (IOCs), historical patterns, and similarities with other known Iranian threat groups. In this research on Magic Hound, we tried to provid actionable insights into the group's operations, targets, and techniques. Similarly, others have also published their tailored research on Magic Hound's activities and targeted attacks against Saudi Arabian organizations & others. However, this research rigorously analyzes the underlying nuances of numerous malware samples and infrastructure associated with Magic Hound, leading to high confidence in their attribution and identification of this threat actor. APT35's targets encompass a wide range of industries and geographic regions. Key sectors include: Magic Hound has shown a particular interest in infiltrating government agencies and diplomatic organizations, likely seeking political and strategic intelligence. The group has targeted ministries, embassies, and other governmental entities in different countries. The threat group has also targeted financial institutions to gather economic intelligence and potentially support Iran's economic agenda. Banks, financial service providers, and stock exchanges have been among the targets of Magic Hound's cyber-espionage activities. APT35 has demonstrated an interest in the energy sector, possibly aiming to gain insights into energy policies, contracts, and potential vulnerabilities. Oil and gas companies, renewable energy firms, and energy infrastructure have been subject to the group's attacks. Defense and aerospace industries are among Magic Hound's targets, potentially to acquire military-related technologies and classified information. Companies involved in the production of defense systems, aircraft, and satellite technologies have faced cyber-espionage attempts from the threat group. In addition to the above, the threat group has targeted other industries that align with Iran's geopolitical interests. These industries may include telecommunications, technology, research, and academic institutions. Magic Hound (APT35) employs a range of advanced techniques and custom-built malware to achieve its cyber espionage objectives. A thorough examination of their technical capabilities sheds light on their sophisticated tactics. One of the primary infection vectors employed by Magic Hound is spear-phishing. The group crafts convincing emails designed to lure victims into interacting with malicious content, such as attachments or links to compromised websites. These emails often carry weaponized documents exploiting known vulnerabilities or deliver malware payloads. Malicious Document Exploitation Magic Hound leverages malicious documents, such as Microsoft Office files, to deliver their payloads. These documents contain embedded macros or exploit code targeting vulnerabilities in document viewers. Once the victim enables macros or opens the document, the embedded code executes, leading to the download and execution of further malicious components. In a campaign targeting Saudi Arabian organizations, Magic Hound employed a multi-stage malware delivery process. The initial dropper, named "Magic Hound," is designed to download and execute a more sophisticated backdoor named "ZeroT." The Magic Hound dropper utilizes PowerShell for its execution. It disguises itself within seemingly legitimate files to evade detection. ZeroT exhibits advanced features, including anti-analysis techniques and data exfiltration capabilities. Its modular structure allows Magic Hound to execute various commands and gather sensitive information from compromised systems. To maintain control over compromised systems, Magic Hound establishes a command and control (C&C) infrastructure. The malware communicates with the C&C server to receive commands and exfiltrate stolen data. Magic Hound's malware is designed to exfiltrate sensitive data from compromised systems. This data often includes documents, credentials, and system information. The group employs encryption and obfuscation techniques to evade detection during data exfiltration. APT35 utilizes an arsenal of sophisticated tools and techniques in its operations. Magic Hound employs custom-built malware to evade detection and conduct its espionage activities discreetly. The group's malware includes Remote Access Trojans (RATs), keyloggers, and backdoors tailored to specific targets. Spear-Phishing: The threat group uses spear-phishing emails to deliver their malware payloads and gain initial access to target networks. These emails often contain social engineering lures tailored to the recipients' interests or positions within the organization. Zero-Days & Exploits: APT35 leverages zero-day vulnerabilities and exploits to target specific software and gain unauthorized access. The group has been known to utilize publicly disclosed vulnerabilities and zero-days to maintain persistence in compromised networks. Watering Hole Attacks: Magic Hound has been known to compromise legitimate websites frequented by their targets, using them as watering holes to infect visitors. By injecting malicious code into these sites, they can deliver malware to a broader range of potential victims. Command & Control (C&C) Infrastructure: The group sets up elaborate C&C infrastructure to manage and maintain control over compromised systems. Magic Hound's C&C servers use encryption and other obfuscation techniques to avoid detection. Living off the Land: APT35 relies on living-off-the-land techniques to exploit existing tools and utilities for lateral movement and data exfiltration. By using legitimate software and system administration tools, they can blend in with normal network traffic and evade detection. Cyber Espionage Campaigns: Magic Hound has conducted several high-profile cyber-espionage campaigns over the years, often with a focus on strategic intelligence gathering. One of the notable campaigns attributed to APT35 is the attacks against Saudi Arabian targets. To identify potential breaches and ongoing attacks, organizations can monitor for specific Indicators of Compromise (IOCs) associated with Magic Hound's campaigns. These IOCs include domain names, IP addresses, file hashes, and network signatures used by the threat group. A series of cyber-espionage campaigns carried out by Magic Hound against Saudi Arabian organizations. The attacks targeted sectors such as government, telecommunications, and financial services in Saudi Arabia. The campaigns involved the use of spear-phishing emails containing malicious attachments and links to compromise the targeted systems. Once inside the target's network, Magic Hound utilized custom-built malware to maintain persistence and exfiltrate sensitive data. The group demonstrated significant capabilities in evading detection and staying hidden within the victim's network for extended periods. According to a new development, Iranian state-sponsored threat groups are the emergence of a subgroup within the well-known APT actor Mint Sandstorm. This subgroup, recently identified by Microsoft, has exhibited a rapid adoption of proof-of-concept (PoC) exploit code, targeting vulnerabilities in internet-facing applications. Mint Sandstorm, also known by various aliases including TA453, Ajax Security Team, Charming Kitten, APT35, Magic Hound, and others, has been active since at least 2011, engaging in cyber-espionage campaigns targeting activists, government entities, journalists, critical infrastructure, and other high-value entities. Microsoft's threat intelligence has revealed the existence of subgroups operating under Mint Sandstorm's umbrella. The overall activities of Mint Sandstorm are attributed to the Islamic Revolutionary Guard Corps (IRGC), Iran's military intelligence arm. This new subgroup, however, has garnered attention due to its swift adoption of PoC exploit code targeting known vulnerabilities in internet-facing applications. This shift in tactics suggests an evolving approach by this subgroup in terms of both technical capabilities and strategic objectives. The Mint Sandstorm subgroup has transitioned from initial reconnaissance to directly targeting critical infrastructure organizations, particularly in the United States. In 2022, these attacks extended to energy companies, seaports, transit systems, and a major utility and gas companies. Notably, these attacks were potentially executed in support of retaliatory destructive cyberattacks. Microsoft - Update on Mint Sandstorm Subgroup the report underscores that this subgroup's exploitation of vulnerabilities such as CVE-2022-47966 and CVE-2022-47986 within days of their PoC becoming public demonstrates a heightened sense of urgency and agility in their offensive operations. The Mint Sandstorm subgroup's modus operandi involves a range of techniques to achieve its objectives. Initial compromise is often achieved through the exploitation of older vulnerabilities, followed by the deployment of custom PowerShell scripts for discovery and lateral movement using Impacket. Notably, this subgroup employs PowerShell scripts for account enumeration and Remote Desktop Protocol (RDP) connections, along with an SSH tunnel for command-and-control (C&C), facilitating the theft of Active Directory databases, user credential compromise, and unauthorized access to user accounts. Scheduled tasks for persistence, the use of webhook.site for C&C, and the deployment of custom malware further demonstrate the subgroup's diverse toolkit. Mint Sandstorm's subgroup has showcased its technical prowess by developing and deploying advanced custom implants. These include Drokbk, a multistage .NET backdoor, and Soldier, a versatile .NET backdoor capable of fetching additional payloads and self-uninstallation. This subgroup's intrusion capabilities are formidable, enabling operators to operate stealthily by concealing C&C communication, maintaining persistence within compromised systems, and deploying an array of post-compromise tools to further their objectives. Microsoft's findings underscore the urgency of timely patch management. Mint Sandstorm's rapid adoption of PoC exploit code emphasizes the need for organizations to apply patches for known vulnerabilities as soon as they are available to minimize the risk of exploitation. The Mint Sandstorm subgroup's activities highlight the evolving threat landscape and the critical importance of proactive cybersecurity measures in defending against sophisticated threat actors. Detecting and mitigating the threat posed by APT35 require a multi-layered approach combining technical solutions, threat intelligence sharing, and employee awareness training. Organizations must collaborate and share threat intelligence to stay ahead of evolving tactics employed by APT35. Sharing IOCs, malware samples, and TTPs with industry peers and security vendors can help in early detection and response to Magic Hound's activities. Implementing robust endpoint protection solutions with behavioral analysis can detect and prevent APT35's malware. Advanced endpoint detection and response (EDR) tools can identify suspicious activities, stop the execution of malicious code, and facilitate incident response. Continuous monitoring of network traffic and the use of intrusion detection systems can help identify suspicious activities indicative of APT35's presence. Network-based threat detection, combined with sandboxing for analyzing suspicious files, can bolster an organization's cyber defenses against the threat group. Regular security awareness training for employees can minimize the risk of successful spear-phishing attacks. Training should focus on recognizing phishing emails, social engineering, and the importance of reporting suspicious activities promptly. As APT35 often leverages zero-day vulnerabilities, organizations must implement strategies to protect against these unknown threats. Maintaining up-to-date software and promptly applying security patches is critical to reducing the attack surface for zero-day exploits. Automated patch management solutions can streamline this process and reduce the window of exposure to potential vulnerabilities. Organizations should consider investing in vulnerability research and disclosure programs. By identifying and reporting zero-day vulnerabilities responsibly, they can contribute to the overall security of the cyber landscape and minimize the risk of exploitation by threat actors like APT35. Conclusion Magic Hound (APT35) is a highly capable and persistent threat group with a clear focus on cyber espionage activities. Their state-sponsored nature and sophisticated techniques make them a formidable adversary. Organizations across various industries and regions should be vigilant and take proactive measures to protect their sensitive information and infrastructure from APT35's persistent cyber-espionage operations.