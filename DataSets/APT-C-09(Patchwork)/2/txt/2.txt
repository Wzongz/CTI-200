The initial vector is an INP file (format used for the software InPage) with the exploit CVE2017-12824, we can see here the 0x7E and 0x72 represent a class of type in the stream for use, an ole stream for launch the first binary file.We can see on the strings on the dll, what extract the file in the temp folder and create a thread for the second PE file.On the entrypoint of the second PE, we can see the first action is to check the environment in using the anti-forensic technique by the CheckRemoteDebuggerPresent function.Before go on the others function. We can see that the PE get the name of the user and create their persistence by an RunOnce key in the registry. (\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce Putty explorer.exe CurrentUser C:\file.exe) After this, this uses the CreateToolhelp32snapshot function for getting a snapshot of all the process an parsed it until this fall on the explorer process.We can note this check with the IsProcessorFeaturePresent function, for check if and raise an exception for close the program.Once the check, this injects with a Process Hollowing for create a process for communicate with the C2 and wait to loader the next malware.At the date of the submission in VT, the C2 is down and the next step can't be analysed. Firstly, we can observe that the payload seems be with the Professional version of Inpage (2.21). Inpage is currently used in Pakistan which is consistent with the fact that Patchwork is an Indian APT. Secondly, we can note the same pdb path what the 360TI analysis. The C2 is hosted on Amazon CloudFront :This payload is linked at one of the recent events :