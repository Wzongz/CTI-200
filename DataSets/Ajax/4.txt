State-sponsored cyberwarfare is no different than physical battles or terrorist attacks in terms of scope and damage. Arguably, cyber attacks are much worse because the identity of attackers are easily concealed, slowing down any process that could bring perpetrators to justice. Attackers are also not restricted by time and location. Interestingly, Middle Eastern countries and some members of the European Union (EU) have recently figured in targeted attacks, either as an aggressor or a victim, for seemingly political reasons. At the recently concluded “31st Chaos Communication Congress of the Chaos Computer Club (31C3),” cybersecurity researchers discussed the ways and means by which threat actors can use widely available software to cover their tracks and carry out their campaigns. [1] The focus of this particular lecture was the GHOLE malware used in targeted attack campaigns. GHOLE is believed to have been active since 2011 based on the compilation date of its oldest samples. Targeted attacks are well-planned cyberthreat activities aimed at specific organizations. In this paper, we delve into the malicious activities of a cyberthreat group, known in the cybersecurity industry as Rocket Kitten, which has been hitting different public and private Israeli and European organizations. Rocket Kitten has so far launched two campaigns—“GHOLE” malware attacks and one we have dubbed “Operation Woolen-GoldFish.” We named it as such because “Woolen” is attributed to the malware developer and one of the threat actors behind this campaign; “GoldFish” serves as an attribute to the location of origin with which the campaign was seemingly launched from. The Rocket Kitten group used spear-phishing emails in order to penetrate their target systems. Based on the malware samples we have obtained from files with macro malware specific to the GHOLE malware campaign, we found that they were mostly interested in the defense industry, the IT sector, government entities, and academic organizations. Certain details from the malware samples show that Operation Woolen-GoldFish was most likely to be a state sponsored campaign. The content of the files we have collected from this group of attackers is quite straightforward. They contain information that is very customized in relation to the target entity. Some files are written in German, while others contain information specific to just one vertical. All of these have been used for spear-phishing emails against various targets. Seeing the content of these files, we suspect they have all been used for spear phishing against the following:In February 2015, the Trend Micro™ Smart Protection Network™ received an alert from Europe that triggered several targeted attack indicators related to a specific malware family, prompting our threat defense experts to investigate further. The alert showed an infected Microsoft™ Excel® file that soon proved to have been launched by Rocket Kitten. When a user opens the Excel file attachment in the spear-phishing attempt, a .DLL f ile is dropped onto the system and is executed using a macro embedded in the file. Macros are small scripts within files that are usually used to automate common repetitive tasks. However, these can also be used for malicious intent, such as infecting machines of unsuspecting users with malware, just like in this situation. Trend Micro detects the malware as TROJ_GHOLE.A. It is common for Rocket Kitten to use GHOLE in their targeted attack campaigns. The dropped .DLL file (SHA1 hash: 07a77f8b9f0fcc93504dfba2d7d9d26246e5878f; BKDR_GHOLE.B) is scanned on VirusTotal, but there were no results, raising further interest to analyze the binary. [2‒3] The .DLL file contained an export function named, “function,” instead of the usual, “gholee,” found in previous samples from this malware family. We suspect that the attacker did this on purpose so the malware can bypass detection and stay within the targeted system that would eventually give it more freedom to move laterally. The top-right boxed code in the screenshot, displayed to the right, shows an unusual code that uses “push” to pass values like those shown in the screenshots below it. When passed to WINAPI, it will look like a string on stack. The first block contains the address of the command-and-control (C&C) server of the malware, which is located at IP address, 83.170.33.60. This value is specified in the code, as shown in the third screenshot. The second boxed code in function, ZKXdu80x, is the client version. The third is an encryption key with a length of 256 bytes (2,048 bits) used for network communications, and starts with the pattern, GET /index.php?c=xxxxxxxx&r=xxxxx&u=1&t=. In all samples we have analyzed, the “c” argument is 8 bytes long and differs across variants. This can be used as a unique identifier for each of the infected machines. The “r” argument has a variable length, 5–7 bytes; the “u” argument is always 1 byte long. Other communication patterns can be found in the binary and can be used as indicators of compromise:We found several Microsoft Office® files containing variants of the GHOLE malware family that were used to infect machines. As the Excel spreadsheet used in this campaign is disguised to look relevant and important, users were prompted to open it and execute the embedded macro. The use of macros to infect computers is deemed amateur. This shows that there is a gap between the maturity of the malware, which is good enough for its purpose, and the way it is delivered, which raises questions about the attackers’ professional capacity. We decided to look at the spear-phishing attempts from a wider perspective and analyzed more samples from this malware family. Based on available evidence, only the Rocket Kitten group is known to have used GHOLE in the attacks related to Operation Woolen-GoldFish. It is interesting to note that the GHOLE malware is in fact a modified CORE IMPACT® product. CORE IMPACT is a sophisticated penetration-testing tool from CORE, a legitimate company. [4] After studying the sample infected and dropped files, we established a timeline using the dates when the executable files were compiled. This timeline should be reliable unless the attackers played with the time stamps, which would be surprising in this campaign since all binary compilation dates fit quite well with the spear-phishing attacks. As is often the case with malware families specifically used in targeted attacks, there are actually very few different samples in the wild, compared with traditional cybercrime malware. The Microsoft Office files used by the attackers to infiltrate their targets’ networks are also very interesting because they contain metadata. Metadata can be defined as “the information about the information,” which in this case is the information pertaining to the file itself. Some of details of the available metadata were useful, particularly, the creation date, modification date, author, and last modification author. We will tackle the metadata later on in this paper. During the course of this investigation, we found out that some samples of the GHOLE malware have been submitted to an online-malware-scanning site, av.zerodays.ir, to estimate the detection rate of their malware. [5] Three samples appeared to have been scanned using this service before they appeared elsewhere. One sample was submitted 26 days before it was scanned in other online malware analysis service sites. This led us to believe that the malware controllers submitted the original samples to the av.zerodays.ir system themselves. We would like to point out that the av.zerodays.ir online service is free and available to everyone on the Internet. We contacted a representative of the company, who in turn told us that they “do not condone cybercrime or in any way affiliated to any entity that could have been part of this campaign.”The communications established by this malware family from an infected workstation to the C&C server are done by directly communicating with the IP addresses hard coded in the binaries, as seen in the export function display. There were no domain names involved in this campaign. We were able to obtain a list of C&C servers, which are mostly hosted in Germany, via a satellite communication service provider known as Industrieanlagen-Betriebsgesellschaft mbH (IABG): [6] The other IP addresses were used by different malware samples. These IP addresses also belonged to IABG and could all be connected to the same customer. In fact, all of the IP ranges on which these C&C servers are identified belonged to one customer, who rents the following IP ranges from IABG: These details can loosely be tied to the entities presented above but caution is strongly advised because the names are quite common. We have yet to determine if these names belong to one person, if the same person is the one who rents IP ranges from IABG, if his servers were compromised and used as proxy servers, or if he provides part of his infrastructure to the Operation Woolen-GoldFish targeted attack group. Sending out spear-phishing emails is a common technique used as a point of entry in the initial stage of compromise. It is, in fact, still widely used in attempts to gain privileges in targeted companies’ systems. Several social engineering tricks can be used to make a user click a link or open a file. One of the spear-phishing emails sent out by the Rocket Kitten group looked like a simple office correspondence. The attachment was a Microsoft Office file. User participation is needed to execute the macros in the f ile. If the user does not run the macros, the computer will not be infected by the GHOLE malware. By the end of 2014, however, we saw significant changes in the attack behavior of the Rocket Kitten group in terms of spear-phishing campaigns and malware infection scheme. The second spear-phishing email sample has been sent to one target in Israel. This email sample was sent sometime in February 2015. This also used the identity of a recognized Israeli engineer. We anonymized the email address, as well as the OneDrive™ link. We also removed the signature used in it. A known figure in the Israeli defense field was used in a similar tactic with the same email content. The decoy file used an Adobe® .PDF file instead of a Microsoft PowerPoint™ presentation. The .PDF file was a Web article from the Washington Post. The file showed “pc12” as the author and the last modifier. system’s record. The attackers used a OneDrive link in their campaign. OneDrive is a free online cloud storage system from Microsoft that comes with several gigabytes of data storage capacity. The OneDrive link leads to an archive file containing a file named, “Iran’s Missiles Program.ppt.exe.” This file, which has been taken offline, used the PowerPoint icon but was really an executable file. The attackers probably decided to store their malicious binaries online rather than sent them as an attachment to bypass email detection. Once executed, the file drops a nonmalicious PowerPoint file used as a decoy f ile, while silently infecting the system with a variant of the CWoolger keylogger. We decided not to show the content of this file given the sensitivity of the persona impersonated in this social engineering lure. We tried to look for this decoy file on the Internet but it was nowhere to be found, which was quite surprising. We compared the metadata on this file with the other f iles authored by the spoofed engineer and it showed the same exact file properties, particularly the way the “author” field was written. The file also shows a “Last modified by:” field containing the information pc12. Rocket Kitten has signed pc12 at the last modified section of some of the files used in their spear-phishing activities. We do not know if this string refers to one Rocket Kitten member or to a third party, who could have edited the files. The latter is very unlikely though, since it has been used both in campaigns and files aimed at different targets. We believe pc12 is, indeed, an indicator of Rocket Kitten activities. We have a strong suspicion, based on the PowerPoint file, that the spoofed engineer’s computer was compromised by the Rocket Kitten group because he presents an interesting profile and is well-known in his field. Therefore, the file sent to other Israeli targets could have been stolen directly from this person’s computer. Cybercriminals quite often forget about metadata, which is generated by the software they use to produce or modify the files. Those who are more meticulous alter this information to lead investigators to false tracks. As seen above, different authors worked on these files. Wool3n.H4t seemed to be the main author who collaborated with aikido1 and Hoffman. No particular information could be found on aikido1 and Yusi, the supposed partners of Wool3n.h4t. There were also times when Wool3n.H4t used U.S. and U.K. country codes as last modification information. The most recent modification in the two PowerPoint files told us that W00l3n.H4t slowly changed his infecting methods around October 2014. There was not much information on Wool3n.H4t, which is not a common nickname, on the Internet. However, we found that this nickname owned an inactive blog hosted by a free service in Iran and was registered in several underground hacking forums. The blog only contained two posts signed by Masoud_pk, which could be part of the real identity of Wool3nh4t. Masoud is the one of the top 50 commonly used first names in Iran. One malware sample (SHA1 hash: d5b2b30fe2d4759c199e3659d561a50f88a7fb2e; detected as TSPY_ WOOLERG.A) surfaced as we tried to look for more information on Wool3n.H4t. [7] We took interest in this because the binary contained the following debug string: Debug strings are strings that are sometimes left behind in binaries, revealing information about the developer behind the code. This debug string shows us that the binary was compiled by a user account named “Wool3n.H4t,” and that the project behind this code was dubbed “CWoolger.” This malware is a keylogger, although from a technical point of view, it is not as advanced as its contemporaries. The malware also embedded some File Transfer Protocol (FTP) credentials of the attackers in clear text in the binary. Consistent with the other malware used by the threat actors involved in Operation Woolen-GoldFish, the C&C reference is hard-coded as an IP address in the binary. A domain name was not used. Moreover, it lands on the system with a name, which is very similar to some GHOLE malware variants, NTUSER.dat{…}.exe. The malware starts by creating a mutex called “woolger” and creates a copy of itself, %TEMP%\NTSuser.exe, in the TEMP folder before executing it. It creates a VBScript in the same folder named “wsc.vbs.“. The C&C server reached in our sample is 107.6.181.116, which belongs to SingleHop (AS32475). The credentials used to connect with the FTP server are hard-coded in clear text in the binary. When the file is sent to the server, it is renamed using the following format: Operation Woolen-GoldFish is alive and active. From a technical point of view, the threat actors involved in this campaign are less mature in terms of technical capacity and tactic sophistication compared with other targeted attack groups we are monitoring, yet they are improving and gaining traction. The spear-phishing email attacks are getting a little more aggressive and now have less user interaction at the point of entry. Nevertheless, it is unfortunately not because an attacker is inferior in skills that there are fewer victims. Operation Woolen-GoldFish has managed to successfully infiltrate several companies and organizations in Israel and Europe. One PowerPoint file used as a lure in spear-phishing attempts seems to indicate that the group has successfully victimized one well-known engineer in Israel and used one of his unreleased files as bait. Time and again, lack of proper security understanding and implementation has led individual and corporate users around the world to fall victim to creative malicious activities of threat actors. Threat actors are also known to be multiskilled. In this case, we were able to confirm that Wool3n.H4t was not only responsible for most of the infecting Office f iles used, but was also capable of developing malware. The discovery of the CWoolger keylogger compiled on 7 February 2015 may be the strongest indication that this targeted attack group, where Woole3n.H4t seems to a part of, is very active and may be developing its own malware. With Wool3n.H4t as both the malware developer and infrastructure controller, it can be loosely deducted that the group comprise of very few people. Seeing the evolution of this targeted attack group, we believe its members, especially Wool3n.H4t, are traditional or old-fashioned cybercriminals. This assumption is based on the way the campaign spreads and evolves, including the use of nicknames and password used by Wool3n.H4t, which indicates that he rather comes from an underground hacking group. This campaign, like the first one the group launched, shows that the targeted entities do have a particular interest for the Islamic Republic of Iran. While motives behind targeted attack campaigns may differ, the end results are one and the same—shift in power control, either economically or politically. The authors would like to thank Ilja Lebedev for his valuable input in this research.