In mid-May 2021, experts from SOLAR JSOC and the National Computer Incident Response & Coordination Center (NCIRCC) released a joint report on a series of targeted attacks detected in 2020. According to the report, the attackers targeted Russian federal executive authorities. While analyzing the report, Anastasia Tikhonova (Head of APT Research at Group-IB) and Dmitry Kupin (Senior Malware Analyst) noticed that they had already come across similar tools in earlier attacks. Chinese APTs are one of the most numerous and aggressive hacker communities. Several dozen groups conduct attacks in countries all over the world, and Russia is no exception. Hackers mostly target state agencies, industrial facilities, military contractors, and research institutes. The main objective is espionage: attackers gain access to confidential data and attempt to hide their presence for as long as possible. There have been cases when attackers successfully persisted in the victim's network for several years. Unfortunately, the SOLAR JSOC and NCIRCC report did not provide indicators of compromise, so the experts had to rely on descriptions of the functionality and screenshots of the malicious code. As a result, Group-IB's researchers came up with some interesting conclusions about which Chinese groups could be behind the attacks against Russian federal executive authorities in 2020, what tools they used, and how their malware has evolved since.The research describes Webdav-O malware detected in attacks against Russian federal executive authorities in 2020.Group-IB specialists established that Webdav-O has a set of commands similar to a popular Trojan called BlueTraveller (aka RemShell), which was developed in China and has been linked to the hacker group called TaskMasters.Before that, Sentinel Labs released a report about malware called MailO, which was also identified in attacks against Russian federal executive authorities. Mail-O was deemed to be linked to the Chinese hacker group TA428. Group TA428 is known to use a Trojan called Albaniiutas in their attacks. Group-IB's analysis showed that Albaniiutas is an updated version of BlueTraveller.Group-IB experts believe that either both Chinese hacker groups (TA428 and TaskMasters) attacked Russian federal executive authorities in 2020 or that there is one united Chinese hacker group made up of different units. TA428 is a Chinese state-sponsored hacker group that has been operating since 2013. The attackers target a number of government agencies in East Asia that control governmental information technology, domestic and foreign policy, and economic development. TaskMasters (aka BlueTraveller) is a state-sponsored Chinese hacker group that allegedly has been active since at least 2010. The group attacks companies based in several countries, but many of their targets are located in Russia and CIS. The hackers target solid industrial and energy enterprises, government agencies, and transport companies. Starting point.As the experts put it: "The report dwells on the analysis of a series of targeted attacks". Based on this information, we assumed that several hacker groups may be behind the attacks. The attackers used malware that interacted with management server via the cloud service called Yandex.Disk. The malware was dubbed Webdav-O. Attackers also used malicious software that accessed the cloud service Mail.ru. The malware was dubbed Mail-O.In early June 2021, analysts from the American cybersecurity company Sentinel Labs released a report about Mail-O. The experts wrote that Mail-O is a version of the relatively well-known malware called SManager, which is used by the Chinese hacker group TA428. Group-IB specialists wanted to make sure that Mail-O is loader, while Smanager and Tmanger are Remote Access Trojans (RAT). However, a part of the code overlaps in the exported functions "Entery" and "ServiceMain" of Mail-O, SManager and Tmanger, which brings us back to TA428. Moreover, hackers from TA428 have already been found to be involved in espionage against Russia, especially Russian state facilities. To prove the hypothesis that TA428 was behind the attacks against Russian federal executive authorities in 2020, we decided to analyze a sample of Webdav-O. Group-IB Threat Intelligence & Attribution has detected similar malicious behavior before and can now explain why we link it to a specific group. Below we provide an analysis of Webdav-O samples and highlight features that overlap with the points mentioned in the SOLAR JSOC and NCIRCC report.The analyzed file provides remote access to the command line shell (cmd.exe) and executes various commands originating from C2 on the compromised host. The legitimate cloud service called Yandex.Disk (webdav.yandex.ru:443) is used as network infrastructure, namely C&C. Network interaction with the cloud is implemented via the Webdav protocol. The authentication method is Basic. The strings and configuration data are encrypted with the RC4 algorithm using the following key: { 8A 4F 01 47 34 C9 75 F8 2B C8 C1 E9 D2 F3 A5 8B }. The key size is 16 bytes. The analyzed filed can work with 1-7 accounts (in this case only 2 are used, but we will come back to this later). Features of the sample Comparison with the sample presented in the SOLAR JSOC and NCIRCC report When analyzing the code uploaded to VirusTotal, we found many overlapping points with the Trojan described in the SOLAR JSOC and NCIRCC report. Some of the common features can be seen in the screenshot with the malware code, which shows the receipt of the command files list in the test folder: Analysis of password generation In 2019, Elmar Nabigaev (Deputy Director of Expert Security Center Positive Technologies) delivered a report entitled "The TaskMasters APT" (aka BlueTraveller) and gave examples of passwords discovered when investigating the malware campaign: The images above show that the passwords to the Webdav-O account were generated using a similar technique as TaskMasters. The only things that changed were the registry and the key row combination. Blurring the boundaries Considering all the comparisons made and the information discovered about the accounts, we believe that the Chinese hacker group TaskMasters is most likely behind the attacks involving an improved version of the Webdav-O Trojan. The case of TA428, however, is still open to debate. Could both of them be behind the attack against Russian federal executive authorities in 2020? Could there be someone else involved? Or was it the same group? We will continue our investigation and seek more information for analysis. Let us take a look at the report about TA428 and their new tools, in particular the Trojan called Albaniiutas, which was released by NTT Security Corporation in 2020. Fragments of code of the XOR encrypting function in BlueTraveller (on the left) and Albaniiutas (on the right) Moreover, there are common points at the stage of establishing persistence in the system. The screenshots below show that the same DLL name randomization occurs. The same description of the service under which this DLL will work is also displayed.Fragments of code in BlueTraveller (on the left) and Albaniiutas (on the right) It is clear that this part was updated by the hackers, but the commands remain the same: Let's move on to string obfuscation in Albaniiutas. We have established that strings are encrypted using the RC4 algorithm. The encryption key used is L!Q@W#E$R%T^Y&U*A|}t~k. The same encryption key was used in the BlueTraveller server component which stores the log files in the encrypted form: The conclusion is clear: Albaniiutas is nothing but a logic continuation of the malware belonging to the BlueTraveller family. And then it dawned on us鈥he file "y_dll.dll" is an x64 dynamic link library (DLL) that functions as a service in the system. As can be seen, this version of Webdav-O was written for a system with a different bitness and compiled later than our sample of Webdav-O x86 (2018-12 and 2018-07, respectively). The legitimate cloud service Yandex.Disk (webdav.yandex.ru:443) is also used as a network infrastructure, in particular C2. Network interaction with the cloud is carried out via a Webdav protocol. However, this sample supports two authentication methods instead of one in Webdav-O x86: Basic (with a username and password) and OAuth (using a token). The strings and configuration data are encrypted using the RC4 algorithm with the following key: { C3 02 03 04 05 DD EE 08 09 10 11 12 1F D2 15 16 }. The key size is 16 bytes. The analyzed file can work with 1-7 accounts (it works with only one in this case). This sample seemed even more similar to the one described in the SOLAR JSOC and NCIRCC report: unlike our sample, it has the "-sleepuntil" function. Unfortunately colleagues at SOLAR JSOC and NCIRCC did not provide any indicators of compromise, so we can only make comparisons based on screenshots and descriptions of the capabilities of their sample.There is also strong evidence that points to one large hacker group consisting of several intelligence units of the People's Liberation Army of China. For example, unit 61398 from Shanghai is responsible for the actions of a well-known group called APT1 (aka Comment Crew), and unit 61419 from Qingdao has been linked to Tick. Each unit attacks to the fullest, according to a strict timeline and order. This means that one Trojan can be configured and modified by hackers from different departments with different levels of training and with various objectives.