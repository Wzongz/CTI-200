Morphisec Labs has been tracking FIN7 (Carbanak Group) activity for the past several years. 
Morphisec’s ability to collect rich forensic data from memory has provided unique visibility 
into multiple FIN7 campaigns that our researchers were proud to share with MITRE and the 
InfoSec community at large. FIN7 is a well-funded, financially motivated cybercrime group. 
Their advanced techniques and tactics were even emulated in the third round of the MITRE 
ATT&CK evaluations.
This report presents an attack chain that was intercepted and prevented within a customer’s 
network in December 2020, then will focus on a component from a typical FIN7 attack chain 
– JSSLoader. Though JSSLoader is well known as a minimized .NET RAT, not many details have 
been publicly available with respect to various capabilities such as exfiltration, persistence, 
auto-update, malware downloading, and more. Furthermore, in the many occasions where 
JSSLoader is mentioned, there are few details on the complete attack chain. The following 
provides a never-before-seen technical analysis of this infamous group’s JSSLoader as part of 
an end-to-end attack.
Below is an example of a typical phishing campaign that may lead to a FIN7 JSSLoader 
compromise as well as to other malwares such as Qbot; the traffic is then redirected through 
BlackTDS traffic distribution system. In this example, an email is sent from “Natural Health 
Sherpa” with an invoice to pay from Quickbooks.
This VBScript downloads and executes the next stage’s VBScript in memory. This second stage was recently 
introduced. The in-memory script downloads and writes a .NET module (JSSLoader) on disk, then executes the 
module through a scheduled task with a newly introduced timeout delay to bypass attack chain monitoring.
It is worth mentioning that the early versions of the VB scripts have a strong resemblance to the ongoing QBOT 
campaign that may lead to an Egregor compromise.
The JSSLoader is a RAT (Remote Access Trojan) with multiple capabilities that were introduced over time. These 
various capabilities are documented throughout this report. In the specific attack chain that was recently 
intercepted, the RAT typically executes a Takeout which is responsible for the reflective loading and execution of 
a Carbanak.
Not surprisingly, the C2 hosting provider is a company named FranTech Solutions, which has been used before 
by the FIN7 group.
As mentioned in the introduction, the early VBScripts had a resemblance to the QBOT attacks seen earlier this 
year – QBOT-VBS.
The VBScript decodes a list of commands and a URL. This URL is used to download the next stage, the 
JSSLoader. After downloading and saving the JSSLoader into the %temp% directory, it will create a scheduled 
task that executes the file. In the QBOT campaigns, a QBOT executable is the next stage instead of the 
JSSLoader.
Newer VBScripts are divided into two stages. The first one just downloads and executes the second VBScript 
from <url_path>/margaritaThe downloaded VBScript decodes and executes the in-memory VBScript that then downloads and executes the 
next stage JSSloader through a scheduled task, possibly to avoid sequential monitoring of the attack chain. URLs 
to the JSSLoader have a similar pattern – <url_path>/<file_name>.eml.From late October 2020, the adversaries moved to a WSF (Windows Script File) as the first stage script. Basically, 
they wrapped the VBScript from the older version into a WSF.
JSSLoader is a highly maintained minimized .NET RAT backdoor, mostly used by the FIN7 group. It includes the 
following functionality:The following will begin with the most recent sample of the JSSLoader together with its followup stages, then it will 
track its evolution over the past year, skipping over any minor changes.As with many other downloaders, the first exfiltrated information is a precondition for the next execution stage. The 
RAT collects the following:The next stage execution went through a significant evolution over the past year. Immediately following a 
persistence stage, the RAT will wait for a base64 encoded command string to be delivered via a ‘Get’ command from 
the same domain the data had been sent to. As with previous communication attempts, SSL certificate errors will be 
ignored and the unique victim ID will be sent as part of the request.The delivered command is parsed into an array of lines (using new line delimiter), then the real command is 
extracted from between the quotes of the longest line in the array. This string is then written into a file on disk, 
which is later parsed by a pre-built PowerShell command described below. In most cases the string is a compressed 
stream.The executed PowerShell script is known as a Takeout script. Multiple variations of the Takeout script mainly differ 
on how they extract the next stage of in-memory execution through the use of the “$body” parameter, a simple 
retrohunt in VirusTotal shows Takeouts with a full embedded “$body”. In this case, the PowerShell script reads the 
content of a previously written command file as described above, decompresses it in memory, and executes the 
second layer PowerShell. The second layer PowerShell reflectively maps a Carbanak to memory.If there is one thing this analysis shows us, it’s that these threats are a moving target. Thwarting them can only be 
achieved by outpacing their advancements, and knowledge sharing is one of the best ways to do this. MITRE ATT&CK 
is the first place that comes to mind when it comes to knowledge sharing and collaboration around adversarial 
techniques and tactics. 
Threat actors like FIN7 are among a long list of groups that MITRE tracks. This list shows that FIN7’s JSSLoader is no 
exception when it comes to evolving threats. Threat actors constantly change their techniques, continuously evade 
detection, and achieve their adversarial goals despite the security controls that are in place. It takes a new approach 
to end this cycle. 
Morphisec’s R&D team is dedicated to developing technology that does not rely on detecting techniques because 
those are always subject to change. Instead, Morphisec prevents the non-negotiable tactics that the adversaries rely 
on to achieve their goals no matter how many times they evolve their malware. As these new and unknown threats 
like this one are prevented, rich forensic data is collected, analyzed, and shared with the community via our Moving 
Target Defense Blog.