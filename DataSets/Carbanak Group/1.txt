RSA Incident Response and Discovery Practice (RSA IR) analysts spend a significant amount of time engaged in the research, hunting, and effective response of advancedrand persistent actors. A customer engagement early-to-mid-2017 is an excellentexample of a unique case in which RSA lR successfully responded to an intrusionperpetrated by the threat actor group CARBANAK,, also known as FIN7. TheCARBANAK actions illustrated in this post and associated paper were observed withother RSA clients as recently as November 2017, with the methods and intelligencesupplied by these publications having been used successfully to detect and trackattacker activities. Several intrusions associated with the CARBANAK actors have been reported within the lastyear, describing compromises of organizations within bankingm,financialm,hospitality..and restaurant, verticals. However, they all describe a relatively equivalent progression,with only slight deviation in specific attacker actions. The intelligence surroundingDrecent CARBANAK incidents indicate that phishing attacks @ have been the group'sprimary method of initial compromise. After gaining access to a user system, the attackersmove laterally throughout the environment, conduct internal reconnaissance, establishstaging points and internal network paths, harvest credentials, and move towards theirintended target. However, this intrusion began with a significantly higher level of privilege due to the exploitation of the Apache Struts vulnerability CVE-2017-5638 allowing the attackers to quickly gain administrative access within the clientʼs Linux environment. This intrusion presented substantial challenges due to:The attackers' toolset was a mix of custom tools, freely available code, and open sourcesoftware utilities. RSA IR researched all 32 of the malicious fles in theICARBANAK toolsetusing various publicly available and open-source resources. Six of the tools used in thisintrusion were found to have been uploaded to a publicly available anti-virus aggregationsite. Of these six, five have little-to-no detection or indication of malice from antivirusvendors. This observation explains why the client's signature-based host protectionmechanisms were unable to identify or prevent the use of these tools.While the attackers used more than 30 unique samples of malware and tools, they alsodemonstrated a normalization across Windows and Linux with respect to their toolset. Thetoolsets they deployed can be broken down into five basic functionalities:While the attackers used more than 30 unique samples of malware and tools, they alsodemonstrated a normalization across Windows and Linux with respect to their toolset. Thetoolsets they deployed can be broken down into five basic functionalities:.While the attackers used more than 30 unique samples of malware and tools, they also demonstrated a normalization across Windows and Linux with respect to their toolset. The toolsets they deployed can be broken down into five basic functionalities:The ingress, lateral movement, and internal reconnaissance mechanisms used by theattackers during this investigation were not that sophisticated in and of themselves.However, when viewed in aggregate, and from an operational view, RSA observed the actorsnormalized their choice in toolset across the Linux and Windows environments. Theattackers in this engagement primarily used modified versions of legitimate administrativeDtools, commonly used penetration testing utilities, and common network fle acquisitionDtools. Though specialty malware was observed during this intrusion, the attackers usedbasic XOR encoding just above Layer 4 to facilitate communication, communicated via SSHtunnel directly over TCP/443, or just transmitted and received data in clear text across thenetwork. Of the observed actions during this intrusion, none of the attacker tools,techniques, or procedures were particularly advanced. However, they were still able tobypass a significant security stack, obtain initial access and lateral access effectively, deploymalware and toolsets with impunity, and traverse over 150 systems in the span of sixweeks. While, at first glance, this attack was not sophisticated in its toolset, it was.sophisticated in its operationalization and agility of attackers' actions. The correlationsbetween the Linux environment tools and the Windows environment tools are shown below.The ingress, lateral movement, and internal reconnaissance mechanisms used by theattackers during this investigation were not that sophisticated in and of themselves.However, when viewed in aggregate, and from an operational view, RSA observed the actorsnormalized their choice in toolset across the Linux and Windows environments. Theattackers in this engagement primarily used modifed versions of legitimate administrativeDtools, commonly used penetration testing utilities, and common network fle acquisitionDtools. Though specialty malware was observed during this intrusion, the attackers usedbasic XOR encoding just above Layer 4 to facilitate communication, communicated via SSHtunnel directly over TCP/443, or just transmitted and received data in clear text across thenetwork. Of the observed actions during this intrusion, none of the attacker tools,techniques, or procedures were particularly advanced. However, they were still able tobypass a significant security stack, obtain initial access and lateral access effectively, deploymalware and toolsets with impunity, and traverse over 150 systems in the span of sixweeks. While, at first glance, this attack was not sophisticated in its toolset, it was口sophisticated in its operationalization and agility of attackers’actions. The correlationsbetween the Linux environment tools and the Windows environment tools are shown below:RSA IR released a white paper containing an in-depth review of this engagement,including observed attacker operational patterns, TTPs, and the techniques used during thisengagement to successfully track and respond to the threat. The observations illustrated inthis paper identify that not only do CARBANAK actors have the capability to successfullycompromise various operating system environments, they have standardized andoperationalized this capability. This attribute indicates strategic operational thought andeffort being invested in this group's compromises, suggesting that theICARBANAK actorsare working towards becoming a more organized, structured, resourceful, and maturethreat group. During an intrusion, time is the single most critical resource to an organization's securityteam and is the most significant indicator of determining if the security team will beDsuccessful in containing, eradicating, and remediating the extant threat. There are twospecific sets of time related to an intrusion that may determine the difference betweenDsuccess and failure: the time that the attackers are in the environment prior to detection(dwell time), and the time it takes security teams to identify, investigate, understand, andcontain the attacker's actions (response time). in this specific incident, the attacker's dwelltime at intrusion declaration was 35 days, which is a significant amount of time given theDlevel of access immediately available upon compromise. However, by utilizingthe methodology and visibility described in this paper, RSA lR was able to completecontainment, eradication, and remediation in on/ynine days. We also discuss the ㄖmethodology used by RSA IR to successfully detect, investigate, understand, andcontain the attackers before the actors could achieve their intended goal. The CARBANAK actors not only showed the capability to successfully compromise bothLinux and Windows systems, they chose a toolset that was either directly cross-platform orextremely similar in both function and command line usage. This indicates a level oftactical organization and operationalization not previously observed by this actor group.Additionally, they were significantly cognizant and aware of actions taken by the securityDteam, switching to new methods ofingress after initial compromise, detected remediationactions, and environmental migration. They were methodical in their choice of stagingsystems,basing the system utilized on:They chose key systems based on their needs rather than systems the organization would consider ʻkeyʼ assets. They ensured the toolsets they would interact with most often contained very similar functions and commands across environments in order to limit mistakes made at the keyboard. They included a method, whether manually or automatically, to remove any record of their activities. They operated with purpose, patience, planning, and most significantly, persistence.This intrusion was successfully discovered, investigated, contained, eradicated, and remediated only due to the following reasons: While a first look at the tools used in this engagement may appear simplistic, upon reviewDof the entire intrusion, it becomes quickly apparent that each of them was purpose-chosenwith an overall operationalized capability in mind. CARBANAK has shown themselves to bea coordinated and extremely persistent group of actors that are consistently movingtowards more agile methods of intrusion and standardization of processes across heterogeneous environments. They have proven their capability to use that persistence andagility to defeat or bypass organizational security controls. Even with the least advanced oftheir capabilities, they can be a diffcult adversary to track within an environment due totheir speed, efficiency, adaptability, and care in leaving little trace of any activity. However,[this difficulty compounds exponentially for organizations without the necessary visibility,0practices, methodologies, or trusted partner relationships necessary to effectively detectDand respond to these types of threats. This white paper shows that with the necessaryvisibility, planning, methodology, and analyst enablement, organizations can be successfulagainst these types of threats.