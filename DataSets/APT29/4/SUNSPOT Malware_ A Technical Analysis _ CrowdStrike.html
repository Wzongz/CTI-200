<!DOCTYPE html>
<html lang="en" country="us">
<head>

<script data-cfasync="false">
        !function(e,a,n,t){
            var i=e.head;
            if(i){
                if (a) return;
                var o=e.createElement("style");
                o.id="alloy-prehiding",o.innerText=n,i.appendChild(o),setTimeout(function(){o.parentNode&&o.parentNode.removeChild(o)},t)
            }
        }(document, document.location.href.indexOf("adobe_authoring_enabled") !== -1, "[data-target-location='true'] { opacity: 0 !important}", 3000);
        function loadScript(t,a,e){(a=t.createElement("script")).type="text/javascript",a.dataset.cfasync=!1,a.async=!1,a.onload=function(){},a.src=e,t.getElementsByTagName("head")[0].appendChild(a)}
        if (window.location.hostname.startsWith('www.crowdstrike.')) {
            ((e,t)=>loadScript(e,t,"https://assets.adobedtm.com/d72cd986aea0/09e1256af957/launch-6cccf53edc18.min.js"))(document);
        } else {
            ((e,t)=>loadScript(e,t,"https://assets.adobedtm.com/d72cd986aea0/09e1256af957/launch-19765e16f88b-development.min.js"))(document);
        }
    </script>

<script type="text/javascript" src="https://cdn.cookielaw.org/consent/bee15b7c-b632-450e-9003-9c8b60b3b978/OtAutoBlock.js"></script>
<script>
console.log("Start otSDKStub script");
if (window.location.hostname.startsWith('www.crowdstrike.')) {

    const script = document.createElement('script');

    script.setAttribute('type', 'text/javascript');
    script.setAttribute('src', 'https://cdn.cookielaw.org/scripttemplates/otSDKStub.js');
    script.setAttribute('data-document-language', 'true');
    script.setAttribute('data-domain-script', 'bee15b7c-b632-450e-9003-9c8b60b3b978');
    script.setAttribute('charset', 'UTF-8');
    document.head.appendChild(script);

    console.log("Production OT script executed");
} else {

    const script = document.createElement('script');

    script.setAttribute('type', 'text/javascript');
    script.setAttribute('src', 'https://cdn.cookielaw.org/scripttemplates/otSDKStub.js');
    script.setAttribute('data-document-language', 'true');
    script.setAttribute('data-domain-script', 'bee15b7c-b632-450e-9003-9c8b60b3b978-test');
    script.setAttribute('charset', 'UTF-8');
    document.head.appendChild(script);

   console.log("Development OT script executed - bee15b7c-b632-450e-9003-9c8b60b3b978-test");
}


console.log("End otSDKStub script");
</script>
<script type="text/javascript">
    function OptanonWrapper() { }
</script> <meta charset="UTF-8">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta http-equiv="cleartype" content="on">
<meta http-equiv="content-language" content="en" />
<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />

<title>SUNSPOT Malware: A Technical Analysis | CrowdStrike</title>
<meta name="description" content="In this blog, we offer a technical analysis of SUNSPOT, malware that was deployed into the build environment to inject this backdoor into the SolarWinds Orion platform." />
<link rel="canonical" href="https://www.crowdstrike.com/blog/sunspot-malware-technical-analysis/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="SUNSPOT Malware: A Technical Analysis | CrowdStrike" />
<meta property="og:description" content="In this blog, we offer a technical analysis of SUNSPOT, malware that was deployed into the build environment to inject this backdoor into the SolarWinds Orion platform." />
<meta property="og:url" content="https://www.crowdstrike.com/blog/sunspot-malware-technical-analysis/" />
<meta property="og:site_name" content="crowdstrike.com" />
<meta property="article:publisher" content="https://www.facebook.com/CrowdStrike/" />
<meta property="article:published_time" content="2021-01-11T20:09:35+00:00" />
<meta property="article:modified_time" content="2021-07-13T16:13:41+00:00" />
<meta property="og:image" content="https://www.crowdstrike.com/wp-content/uploads/2021/01/Blog_1060x698-33-1.jpg" />
<meta property="og:image:width" content="1060" />
<meta property="og:image:height" content="698" />
<meta property="og:image:type" content="image/jpeg" />
<meta name="author" content="CrowdStrike Intelligence Team" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content="@CrowdStrike" />
<meta name="twitter:site" content="@CrowdStrike" />
<meta name="twitter:label1" content="Written by" />
<meta name="twitter:data1" content="CrowdStrike Intelligence Team" />
<meta name="twitter:label2" content="Est. reading time" />
<meta name="twitter:data2" content="16 minutes" />
<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://www.crowdstrike.com/blog/sunspot-malware-technical-analysis/#article","isPartOf":{"@id":"https://www.crowdstrike.com/blog/sunspot-malware-technical-analysis/"},"author":{"name":"CrowdStrike Intelligence Team","@id":"https://www.crowdstrike.com/#/schema/person/f54c204296f34c511d79d2e06adcc7fc"},"headline":"SUNSPOT: An Implant in the Build Process","datePublished":"2021-01-11T20:09:35+00:00","dateModified":"2021-07-13T16:13:41+00:00","mainEntityOfPage":{"@id":"https://www.crowdstrike.com/blog/sunspot-malware-technical-analysis/"},"wordCount":2351,"publisher":{"@id":"https://www.crowdstrike.com/#organization"},"image":{"@id":"https://www.crowdstrike.com/blog/sunspot-malware-technical-analysis/#primaryimage"},"thumbnailUrl":"https://www.crowdstrike.com/wp-content/uploads/2021/01/Blog_1060x698-33-1.jpg","keywords":["featured","Home Feature"],"articleSection":["Counter Adversary Operations"],"inLanguage":"en-US"},{"@type":"WebPage","@id":"https://www.crowdstrike.com/blog/sunspot-malware-technical-analysis/","url":"https://www.crowdstrike.com/blog/sunspot-malware-technical-analysis/","name":"SUNSPOT Malware: A Technical Analysis | CrowdStrike","isPartOf":{"@id":"https://www.crowdstrike.com/#website"},"primaryImageOfPage":{"@id":"https://www.crowdstrike.com/blog/sunspot-malware-technical-analysis/#primaryimage"},"image":{"@id":"https://www.crowdstrike.com/blog/sunspot-malware-technical-analysis/#primaryimage"},"thumbnailUrl":"https://www.crowdstrike.com/wp-content/uploads/2021/01/Blog_1060x698-33-1.jpg","datePublished":"2021-01-11T20:09:35+00:00","dateModified":"2021-07-13T16:13:41+00:00","description":"In this blog, we offer a technical analysis of SUNSPOT, malware that was deployed into the build environment to inject this backdoor into the SolarWinds Orion platform.","inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://www.crowdstrike.com/blog/sunspot-malware-technical-analysis/"]}]},{"@type":"ImageObject","inLanguage":"en-US","@id":"https://www.crowdstrike.com/blog/sunspot-malware-technical-analysis/#primaryimage","url":"https://www.crowdstrike.com/wp-content/uploads/2021/01/Blog_1060x698-33-1.jpg","contentUrl":"https://www.crowdstrike.com/wp-content/uploads/2021/01/Blog_1060x698-33-1.jpg","width":1060,"height":698},{"@type":"WebSite","@id":"https://www.crowdstrike.com/#website","url":"https://www.crowdstrike.com/","name":"crowdstrike.com","description":"Next-Generation Endpoint Protection","publisher":{"@id":"https://www.crowdstrike.com/#organization"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://www.crowdstrike.com/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"Organization","@id":"https://www.crowdstrike.com/#organization","name":"CrowdStrike","url":"https://www.crowdstrike.com/","logo":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://www.crowdstrike.com/#/schema/logo/image/","url":"https://www.crowdstrike.com/wp-content/uploads/2022/08/CS_Logos_2022_Inline_Red-Black_RGB.png","contentUrl":"https://www.crowdstrike.com/wp-content/uploads/2022/08/CS_Logos_2022_Inline_Red-Black_RGB.png","width":112,"height":112,"caption":"CrowdStrike"},"image":{"@id":"https://www.crowdstrike.com/#/schema/logo/image/"},"sameAs":["https://www.facebook.com/CrowdStrike/","https://twitter.com/CrowdStrike","https://www.instagram.com/crowdstrike/","https://www.linkedin.com/company/crowdstrike/","https://www.youtube.com/user/CrowdStrike"]},{"@type":"Person","@id":"https://www.crowdstrike.com/#/schema/person/f54c204296f34c511d79d2e06adcc7fc","name":"CrowdStrike Intelligence Team","image":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://www.crowdstrike.com/#/schema/person/image/","url":"http://1.gravatar.com/avatar/120775ff9c9303ebd170cc1bcfbfdcbc?s=96&d=mm&r=g","contentUrl":"http://1.gravatar.com/avatar/120775ff9c9303ebd170cc1bcfbfdcbc?s=96&d=mm&r=g","caption":"CrowdStrike Intelligence Team"},"url":"https://www.crowdstrike.com/blog/author/crowdstrike-intelligence-team/"}]}</script>

<style id="classic-theme-styles-inline-css" type="text/css">
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id="global-styles-inline-css" type="text/css">
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}body .is-layout-grid{display: grid;}body .is-layout-grid > *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}
</style>
<link rel="stylesheet" id="single-post.min.css-css" href="https://www.crowdstrike.com/wp-content/themes/main-theme/dist/styles/pages/single-post.min.css?ver=1700261575" type="text/css" media="all" />
<link rel="stylesheet" id="theme-styles-css" href="https://www.crowdstrike.com/wp-content/themes/main-theme/dist/styles/theme-styles.min.css?ver=1700261575" type="text/css" media="screen" />
<link rel="stylesheet" id="tablepress-default-css" href="https://www.crowdstrike.com/wp-content/tablepress-combined.min.css?ver=29" type="text/css" media="all" />
<link rel="stylesheet" id="font-awesome-official-css" href="https://use.fontawesome.com/releases/v6.4.2/css/all.css" type="text/css" media="all" integrity="sha384-blOohCVdhjmtROpu8+CfTnUWham9nkX7P7OZQMst+RUnhtoY/9qemFAkIKOYxDI3" crossorigin="anonymous" />
<link rel="stylesheet" id="font-awesome-official-v4shim-css" href="https://use.fontawesome.com/releases/v6.4.2/css/v4-shims.css" type="text/css" media="all" integrity="sha384-IqMDcR2qh8kGcGdRrxwop5R2GiUY5h8aDR/LhYxPYiXh3sAAGGDkFvFqWgFvTsTd" crossorigin="anonymous" />
<script type="text/javascript" src="https://www.crowdstrike.com/wp-content/themes/main-theme/dist/scripts/fetch-inject.js?ver=1700261575" id="fetch-inject-js"></script>
<script type="text/javascript" src="https://www.crowdstrike.com/wp-content/themes/main-theme/dist/scripts/components/blog-navigation.min.js?ver=1700261575" id="blog-navigation-js"></script>
<script type="text/javascript" src="https://www.crowdstrike.com/wp-content/themes/main-theme/dist/scripts/components/blog-free-trial.min.js?ver=1700261575" id="blog-free-trial-js"></script>
<script type="text/javascript" src="https://www.crowdstrike.com/wp-content/themes/main-theme/dist/scripts/components/blog-categories.min.js?ver=1700261575" id="blog-categories-js"></script>
<script type="text/javascript" src="https://www.crowdstrike.com/wp-content/themes/main-theme/dist/scripts/components/blog-category-sidebar.min.js?ver=1700261575" id="blog-category-sidebar-js"></script>
<link rel="shortlink" href="https://www.crowdstrike.com/?p=41977" />
<link rel="icon" href="https://www.crowdstrike.com/wp-content/uploads/2018/09/favicon-96x96.png" sizes="32x32" />
<link rel="icon" href="https://www.crowdstrike.com/wp-content/uploads/2018/09/favicon-96x96.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://www.crowdstrike.com/wp-content/uploads/2018/09/favicon-96x96.png" />
<meta name="msapplication-TileImage" content="https://www.crowdstrike.com/wp-content/uploads/2018/09/favicon-96x96.png" />
</head><body class="post-template-default single single-post postid-41977 single-format-standard lang-en">

<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5V5LPNC&nojs=1"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Organization",
        "name": "CrowdStrike",
        "url": "http://www.crowdstrike.com",
        "logo": "http://www.crowdstrike.com/wp-content/img/cs_logo.png",
        "sameAs": [
            "http://www.facebook.com/CrowdStrike/",
            "http://www.twitter.com/CrowdStrike/",
            "https://plus.google.com/101967380457820256808/",
            "http://www.linkedin.com/company/crowdstrike",
            "http://www.youtube.com/user/CrowdStrike"
        ]
    }
</script>
<div data-id="wistia_player_embed"></div>
<div id="modal-mask" class="modal_insert_location">
<div class="container">
<div class="row">
<div class="col-lg-12">
<div id="modal-inner-mask" class="modal_mask">
<div class="close_button"><i id="modal-close" class="fa fa-close"></i></div>
<div class="modal-insert-wrapper">
<h1 id="modal-title" class="modalHeaderTitle"></h1>
<div id="modal-insert" class="modal_content"></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="blogNavInsertLocation"></div>
<div class="search_modal">
<div class="cs_header_container search_modal__section centered">
<input type="text" id="addsearchfield" class="addsearch" placeholder="Search" data-addsearch-id="asw_01" />
<script>
            window.addsearch_settings = {
                "asw_01": {
                    "placeholder": "Search",
                    "show_search_suggestions": false,
                    "search_suggestion_position": "left",
                    "default_sortby": "relevance",
                    "display_date": false,
                    "display_meta_description": false,
                    "display_result_image": true,
                    "link_target": "_self",
                    "hide_logo": true,
                    "direction": "ltr",
                    "analytics_enabled": false,
                    "automatic_filter_results_by_site_language": false,
                    "results_box_css_classname": "addsearch-results",
                    "search_query_parameter": "",
                    "automatic_filter_results_by_site_language": true
                }
            }
        </script>
<script src="https://cdn.addsearch.com/v5/addsearch-ui.min.js?key=7737a29b854de71521b1cd72c4118cfc&id=asw_01"></script>
</div>
</div><div class="cs_page_container ">
<div class="cs_page_content">
<div id="mobileNav" class="mobile_nav_section"></div>
<div class="cs_main_section">
<main class="main" data-ping="false"> <article>
<div class="container">
<div class="row">
<div class="col-12 col-lg-8">
<h1>SUNSPOT: An Implant in the Build Process</h1>
<div class="publish_info">
<p>January 11, 2021</p> <a href="https://www.crowdstrike.com/blog/author/crowdstrike-intelligence-team/" title="Posts by CrowdStrike Intelligence Team" rel="author">CrowdStrike Intelligence Team</a> <a href="https://www.crowdstrike.com/blog/category/counter-adversary-operations/" title="Counter Adversary Operations">Counter Adversary Operations</a> </div>
<div class="post_image"><img width="1060" height="698" src="https://www.crowdstrike.com/wp-content/uploads/2021/01/Blog_1060x698-33-1.jpg" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt decoding="async" fetchpriority="high" srcset="https://www.crowdstrike.com/wp-content/uploads/2021/01/Blog_1060x698-33-1.jpg 1060w, https://www.crowdstrike.com/wp-content/uploads/2021/01/Blog_1060x698-33-1-300x198.jpg 300w, https://www.crowdstrike.com/wp-content/uploads/2021/01/Blog_1060x698-33-1-1024x674.jpg 1024w, https://www.crowdstrike.com/wp-content/uploads/2021/01/Blog_1060x698-33-1-768x506.jpg 768w" sizes="(max-width: 1060px) 100vw, 1060px" /></div>
<div class="blog_content">
<p><span style="font-weight: 400;">In December 2020, the industry was rocked by the disclosure of a complex supply chain attack against SolarWinds, Inc., a leading provider of network performance monitoring tools used by organizations of all sizes across the globe. CrowdStrike and another firm have been supporting SolarWinds in its investigation and root cause analysis of the events that led to the inclusion of unauthorized malicious code into its build cycle. In coordination with <a href="https://orangematter.solarwinds.com/2021/01/11/new-findings-from-our-investigation-of-sunburst">SolarWinds, which has posted a blog</a> detailing its efforts to ensure the security of its customers and build processes, CrowdStrike is providing a technical analysis of a malicious tool that was deployed into the build environment to inject this backdoor into the SolarWinds Orion platform without arousing the suspicion of the development team charged with delivering the product. At this time, CrowdStrike does not attribute the SUNSPOT implant, <a href="https://www.google.com/url?q=https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html&amp;sa=D&amp;ust=1610392135094000&amp;usg=AOvVaw2PE38JjvaIWmhkzPg-HoAG">SUNBURST backdoor</a> or TEARDROP post-exploitation tool to any known adversary; as such, CrowdStrike Intelligence is tracking this intrusion under the StellarParticle activity cluster.</span></p>
<h2><span style="font-weight: 400;">Key Points</span></h2>
<ul>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">SUNSPOT is StellarParticle’s malware used to insert the SUNBURST backdoor into software builds of the SolarWinds Orion IT management product.</span></li>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">SUNSPOT monitors running processes for those involved in compilation of the Orion product and replaces one of the source files to include the SUNBURST backdoor code.</span></li>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Several safeguards were added to SUNSPOT to avoid the Orion builds from failing, potentially alerting developers to the adversary’s presence. </span></li>
</ul>
<p><span style="font-weight: 400;">Analysis of a SolarWinds software build server provided insights into how the process was hijacked by StellarParticle in order to insert SUNBURST into the update packages. The design of SUNSPOT suggests StellarParticle developers invested a lot of effort to ensure the code was properly inserted and remained undetected, and prioritized operational security to avoid revealing their presence in the build environment to SolarWinds developers.</span></p>
<h2><span style="font-weight: 400;">Technical Analysis</span></h2>
<p><span style="font-weight: 400;">SUNSPOT was identified on disk with a filename of </span><code><span style="font-weight: 400;">taskhostsvc.exe</span></code><span style="font-weight: 400;"> (SHA256 Hash: </span><code><span style="font-weight: 400;">c45c9bda8db1d470f1fd0dcc346dc449839eb5ce9a948c70369230af0b3ef168</span></code><span style="font-weight: 400;">), and internally named </span><code><span style="font-weight: 400;">taskhostw.exe</span></code><span style="font-weight: 400;"> by its developers. It was likely built on 2020-02-20 11:40:02, according to the build timestamp found in the binary, which is consistent with the currently assessed StellarParticle supply chain attack timeline. StellarParticle operators maintained the persistence of SUNSPOT by creating a scheduled task set to execute when the host boots. </span></p>
<h3><span style="font-weight: 400;">Initialization and Logging</span></h3>
<p><span style="font-weight: 400;">When SUNSPOT executes, it creates a mutex named </span><code><span style="font-weight: 400;">{12d61a41-4b74-7610-a4d8-3028d2f56395}</span></code><span style="font-weight: 400;"> to ensure only one instance is running. It then creates an encrypted log file at </span><code><span style="font-weight: 400;">C:\Windows\Temp\vmware-vmdmp.log</span></code><span style="font-weight: 400;">. Individual log entries are encrypted with the stream cipher RC4, using the hard-coded key </span><code><span style="font-weight: 400;">FC F3 2A 83 E5 F6 D0 24 A6 BF CE 88 30 C2 48 E7</span></code><span style="font-weight: 400;">. Throughout execution, SUNSPOT will log errors to this file, along with other deployment information. Log entries are delineated by the hex string </span><code><span style="font-weight: 400;">32 78 A5 E7 1A 79 91 AC</span></code><span style="font-weight: 400;"> and begin with the number of seconds elapsed since the first log line. Most log lines corresponding to an error contain a step number (e.g., </span><i><span style="font-weight: 400;">Step19</span></i><span style="font-weight: 400;">) requiring knowledge of the malware to understand their meaning. These steps and their mapping to the malware actions are provided at the end of this blog. The step numbering does not follow the actual execution order, suggesting the calls to the logging function were added by the developers during the creation of the malware as they progressed and needed to focus their efforts on debugging one part of the code. An extract of a log file generated by SUNSPOT in a test environment is given below.</span></p>
<div class="blog-post-code-wrapper"><code><span style="font-weight: 400;">0.000 START<br/>
</span><span style="font-weight: 400;">22.781[3148] + 'msbuild.exe' [6252]<br/>
</span><span style="font-weight: 400;">181.421[3148] - 0<br/>
</span><span style="font-weight: 400;">194.343[3148] -<br/>
</span><span style="font-weight: 400;">194.343[13760] + 'msbuild.exe' [6252]<br/>
</span><span style="font-weight: 400;">322.812[13760] - 0<br/>
</span><span style="font-weight: 400;">324.250[13760] -<br/>
</span><span style="font-weight: 400;">324.250[14696] + 'msbuild.exe' [6252]<br/>
</span><span style="font-weight: 400;">351.125[14696] - 0<br/>
</span><span style="font-weight: 400;">352.031[14176] + 'msbuild.exe' [6252]<br/>
</span><span style="font-weight: 400;">369.203[14696] -<br/>
</span><span style="font-weight: 400;">375.093[14176] - 0<br/>
</span><span style="font-weight: 400;">376.343[14176] -<br/>
</span><span style="font-weight: 400;">376.343[11864] + 'msbuild.exe' [6252]<br/>
</span><span style="font-weight: 400;">426.500[11864] - 0<br/>
</span><span style="font-weight: 400;">439.953[11864] -<br/>
</span><span style="font-weight: 400;">439.953[9204] + 'msbuild.exe' [6252]<br/>
</span><span style="font-weight: 400;">485.343[9204] Solution directory: C:\Users\User\Source<br/>
</span><span style="font-weight: 400;">485.343[ERROR] Step4('C:\Users\User\Source\Src\Lib\SolarWinds.Orion.Core.BusinessLayer\BackgroundInventory\InventoryManager.cs') fails</span></code></div>
<p><span style="font-weight: 400;">The malware then grants itself debugging privileges by modifying its security token to add </span><code><span style="font-weight: 400;">SeDebugPrivilege</span></code><span style="font-weight: 400;">. This step is a prerequisite for the remainder of SUNSPOT’s execution, which involves reading other processes&#8217; memory. </span></p>
<h3><span style="font-weight: 400;">Build Hijacking Steps</span></h3>
<h4><span style="font-weight: 400;">Monitoring of Running Software Build Processes</span></h4>
<p><span style="font-weight: 400;">After initialization, SUNSPOT monitors running processes for instances of </span><code><span style="font-weight: 400;">MsBuild.exe</span></code><span style="font-weight: 400;">, which is part of Microsoft Visual Studio development tools. Copies of </span><code><span style="font-weight: 400;">MsBuild.exe</span></code><span style="font-weight: 400;"> are identified by hashing the name of each running process and comparing it to the corresponding value, </span><code><span style="font-weight: 400;">0x53D525</span></code><span style="font-weight: 400;">. The hashing algorithm used for the comparison is ElfHash and is provided in Python in Figure 1.</span></p>
<div class="blog-post-code-wrapper">
<p style="text-align: left;"><code><strong><span style="color: #008000;">def </span><span style="color: #0000ff;">elf_hash</span></strong><span style="font-weight: 400;">(name):<br/>
</span><span style="font-weight: 400;">    </span><span style="font-weight: 400;"># Test input: b'msbuild.exe'<br/>
</span><span style="font-weight: 400;">    </span><span style="font-weight: 400;"># Test output: 0x53D525<br/>
</span><span style="font-weight: 400;">    h = </span><strong><span style="color: #0000ff;">0</span></strong><b><br/>
</b><span style="font-weight: 400;">    </span><span style="color: #008000;"><b>for</b></span><span style="font-weight: 400;"> c </span><span style="color: #0000ff;"><b>in</b></span><span style="font-weight: 400;"> name:<br/>
</span><span style="font-weight: 400;">        v = (c + (h &lt;&lt; </span><b>4</b><span style="font-weight: 400;">))<br/>
</span><span style="font-weight: 400;">        msb = v &amp; </span><strong><span style="color: #0000ff;">0xF0000000</span></strong><b><br/>
</b><span style="font-weight: 400;">       <strong> </strong></span><strong><span style="color: #008000;">if</span></strong><span style="font-weight: 400;"> msb != </span><strong><span style="color: #0000ff;">0</span></strong><span style="font-weight: 400;">:<br/>
</span><span style="font-weight: 400;">            v ^= (msb &gt;&gt; </span><strong><span style="color: #0000ff;">24</span></strong><span style="font-weight: 400;">)<br/>
</span><span style="font-weight: 400;">        h = ~msb &amp; v<br/>
</span><span style="font-weight: 400;">    </span><strong><span style="color: #008000;">return</span></strong><span style="font-weight: 400;"> h</span></code></p>
</div>
<p><span style="font-weight: 400;">Figure 1. Process Name Hashing Logic</span></p>
<p><span style="font-weight: 400;">When SUNSPOT finds an </span><code><span style="font-weight: 400;">MsBuild.exe</span></code><span style="font-weight: 400;"> process, it will spawn a new thread to determine if the Orion software is being built and, if so, hijack the build operation to inject SUNBURST. The monitoring loop executes every second, allowing SUNSPOT to modify the target source code before it has been read by the compiler.</span></p>
<p><span style="font-weight: 400;">Although the mutex created during the initialization should already prevent multiple process monitoring loops from running, the malware checks for the presence of a second mutex — </span><code><span style="font-weight: 400;">{56331e4d-76a3-0390-a7ee-567adf5836b7}</span></code><span style="font-weight: 400;">. If this mutex is found, the backdoor interprets it as a signal to quit, waits for the completion of its currently running backdoor injection threads, and exits. This mutex was likely intended to be used by StellarParticle operators to discreetly stop the malware, instead of using a riskier method such as killing the process. Stopping SUNSPOT in the middle of its operation could result in unfinished tampering of the Orion source code, and lead to Orion build errors that SolarWinds developers would investigate, revealing the adversary’s presence.</span></p>
<h4><span style="font-weight: 400;">Command-Line Arguments Extraction from Process Memory</span></h4>
<p><span style="font-weight: 400;">The malware extracts the command-line arguments for each running </span><code><span style="font-weight: 400;">MsBuild.exe</span></code><span style="font-weight: 400;"> process from the virtual memory using a methodology similar to one publicly documented<sup>1</sup>.</span></p>
<p><span style="font-weight: 400;">A call to </span><code><span style="font-weight: 400;">NtQueryInformationProcess</span></code><span style="font-weight: 400;"> allows the adversary to obtain a pointer to the remote process’s Process Environment Block (PEB), which contains a pointer to a </span><code><span style="font-weight: 400;">_RTL_USER_PROCESS_PARAMETERS</span></code><span style="font-weight: 400;"> structure. The latter is read to get the full command line passed to the </span><code><span style="font-weight: 400;">MsBuild.exe</span></code><span style="font-weight: 400;"> process.</span></p>
<p><span style="font-weight: 400;">The command line is then parsed to extract individual arguments, and SUNSPOT looks for the directory path of the Orion software Visual Studio solution. This value is hard-coded in the binary, in an encrypted form using AES128-CBC, whose parameters are given below. The same material is used for all of the blobs encrypted with AES in the binary.</span></p>
<div class="blog-post-code-wrapper">
<p><code><span style="font-weight: 400;">key = FC F3 2A 83 E5 F6 D0 24 A6 BF CE 88 30 C2 48 E7 (same as the RC4 key)</span></code></p>
<p><code><span style="font-weight: 400;">iv  = 81 8C 85 49 B9 00 06 78 0B E9 63 60 26 64 B2 DA</span></code></p>
</div>
<p><span style="font-weight: 400;">The key and initialization vector (IV) are not unique and can be independently found in other binary samples of several popular video games. It is plausible the material was chosen on purpose in order to make static detections on the values impractical.</span></p>
<h4><span style="font-weight: 400;">Orion Source Code Replacement</span></h4>
<p><span style="font-weight: 400;">When SUNSPOT finds the Orion solution file path in a running </span><code><span style="font-weight: 400;">MsBuild.exe</span></code><span style="font-weight: 400;"> process, it replaces a source code file in the solution directory, with a malicious variant to inject SUNBURST while Orion is being built. While SUNSPOT supports replacing multiple files, the identified copy only replaces </span><code><span style="font-weight: 400;">InventoryManager.cs</span></code><em><span style="font-weight: 400;">.</span></em><i><span style="font-weight: 400;"> </span></i></p>
<p><span style="font-weight: 400;">The malicious source code for SUNBURST, along with target file paths, are stored in AES128-CBC encrypted blobs and are protected using the same key and initialization vector.</span></p>
<p><span style="font-weight: 400;">As causing build errors would very likely prompt troubleshooting actions from the Orion developers and lead to the adversary’s discovery, the SUNSPOT developers included a hash verification check, likely to ensure the injected backdoored code is compatible with a known source file, and also avoid replacing the file with garbage data from a failed decryption. In the exemplar SUNSPOT sample, the MD5 hash for the backdoored source code is </span><code><span style="font-weight: 400;">5f40b59ee2a9ac94ddb6ab9e3bd776ca</span></code><span style="font-weight: 400;">.</span></p>
<p><span style="font-weight: 400;">If the decryption of the parameters (target file path and replacement source code) is successful and if the MD5 checks pass, SUNSPOT proceeds with the replacement of the source file content. The original source file is copied with a </span><code><span style="font-weight: 400;">.bk</span></code><span style="font-weight: 400;"> extension (e.g., </span><code><span style="font-weight: 400;">InventoryManager.bk</span></code><span style="font-weight: 400;">), to back up the original content. The backdoored source is written to the same filename, but with a </span><code><span style="font-weight: 400;">.tmp</span></code><span style="font-weight: 400;"> extension (e.g., </span><code><span style="font-weight: 400;">InventoryManager.tmp</span></code><span style="font-weight: 400;">), before being moved using </span><code><span style="font-weight: 400;">MoveFileEx</span></code><span style="font-weight: 400;"> to the original filename (</span><code><span style="font-weight: 400;">InventoryManager.cs</span></code><span style="font-weight: 400;">). After these steps, the source file backdoored with SUNBURST will then be compiled as part of the standard process.</span></p>
<p><span style="font-weight: 400;">SUNSPOT appends an entry in the log file with the date and time of the backdoor attempt and waits for the </span><code><span style="font-weight: 400;">MsBuild.exe</span></code><span style="font-weight: 400;"> process to exit before restoring the original source code and deleting the temporary </span><code><span style="font-weight: 400;">InventoryManager.bk</span></code><span style="font-weight: 400;"> file. If the Orion solution build is successful, it is backdoored with SUNBURST.</span></p>
<h4><span style="font-weight: 400;">SUNBURST Source Code</span></h4>
<p><span style="font-weight: 400;">The source code of SUNBURST was likely sanitized before being included in SUNSPOT. The use of generic variable names, pre-obfuscated strings, and the lack of developer comments or disabled code is similar to what could be obtained after decompiling a backdoored Orion binary, as illustrated in Figure 2, which provides a comparison between the injected source code (top) and a decompilation output (bottom).</span></p>
<div class="blog-post-code-wrapper">
<p><code><span style="color: #3366ff;"><span style="font-weight: 400;">private</span> <span style="font-weight: 400;">static</span> <span style="font-weight: 400;">class</span></span> <span style="color: #800080;"><strong>ProcessTracker</strong></span></code><code><span style="font-weight: 400;">{</span></code></p>
<p><code><span style="font-weight: 400;"> <span style="color: #3366ff;">  </span></span><span style="color: #3366ff;"><span style="font-weight: 400;">private</span> <span style="font-weight: 400;">static</span> <span style="font-weight: 400;">readonly</span> <span style="font-weight: 400;">object</span><span style="font-weight: 400;"> _lock </span><span style="font-weight: 400;">=</span> <span style="font-weight: 400;">new</span> <span style="font-weight: 400;">object</span><span style="font-weight: 400;">();</span></span></code></p>
<p><code><span style="color: #3366ff;"><span style="font-weight: 400;">   </span><span style="font-weight: 400;">private</span> <span style="font-weight: 400;">static</span> <span style="font-weight: 400;">bool</span></span> <span style="color: #800000;"><strong>SearchConfigurations</strong></span><span style="font-weight: 400;">()</span></code></p>
<p><code><span style="font-weight: 400;">   </span><span style="font-weight: 400;">{</span></code></p>
<p><code><span style="font-weight: 400;">    <span style="color: #3366ff;">   </span></span><span style="font-weight: 400; color: #3366ff;">using</span> <span style="color: #800080;"><span style="font-weight: 400;">(</span><span style="font-weight: 400;">ManagementObjectSearcher</span><span style="font-weight: 400; color: #000000;"> managementObjectSearcher </span><span style="font-weight: 400;">=</span> <span style="font-weight: 400;">new</span> <span style="font-weight: 400;">ManagementObjectSearcher</span><span style="font-weight: 400;">(</span><span style="font-weight: 400;">ZipHelper</span><span style="font-weight: 400;">.</span></span><strong><span style="color: #800000;">Unzip</span></strong><span style="font-weight: 400;">(<span style="color: #339966;">"</span></span><span style="font-weight: 400; color: #339966;">C07NSU0uUdBScCvKz1UIz8wzNooPriwuSc11KcosSy0CAA==</span><span style="font-weight: 400;"><span style="color: #339966;">"</span>)))</span></code></p>
<p><code><span style="font-weight: 400;">       </span><span style="font-weight: 400;">{</span></code></p>
<p><code><span style="font-weight: 400;">        <span style="color: #3366ff;">   </span></span><span style="font-weight: 400; color: #3366ff;">foreach</span> <span style="font-weight: 400;">(</span><span style="font-weight: 400; color: #800080;">ManagementObject</span><span style="font-weight: 400;"> item </span><span style="font-weight: 400;">in</span> <span style="font-weight: 400; color: #800080;">managementObjectSearcher</span><span style="font-weight: 400;">.</span><span style="color: #800000;"><strong>Get</strong></span><span style="font-weight: 400;">())</span></code></p>
<p><code><span style="font-weight: 400;">           </span><span style="font-weight: 400;">{</span></code></p>
<p><code><span style="font-weight: 400;">               </span><span style="font-weight: 400; color: #3366ff;">ulong</span><span style="font-weight: 400;"> hash </span><span style="font-weight: 400;">=</span> <span style="color: #800000;"><strong>GetHash</strong></span><span style="font-weight: 400;">(</span><span style="font-weight: 400; color: #800080;">Path</span><span style="font-weight: 400;">.</span><span style="color: #800000;"><strong>GetFileName</strong></span><span style="font-weight: 400;">(</span><span style="color: #800080;"><span style="font-weight: 400;">item</span><span style="font-weight: 400;">.</span><span style="font-weight: 400;">Properties</span><span style="font-weight: 400;">[</span><span style="font-weight: 400;">ZipHelper</span></span><span style="font-weight: 400;">.</span><span style="color: #800000;"><strong>Unzip</strong></span><span style="font-weight: 400;">(<span style="color: #339966;">"</span></span><span style="font-weight: 400; color: #339966;">C0gsyfBLzE0FAA==</span><span style="font-weight: 400;"><span style="color: #339966;">"</span>)<span style="color: #800080;">].</span></span><span style="color: #800080;"><span style="font-weight: 400;">Value</span><span style="font-weight: 400;">.</span></span><span style="color: #800000;"><strong><span style="color: #800080;">T</span>oString</strong></span><span style="font-weight: 400;">()).</span><span style="color: #800000;"><strong>ToLower</strong></span><span style="font-weight: 400;">());</span></code></p>
<p><code><span style="font-weight: 400;">               </span><span style="font-weight: 400; color: #3366ff;">if</span> <span style="color: #800080;"><span style="font-weight: 400;">(</span><span style="font-weight: 400;">Array</span></span><span style="font-weight: 400;">.</span><span style="color: #800000;"><strong>IndexOf</strong></span><span style="color: #800080;"><span style="font-weight: 400;">(</span><span style="font-weight: 400;">configTimeStamps</span><span style="font-weight: 400;">,</span> <span style="font-weight: 400;">hash</span><span style="font-weight: 400;">)</span> <span style="font-weight: 400;">!=</span> <span style="font-weight: 400;">-</span><span style="font-weight: 400;">1</span><span style="font-weight: 400;">)</span></span></code></p>
<p><code><span style="font-weight: 400;">               </span><span style="font-weight: 400;">{</span></code></p>
<p><code><span style="font-weight: 400;">                   </span><span style="font-weight: 400; color: #800080;">return</span> <span style="font-weight: 400; color: #3366ff;">true</span><span style="font-weight: 400;">;</span></code></p>
<p><code><span style="font-weight: 400;">               </span><span style="font-weight: 400;">}</span></code></p>
<p><code><span style="font-weight: 400;">           </span><span style="font-weight: 400;">}</span></code></p>
<p><code><span style="font-weight: 400;">       </span><span style="font-weight: 400;">}</span></code></p>
<p><code><span style="font-weight: 400;">       </span><span style="font-weight: 400; color: #3366ff;">return</span> <span style="font-weight: 400; color: #800080;">false</span><span style="font-weight: 400;">;</span></code></p>
<p><code><span style="font-weight: 400;">   </span><span style="font-weight: 400;">}</span></code></p>
</div>
<p>&nbsp;</p>
<div class="blog-post-code-wrapper">
<p><code><span style="color: #3366ff;"><span style="font-weight: 400;">private</span> <span style="font-weight: 400;">static</span> <span style="font-weight: 400;">class</span></span> <span style="color: #800080;"><strong>ProcessTracker</strong></span></code><code><span style="font-weight: 400;">{</span></code></p>
<p><code><span style="font-weight: 400;">   </span><em><span style="font-weight: 400;">// Token: 0x0600097C RID: 2428 RVA: 0x000435A4 File Offset: 0x000417A4</span></em></code></p>
<p><code><span style="font-weight: 400;">  <span style="color: #3366ff;"> </span></span><span style="color: #3366ff;"><span style="font-weight: 400;">private</span> <span style="font-weight: 400;">static</span> <span style="font-weight: 400;">bool</span></span> <span style="color: #800000;"><strong>SearchConfigurations</strong></span><span style="font-weight: 400;">()</span></code></p>
<p><code><span style="font-weight: 400;">   </span><span style="font-weight: 400;">{</span></code></p>
<p><code><span style="font-weight: 400;">      <span style="color: #3366ff;"> </span></span><span style="font-weight: 400; color: #3366ff;">using</span> <span style="color: #800080;"><span style="font-weight: 400;">(</span><span style="font-weight: 400;">ManagementObjectSearcher</span></span><span style="font-weight: 400;"> managementObjectSearcher </span><span style="font-weight: 400;">=</span> <span style="font-weight: 400; color: #3366ff;">new</span> <span style="color: #800080;"><span style="font-weight: 400;">ManagementObjectSearcher</span><span style="font-weight: 400;">(</span><span style="font-weight: 400;">OrionImprovementBusinessLayer</span><span style="font-weight: 400;">.</span><span style="font-weight: 400;">ZipHelper</span></span><span style="font-weight: 400;">.</span><span style="color: #800000;"><strong>Unzip</strong></span><span style="font-weight: 400;">("</span><span style="font-weight: 400; color: #339966;">C07NSU0uUdBScCvKz1UIz8wzNooPriwuSc11KcosSy0CAA==</span><span style="font-weight: 400;"><span style="color: #339966;">"</span>)))</span></code></p>
<p><code><span style="font-weight: 400;">       </span><span style="font-weight: 400;">{</span></code></p>
<p><code><span style="font-weight: 400;">           </span><span style="font-weight: 400; color: #3366ff;">foreach</span> <span style="font-weight: 400;">(</span><span style="font-weight: 400; color: #800080;">ManagementBaseObject</span><span style="font-weight: 400;"> managementBaseObject </span><span style="font-weight: 400;">in</span> <span style="font-weight: 400; color: #800080;">managementObjectSearcher</span><span style="font-weight: 400;">.</span><span style="color: #800000;"><strong>Get</strong></span><span style="font-weight: 400;">())</span></code></p>
<p><code><span style="font-weight: 400;">           </span><span style="font-weight: 400;">{</span></code></p>
<p><code><span style="font-weight: 400;">               </span><span style="font-weight: 400; color: #3366ff;">ulong</span><span style="font-weight: 400; color: #333333;"> hash </span><span style="font-weight: 400;">=</span> <span style="font-weight: 400; color: #800080;">OrionImprovementBusinessLayer</span><span style="font-weight: 400;">.</span><span style="color: #800000;"><strong>GetHash</strong></span><span style="font-weight: 400;">(</span><span style="font-weight: 400;">Path</span><span style="font-weight: 400;">.</span><span style="color: #800000;"><strong>GetFileName</strong></span><span style="font-weight: 400;">(((</span><span style="font-weight: 400; color: #800080;">ManagementObject</span><span style="font-weight: 400;">)</span><span style="font-weight: 400; color: #800080;">managementBaseObject</span><span style="font-weight: 400;">).</span><span style="color: #800080;"><span style="font-weight: 400;">Properties</span><span style="font-weight: 400;">[</span><span style="font-weight: 400;">OrionImprovementBusinessLayer</span><span style="font-weight: 400;">.</span><span style="font-weight: 400;">ZipHelper</span></span><span style="font-weight: 400;">.</span><b>Unzip</b><span style="font-weight: 400;">(<span style="color: #339966;">"</span></span><span style="font-weight: 400; color: #339966;">C0gsyfBLzE0FAA==</span><span style="font-weight: 400;"><span style="color: #339966;">"</span>)].</span><span style="font-weight: 400;">Value</span><span style="font-weight: 400;">.</span><b>ToString</b><span style="font-weight: 400;">()).</span><b>ToLower</b><span style="font-weight: 400;">());</span></code></p>
<p><code><span style="font-weight: 400;">               </span><span style="font-weight: 400; color: #3366ff;">if</span> <span style="font-weight: 400;">(</span><span style="font-weight: 400;">Array</span><span style="font-weight: 400;">.</span><span style="color: #800000;"><strong>IndexOf</strong></span><span style="font-weight: 400;">&lt;</span><span style="font-weight: 400; color: #3366ff;">ulong</span><span style="font-weight: 400;">&gt;(</span><span style="color: #800080;"><span style="font-weight: 400;">OrionImprovementBusinessLayer</span><span style="font-weight: 400;">.</span><span style="font-weight: 400;">configTimeStamps</span><span style="font-weight: 400;">,</span> <span style="font-weight: 400;">hash</span></span><span style="font-weight: 400;">)</span> <span style="font-weight: 400;">!=</span> <span style="font-weight: 400;">-</span><span style="font-weight: 400;">1</span><span style="font-weight: 400;">)</span></code></p>
<p><code><span style="font-weight: 400;">               </span><span style="font-weight: 400;">{</span></code></p>
<p><code><span style="font-weight: 400;">                   </span><span style="font-weight: 400;">return</span> <span style="font-weight: 400; color: #800080;">true</span><span style="font-weight: 400;">;</span></code></p>
<p><code><span style="font-weight: 400;">               </span><span style="font-weight: 400;">}</span></code></p>
<p><code><span style="font-weight: 400;">           </span><span style="font-weight: 400;">}</span></code></p>
<p><code><span style="font-weight: 400;">       </span><span style="font-weight: 400;">}</span></code></p>
<p><code><span style="font-weight: 400;">       </span><span style="font-weight: 400;">return</span> <span style="font-weight: 400; color: #800080;">false</span><span style="font-weight: 400;">;</span></code></p>
<p><code><span style="font-weight: 400;">   </span><span style="font-weight: 400;">}</span></code></p>
</div>
<p><span style="font-weight: 400;">Figure 2. Comparison between injected source code (top) and decompiled using DnSpy (bottom)</span></p>
<p><span style="font-weight: 400;">In order to remove compilation warnings that could be generated by the adversary’s own code — which could alert the SolarWinds developers — StellarParticle made their edits within </span><code><span style="font-weight: 400;">#pragma warning disable</span></code><span style="font-weight: 400;"> and </span><span style="font-weight: 400;"><code>#pragma warning</code> restore</span><span style="font-weight: 400;"> statements, hinting at what parts were edited. In particular, SUNSPOT’s entry point was added to the legitimate Orion software </span><code><span style="font-weight: 400;">RefreshInternal</span></code><span style="font-weight: 400;"> function by adding the following try/catch block:</span></p>
<div class="blog-post-code-wrapper">
<p><span style="font-weight: 400; color: #3366ff;">try</span> <span style="font-weight: 400;">{</span><span style="font-weight: 400;">   </span><span style="font-weight: 400; color: #3366ff;">if</span> <span style="color: #800080;"><span style="font-weight: 400;">(!</span><span style="font-weight: 400;">OrionImprovementBusinessLayer</span><span style="font-weight: 400;">.</span><span style="font-weight: 400;">IsAlive</span><span style="font-weight: 400;">)</span></span> <span style="font-weight: 400;">{</span></p>
<p><span style="font-weight: 400;">     <span style="color: #800080;">  </span></span><span style="color: #800080;"><span style="font-weight: 400;">Thread</span><span style="font-weight: 400;"> th </span></span><span style="font-weight: 400;">=</span> <span style="font-weight: 400;">new</span> <span style="color: #800080;"><span style="font-weight: 400;">Thread</span><span style="font-weight: 400;">(</span><span style="font-weight: 400;">OrionImprovementBusinessLayer</span><span style="font-weight: 400;">.</span><span style="font-weight: 400;">Initialize</span><span style="font-weight: 400;">)</span></span></p>
<p><span style="font-weight: 400;">           </span><span style="font-weight: 400;">{</span> <span style="font-weight: 400; color: #800080;">IsBackground </span><span style="font-weight: 400;">=</span><span style="font-weight: 400; color: #800080;"> true </span><span style="font-weight: 400;">};</span></p>
<p><span style="font-weight: 400;">       </span><span style="font-weight: 400;">th</span><span style="font-weight: 400;">.</span><span style="color: #993300;"><strong>Start</strong></span><span style="font-weight: 400;">();</span></p>
<p><span style="font-weight: 400;">   </span><span id="ttps-section" style="font-weight: 400;">}</span></p>
<p><span style="font-weight: 400;">}</span> <span style="font-weight: 400; color: #3366ff;">catch</span> <span style="font-weight: 400;">(</span><span style="color: #800080;"><span style="font-weight: 400;">Exception</span><span style="font-weight: 400;">)</span></span> <span style="font-weight: 400;">{</span></p>
<p><span style="font-weight: 400;">}</span></p>
</div>
<h3><span style="font-weight: 400;">Tactics, Techniques and Procedures (TTPs)</span></h3>
<p><span style="font-weight: 400;">The following TTPs may be used to characterize the SUNSPOT activity described in this blog:</span></p>
<ul>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Persistence using scheduled tasks, triggered at boot time</span></li>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Use of AES128-CBC to protect the targeted source code files and the backdoored source code file in the binary</span></li>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Use of RC4 encryption with a hard-coded key to protect the log file entries</span></li>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Log entries from different executions of the malware that are separated with a hard-coded value </span><code><span style="font-weight: 400;">32 78 A5 E7 1A 79 91 AC</span></code></li>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Log file creation in the system </span><span style="font-weight: 400;">temp</span><span style="font-weight: 400;"> directory </span><code><span style="font-weight: 400;">C:\Windows\Temp\vmware-vmdmp.log</span></code><span style="font-weight: 400;"> masquerading as a legitimate VMWare log file</span></li>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Detection of the targeted Visual Studio solution build by reading the virtual memory of </span><code><span style="font-weight: 400;">MsBuild.exe</span></code><span style="font-weight: 400;"> processes, looking for the targeted solution filename</span></li>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Access to the remote process arguments made via the remote process’s PEB structure</span></li>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Replacement of source code files during the build process, before compilation, by replacing file content with another version containing SUNBURST</span></li>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Insertion of the backdoor code within </span><code><span style="font-weight: 400;">#pragma</span></code><span style="font-weight: 400;"> statements disabling and restoring warnings, to prevent the backdoor code lines from appearing in build logs</span></li>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Check of the MD5 hashes of the original source code and of the backdoored source code to ensure the tampering will not cause build errors</span></li>
<li style="font-weight: 400;" aria-level="1"><span style="font-weight: 400;">Attempt to open a non-existing mutex to detect when the malware operators want the backdoor to stop execution and safely exit</span></li>
</ul>
<h2>Host Indicators of Attack</h2>
<p><span style="font-weight: 400;">The tables below detail files belonging to the SUNSPOT campaigns including filename, SHA256 hash, and build time when known.</span></p>
<h3><span style="font-weight: 400;">Executables</span></h3>
<table class="orange">
<tbody>
<tr class="top-row bg-orange">
<td><b>Filename</b></td>
<td><b>SHA256 Hash</b></td>
<td><b>Build Time (UTC)</b></td>
</tr>
<tr>
<td><span style="font-weight: 400;">taskh<code>ostsvc.exe</code></span></td>
<td><code><span style="font-weight: 400;">c45c9bda8db1d470f1fd0dcc346dc449839eb5ce9a948c70369230af0b3ef168</span></code></td>
<td><code><span style="font-weight: 400;">2</span></code><span style="font-weight: 400;">020-02-20 11:40:02</span></td>
</tr>
</tbody>
</table>
<h3><span style="font-weight: 400;">Related Files</span></h3>
<table class="orange">
<tbody>
<tr class="top-row bg-orange">
<td><strong>Description</strong></td>
<td><b>SHA256 Hash</b></td>
</tr>
<tr>
<td><code><span style="font-weight: 400;">Backdoored Orion source code with SUNSPOT</span></code></td>
<td><code><span style="font-weight: 400;">0819db19be479122c1d48743e644070a8dc9a1c852df9a8c0dc2343e904da389</span></code></td>
</tr>
</tbody>
</table>
<h3><span style="font-weight: 400;">File System</span></h3>
<p><span style="font-weight: 400;">The presence of one or more of the following files may indicate a SUNSPOT infection.</span></p>
<table class="orange">
<tbody>
<tr class="top-row bg-orange">
<td><strong>File Path</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr>
<td><code><span style="font-weight: 400;">C:\Windows\Temp\vmware-vmdmp.log</span></code></td>
<td><span style="font-weight: 400;">Encrypted log file</span></td>
</tr>
</tbody>
</table>
<h3><span style="font-weight: 400;">Volatile Artifacts</span></h3>
<table class="orange">
<tbody>
<tr class="top-row bg-orange">
<td><b>Name</b></td>
<td><b>Type</b></td>
<td><b>Description</b></td>
</tr>
<tr>
<td><code><span style="font-weight: 400;">{12d61a41-4b74-7610-a4d8-3028d2f56395}</span></code></td>
<td><span style="font-weight: 400;">Mutex</span></td>
<td><span style="font-weight: 400;">Ensures a single implant instance</span></td>
</tr>
<tr>
<td><code><span style="font-weight: 400;">{56331e4d-76a3-0390-a7ee-567adf5836b7}</span></code></td>
<td><span style="font-weight: 400;">Mutex</span></td>
<td><span style="font-weight: 400;">Used to signal to the malware to safely exit</span></td>
</tr>
</tbody>
</table>
<h3><span style="font-weight: 400;">YARA Rules</span></h3>
<div class="blog-post-code-wrapper">
<p><code><span style="font-weight: 400;">rule CrowdStrike_SUNSPOT_01 : artifact stellarparticle sunspot </span><span style="font-weight: 400;">{</span></code></p>
<p><code><span style="font-weight: 400;">    meta:<br/>
</span><span style="font-weight: 400;">        copyright = "(c) 2021 CrowdStrike Inc."<br/>
</span><span style="font-weight: 400;">        description = "Detects RC4 and AES key encryption material in SUNSPOT"</span></code></p>
<p><code><span style="font-weight: 400;">        version = "202101081448"<br/>
</span><span style="font-weight: 400;">        last_modified = "2021-01-08"<br/>
</span><span style="font-weight: 400;">        actor = "StellarParticle"<br/>
</span><span style="font-weight: 400;">        malware_family = "SUNSPOT"</span></code></p>
<p><code><span style="font-weight: 400;">    strings:</span></code></p>
<p><code><span style="font-weight: 400;">        $key = {fc f3 2a 83 e5 f6 d0 24 a6 bf ce 88 30 c2 48 e7}<br/>
</span><span style="font-weight: 400;">        $iv  = {81 8c 85 49 b9 00 06 78 0b e9 63 60 26 64 b2 da}</span></code></p>
<p><code><span style="font-weight: 400;">    condition:<br/>
</span><span style="font-weight: 400;">        all of them and filesize &lt; 32MB</span></code></p>
<p><code><span style="font-weight: 400;">}</span></code></p>
<p><code><span style="font-weight: 400;">rule CrowdStrike_SUNSPOT_02 : artifact stellarparticle sunspot<br/>
</span><span style="font-weight: 400;">{</span></code></p>
<p><code><span style="font-weight: 400;">    meta:<br/>
</span><span style="font-weight: 400;">        copyright = "(c) 2021 CrowdStrike Inc."<br/>
</span><span style="font-weight: 400;">        description = "Detects mutex names in SUNSPOT"<br/>
</span><span style="font-weight: 400;">        version = "202101081448"<br/>
</span><span style="font-weight: 400;">        last_modified = "2021-01-08"<br/>
</span><span style="font-weight: 400;">        actor = "StellarParticle"<br/>
</span><span style="font-weight: 400;">        malware_family = "SUNSPOT"</span></code></p>
<p><code><span style="font-weight: 400;">    strings:<br/>
</span><span style="font-weight: 400;">        $mutex_01 = "{12d61a41-4b74-7610-a4d8-3028d2f56395}" wide ascii<br/>
</span><span style="font-weight: 400;">        $mutex_02 = "{56331e4d-76a3-0390-a7ee-567adf5836b7}" wide ascii</span></code></p>
<p><code><span style="font-weight: 400;">    condition:<br/>
</span><span style="font-weight: 400;">        any of them and filesize &lt; 10MB</span></code></p>
<p><code><span style="font-weight: 400;">}</span></code></p>
<p><code><span style="font-weight: 400;">rule CrowdStrike_SUNSPOT_03 : artifact logging stellarparticle sunspot </span></code></p>
<p><code><span style="font-weight: 400;">{</span></code></p>
<p><code><span style="font-weight: 400;">    meta:<br/>
</span><span style="font-weight: 400;">        copyright = "(c) 2021 CrowdStrike Inc."<br/>
</span><span style="font-weight: 400;">        description = "Detects log format lines in SUNSPOT"<br/>
</span><span style="font-weight: 400;">        version = "202101081443"<br/>
</span><span style="font-weight: 400;">        last_modified = "2021-01-08"<br/>
</span><span style="font-weight: 400;">        actor = "StellarParticle"<br/>
</span><span style="font-weight: 400;">        malware_family = "SUNSPOT"</span></code></p>
<p><code><span style="font-weight: 400;">    strings:<br/>
</span><span style="font-weight: 400;">        $s01 = "[ERROR] ***Step1('%ls','%ls') fails with error %#x***\x0A" ascii<br/>
</span><span style="font-weight: 400;">        $s02 = "[ERROR] Step2 fails\x0A" ascii<br/>
</span><span style="font-weight: 400;">        $s03 = "[ERROR] Step3 fails\x0A" ascii<br/>
</span><span style="font-weight: 400;">        $s04 = "[ERROR] Step4('%ls') fails\x0A" ascii<br/>
</span><span style="font-weight: 400;">        $s05 = "[ERROR] Step5('%ls') fails\x0A" ascii<br/>
</span><span style="font-weight: 400;">        $s06 = "[ERROR] Step6('%ls') fails\x0A" ascii<br/>
</span><span style="font-weight: 400;">        $s07 = "[ERROR] Step7 fails\x0A" ascii<br/>
</span><span style="font-weight: 400;">        $s08 = "[ERROR] Step8 fails\x0A" ascii<br/>
</span><span style="font-weight: 400;">        $s09 = "[ERROR] Step9('%ls') fails\x0A" ascii<br/>
</span><span style="font-weight: 400;">        $s10 = "[ERROR] Step10('%ls','%ls') fails with error %#x\x0A" ascii<br/>
</span><span style="font-weight: 400;">        $s11 = "[ERROR] Step11('%ls') fails\x0A" ascii<br/>
</span><span style="font-weight: 400;">        $s12 = "[ERROR] Step12('%ls','%ls') fails with error %#x\x0A" ascii<br/>
</span><span style="font-weight: 400;">        $s13 = "[ERROR] Step30 fails\x0A" ascii<br/>
</span><span style="font-weight: 400;">        $s14 = "[ERROR] Step14 fails with error %#x\x0A" ascii<br/>
</span><span style="font-weight: 400;">        $s15 = "[ERROR] Step15 fails\x0A" ascii<br/>
</span><span style="font-weight: 400;">        $s16 = "[ERROR] Step16 fails\x0A" ascii<br/>
</span><span style="font-weight: 400;">        $s17 = "[%d] Step17 fails with error %#x\x0A" ascii<br/>
</span><span style="font-weight: 400;">        $s18 = "[%d] Step18 fails with error %#x\x0A" ascii<br/>
</span><span style="font-weight: 400;">        $s19 = "[ERROR] Step19 fails with error %#x\x0A" ascii<br/>
</span><span style="font-weight: 400;">        $s20 = "[ERROR] Step20 fails\x0A" ascii<br/>
</span><span style="font-weight: 400;">        $s21 = "[ERROR] Step21(%d,%s,%d) fails\x0A" ascii<br/>
</span><span style="font-weight: 400;">        $s22 = "[ERROR] Step22 fails with error %#x\x0A" ascii<br/>
</span><span style="font-weight: 400;">        $s23 = "[ERROR] Step23 fails with error %#x\x0A" ascii<br/>
</span><span style="font-weight: 400;">        $s24 = "[%d] Solution directory: %ls\x0A" ascii<br/>
</span><span style="font-weight: 400;">        $s25 = "[%d] %04d-%02d-%02d %02d:%02d:%02d:%03d %ls\x0A" ascii<br/>
</span><span style="font-weight: 400;">        $s26 = "[%d] + '%s' " ascii</span></code></p>
<p><code><span style="font-weight: 400;">    condition:<br/>
</span><span style="font-weight: 400;">        2 of them and filesize &lt; 10MB<br/>
</span><span style="font-weight: 400;">}</span></code></p>
</div>
<h3><span style="font-weight: 400;">ATT&amp;CK Framework</span></h3>
<p><span style="font-weight: 400;">The following table maps reported SUNSPOT TTPs to the MITRE ATT&amp;CK® framework.</span></p>
<table class="orange">
<tbody>
<tr class="top-row bg-orange">
<td><strong>Tactic</strong></td>
<td><strong>Technique</strong></td>
<td><strong>Observable</strong></td>
</tr>
<tr>
<td><span style="font-weight: 400;">Reconnaissance</span></td>
<td><strong>T1592.002</strong><span style="font-weight: 400;"> Gather Victim Host Information &#8211; Software</span></td>
<td><span style="font-weight: 400;">StellarParticle had an understanding of the Orion build chain before SUNSPOT was developed to tamper with it.</span></td>
</tr>
<tr>
<td><span style="font-weight: 400;">Resource Development</span></td>
<td><strong>T1587.001</strong><span style="font-weight: 400;"> Develop Capabilities &#8211; Malware</span></td>
<td><span style="font-weight: 400;">SUNSPOT was weaponized to specifically target the Orion build to replace one source code file and include the SUNBURST backdoor.</span></td>
</tr>
<tr>
<td><span style="font-weight: 400;">Persistence</span></td>
<td><strong>T1053.005 </strong><span style="font-weight: 400;">Scheduled Task</span></td>
<td><span style="font-weight: 400;">SUNSPOT is persisted in a scheduled task set to execute after the host has booted.</span></td>
</tr>
<tr>
<td rowspan="4"><span style="font-weight: 400;">Defense Evasion</span></td>
<td><strong>T1140</strong> <span style="font-weight: 400;">Deobfuscate/Decode Information</span></td>
<td><span style="font-weight: 400;">The configuration in SUNSPOT is encrypted using AES128-CBC. It contains the replacement source code, the targeted Visual Studio solution file name, and targeted source code file paths relative to the solution directory.</span></td>
</tr>
<tr>
<td><strong>T1027</strong> <span style="font-weight: 400;">Obfuscated Files or Information</span></td>
<td><span style="font-weight: 400;">The log file SUNSPOT writes is encrypted using RC4.</span></td>
</tr>
<tr>
<td><strong>T1480</strong> <span style="font-weight: 400;">Execution Guardrails</span></td>
<td><span style="font-weight: 400;">The replacement of source code is done only if the MD5 checksums of both the original source code file and backdoored replacement source code match hardcoded values.</span></td>
</tr>
<tr>
<td><strong>T1036</strong><span style="font-weight: 400;"> Masquerading</span></td>
<td><span style="font-weight: 400;">SUNSPOT masquerades as a legitimate Windows Binary, and writes its logs in a fake VMWare log file.</span></td>
</tr>
<tr>
<td><span style="font-weight: 400;">Discovery</span></td>
<td><strong>T1057</strong> <span style="font-weight: 400;">Process Discovery</span></td>
<td><span style="font-weight: 400;">SUNSPOT monitors running processes looking for instances of </span><span style="font-weight: 400;">MsBuild.exe</span><span style="font-weight: 400;">.</span></td>
</tr>
<tr>
<td><span style="font-weight: 400;">Impact</span></td>
<td><strong>T1565.001</strong> <span style="font-weight: 400;">Data Manipulation Stored &#8211; Data Manipulation</span></td>
<td><span style="font-weight: 400;">Modification of the Orion source code to inject SUNBURST.</span></td>
</tr>
</tbody>
</table>
<h3><span style="font-weight: 400;">Logged Steps and Corresponding Errors</span></h3>
<p><span style="font-weight: 400;">The following table provides a mapping of the step numbers found in the log file to the actual action performed by SUNSPOT. The step numbering does not reflect the actual execution order. Some values are also missing.</span></p>
<table class="orange">
<tbody>
<tr class="top-row bg-orange">
<td><strong>Step In Log File</strong></td>
<td><strong>Meaning</strong></td>
</tr>
<tr>
<td><span style="font-weight: 400;">START</span></td>
<td><span style="font-weight: 400;">Logged after the initialization has completed successfully</span></td>
</tr>
<tr>
<td><span style="font-weight: 400;">Step1</span></td>
<td><span style="font-weight: 400;">Original file cannot be restored after tampering with the build process</span></td>
</tr>
<tr>
<td><span style="font-weight: 400;">Step2</span></td>
<td><span style="font-weight: 400;">Could not decrypt one of the targeted source code file’s path (relative to the solution directory)</span></td>
</tr>
<tr>
<td><span style="font-weight: 400;">Step3</span></td>
<td><span style="font-weight: 400;">Could not create the file path for the targeted source code file</span></td>
</tr>
<tr>
<td><span style="font-weight: 400;">Step4</span></td>
<td><span style="font-weight: 400;">Could not get the size of the original source code file</span></td>
</tr>
<tr>
<td><span style="font-weight: 400;">Step5</span></td>
<td><span style="font-weight: 400;">Computation of the MD5 hash of the original source file failed</span></td>
</tr>
<tr>
<td><span style="font-weight: 400;">Step6</span></td>
<td><span style="font-weight: 400;">There was a mismatch between the expected target original source code file MD5 hash and the expected value</span></td>
</tr>
<tr>
<td><span style="font-weight: 400;">Step7</span></td>
<td><span style="font-weight: 400;">Could not successfully decrypt the backdoored source code</span></td>
</tr>
<tr>
<td><span style="font-weight: 400;">Step8</span></td>
<td><span style="font-weight: 400;">Computation of the MD5 hash of the backdoored source code failed</span></td>
</tr>
<tr>
<td><span style="font-weight: 400;">Step9</span></td>
<td><span style="font-weight: 400;">There was a mismatch between the expected backdoored source code data MD5 hash and the expected value</span></td>
</tr>
<tr>
<td><span style="font-weight: 400;">Step10</span></td>
<td><span style="font-weight: 400;">Could not create backup of the original source code file</span></td>
</tr>
<tr>
<td><span style="font-weight: 400;">Step11</span></td>
<td><span style="font-weight: 400;">Could not write the backdoored source code to disk (in the </span><span style="font-weight: 400;">.tmp</span><span style="font-weight: 400;"> file)</span></td>
</tr>
<tr>
<td><span style="font-weight: 400;">Step12</span></td>
<td><span style="font-weight: 400;">Could not copy the temporary file with the backdoored source code (with the </span><span style="font-weight: 400;">.tmp</span><span style="font-weight: 400;"> extension) to the path of the original source</span></td>
</tr>
<tr>
<td><span style="font-weight: 400;">Step14</span></td>
<td><span style="font-weight: 400;">Could not read the </span><span style="font-weight: 400;">MsBuild.exe</span><span style="font-weight: 400;"> process memory to resolve its command-line arguments</span></td>
</tr>
<tr>
<td><span style="font-weight: 400;">Step15</span></td>
<td><span style="font-weight: 400;">The returned PEB address for the remote process is zero</span></td>
</tr>
<tr>
<td><span style="font-weight: 400;">Step16</span></td>
<td><span style="font-weight: 400;">Calling </span><span style="font-weight: 400;">NtQueryInformationProcess</span><span style="font-weight: 400;"> failed</span></td>
</tr>
<tr>
<td><span style="font-weight: 400;">Step17</span></td>
<td><span style="font-weight: 400;">Could not create a handle to the </span><span style="font-weight: 400;">MsBuild.exe</span><span style="font-weight: 400;"> process with </span><span style="font-weight: 400;">SYNCHRONIZE</span><span style="font-weight: 400;"> access</span></td>
</tr>
<tr>
<td><span style="font-weight: 400;">Step18</span></td>
<td><span style="font-weight: 400;">Could not successfully wait for the </span><span style="font-weight: 400;">MsBuild.exe</span><span style="font-weight: 400;"> process termination</span></td>
</tr>
<tr>
<td><span style="font-weight: 400;">Step19</span></td>
<td><span style="font-weight: 400;">Obtention of the address of the </span><span style="font-weight: 400;">NtQueryInformationProcess</span><span style="font-weight: 400;"> function failed</span></td>
</tr>
<tr>
<td><span style="font-weight: 400;">Step20</span></td>
<td><span style="font-weight: 400;">Modification of the process security token to obtain </span><span style="font-weight: 400;">SeDebugPrivileges</span><span style="font-weight: 400;"> failed</span></td>
</tr>
<tr>
<td><span style="font-weight: 400;">Step21</span></td>
<td><span style="font-weight: 400;">The number of currently running tampering threads exceeded 256, and SUNSPOT cannot track more threads</span></td>
</tr>
<tr>
<td><span style="font-weight: 400;">Step22</span></td>
<td><span style="font-weight: 400;">Unable to get a list of running processes</span></td>
</tr>
<tr>
<td><span style="font-weight: 400;">Step23</span></td>
<td><span style="font-weight: 400;">There was an error when enumerating the running processes list</span></td>
</tr>
<tr>
<td><span style="font-weight: 400;">Step30</span></td>
<td><span style="font-weight: 400;">Could not decrypt the solution name </span><span style="font-weight: 400;">core.sln</span></td>
</tr>
</tbody>
</table>
<p><strong>Footnote:</strong></p>
<p><span style="font-weight: 400; font-size: 14px;">1. https[:]//blog.xpnsec[.]com/how-to-argue-like-cobalt-strike/</span></p>
<h4><span style="font-weight: 400;">Additional Resources</span></h4>
<ul>
<li style="font-weight: 400;" aria-level="1"><a href="https://orangematter.solarwinds.com/2021/01/11/new-findings-from-our-investigation-of-sunburst/"><span style="font-weight: 400;"><em>Read a blog on this topic from SolarWinds.</em></span></a></li>
<li style="font-weight: 400;" aria-level="1"><em><span style="font-weight: 400;">Download the </span><a href="https://www.crowdstrike.com/resources/reports/2020-crowdstrike-global-threat-report/"><span style="font-weight: 400;">CrowdStrike 2020 Global Threat Report</span></a><span style="font-weight: 400;">.</span></em></li>
<li style="font-weight: 400;" aria-level="1"><em><span style="font-weight: 400;">To learn more about how to incorporate intelligence on threats into your security strategy, visit the </span><a href="https://www.crowdstrike.com/endpoint-security-products/falcon-x-threat-intelligence/premium/"><span style="font-weight: 400;">CROWDSTRIKE FALCON® INTELLIGENCE&#x2122;  Premium Threat Intelligence page</span><span style="font-weight: 400;">.</span></a></em></li>
<li style="font-weight: 400;" aria-level="1"><em><a href="https://go.crowdstrike.com/try-falcon-prevent.html"><span style="font-weight: 400;">Get a full-featured free trial of CrowdStrike Falcon® Prevent&#x2122;</span></a><span style="font-weight: 400;"> and learn how true next-gen AV performs against today’s most sophisticated threats.</span></em></li>
</ul>
</div>
<div>
<ul class="list-share-buttons">

<li class="share-button">
<a class="tweet-btn " target="_blank" rel="noopener noreferrer" href="https://twitter.com/share?text=SUNSPOT%3A+An+Implant+in+the+Build+Process&amp;url=https://www.crowdstrike.com/blog/sunspot-malware-technical-analysis/" onclick="window.open(this.href, '_blank', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');">
<span class="fa-brands fa-twitter"></span>
<span>Tweet</span>
</a>
</li>

<li class="share-button">
<a class="li-btn" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.crowdstrike.com/blog/sunspot-malware-technical-analysis/&amp;title=SUNSPOT%3A+An+Implant+in+the+Build+Process" onclick="window.open(this.href, '_blank', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');">
<span class="fa-brands fa-linkedin"></span>
<span>Share</span>
</a>
</li>
</ul>
</div>
<div id="blogFreeTrialSection"></div>
<h5>Related Content</h5>
<div class="row recent_articles">
<a class="col-12 col-md-4 recent_articles_item" href="/blog/five-holiday-tips-to-defend-against-access-brokers/">
<div class="post_image">
<img src="https://www.crowdstrike.com/wp-content/uploads/2023/11/1123_02_Holiday-Access-Brokers.jpg" alt>
</div>
<div class="post_info">
<h6>5 Tips to Defend Against Access Brokers This Holiday Season</h6>
<div class="excerpt"></div>
</div>
</a>
<a class="col-12 col-md-4 recent_articles_item" href="/blog/imperial-kitten-deploys-novel-malware-families/">
<div class="post_image">
<img src="https://www.crowdstrike.com/wp-content/uploads/2023/11/23-OTH-060_adversary-1-kitten-iran.png" alt>
</div>
<div class="post_info">
<h6>IMPERIAL KITTEN Deploys Novel Malware Families in Middle East-Focused Operations</h6>
<div class="excerpt"></div>
</div>
</a>
<a class="col-12 col-md-4 recent_articles_item" href="/blog/falcon-intelligence-recon-automation-advancements/">
<div class="post_image">
<img src="https://www.crowdstrike.com/wp-content/uploads/2023/06/Falcon-X-Recon-featured-image-1.jpg" alt>
</div>
<div class="post_info">
<h6>Automation Advancements in Falcon Intelligence Recon: Disrupt the Adversary and Reduce Risk</h6>
<div class="excerpt"></div>
</div>
</a>
</div>
</div>
<div class="col-12 col-lg-4 sidebar">
<div id="blogCategorySidebar"></div>
<div id="blogSocialSidebar"></div><div id="categorySidebarBanner"></div><div id="sideBarFeaturedArticles"></div><div id="blogSubscribe"></div><div id="blogDemo"></div>
</div>
<div class="post_nav row">
<div class="col-12">
<div class="links"><span class="fa fa-angle-double-left"></span> <a href="https://www.crowdstrike.com/blog/tech-center/service-remediation-rtr/" rel="prev">Enable Security Services with Real Time Response</a></div>
<div class="links"><a href="https://www.crowdstrike.com/blog/bypass-epa-ntlm-attacks-wia/" rel="next">How to Easily Bypass EPA to Compromise Any Web Server that Supports Windows Integrated Authentication</a> <span class="fa fa-angle-double-right"></span></div>
</div>
</div>
</div>
</article>
</main>
<footer class="simple">
<div class="container">
<div class="row">
<div class="col-md-12 top">
<span class="footer-logo"><a class="red" href="https://www.crowdstrike.com"><i class="cs-icon-cs-logo"> </i></a></span>
<ul class="row social-links">
<li class="circle-icon-outline">
<a href="https://twitter.com/CrowdStrike" target="_blank"><i class="fa-brands fa-twitter"></i></a></li>
<li class="circle-icon-outline">
<a href="https://www.facebook.com/CrowdStrike/" target="_blank"><i class="fa-brands fa-facebook"></i></a>
</li>
<li class="circle-icon-outline">
<a href="https://www.linkedin.com/company/crowdstrike" target="_blank"><i class="fa-brands fa-linkedin"></i></a>
</li>
<li class="circle-icon-outline">
<a href="http://www.youtube.com/user/CrowdStrike" target="_blank"><i class="fa-brands fa-youtube"></i></a>
</li>
</ul>
</div>
<div class="col-md-12 bottom">
<ul class="row footer-lower-links">
<li class="footer-copyright">Copyright © 2023 CrowdStrike</li>
<li><a href="https://www.crowdstrike.com/privacy-notice/">Privacy</a></li>
<li><a href="https://www.crowdstrike.com/services/request-information/">Request Info</a></li>
<li><a href="https://www.crowdstrike.com/blog/">Blog</a></li>
<li><a href="https://www.crowdstrike.com/contact-us/">Contact Us</a></li>
<li>1.888.512.8906</li>
</ul>
</div>
</div>
</div>
</footer>
</div>
</div>
</div>
<link rel="stylesheet" id="exit-promoter-style-css" href="https://www.crowdstrike.com/wp-content/themes/main-theme/dist/styles/components/exit-promoter.min.css?ver=1700261575" type="text/css" media="all" />
<script type="text/javascript" src="https://www.crowdstrike.com/wp-content/themes/main-theme/dist/scripts/components/footer-navigation.min.js?ver=1700261575" id="footer-menu-js"></script>
<script type="text/javascript" async="async" src="https://www.crowdstrike.com/wp-content/themes/main-theme/dist/scripts/theme-scripts.min.js?ver=1700261575" id="theme-scripts-js"></script>
<script type="text/javascript" src="https://www.crowdstrike.com/wp-content/themes/main-theme/dist/scripts/plugins/exit-promoter.min.js?ver=1700261575" id="exit-promoter-script-js"></script>
<script id="exit-promoter-script-js-after" type="text/javascript">
var exitPromoterParams = {"promoters":[{"name":"Product pages","exit_promoter_options":{"url_whitelist":[{"url":"\/products\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/security-and-it-operations\/falcon-filevantage\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/cloud-security\/falcon-cloud-workload-protection-complete\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/endpoint-security\/falcon-device-control\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/endpoint-security\/falcon-for-macos\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/cloud-security\/falcon-cloud-workload-protection\/container-security\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/endpoint-security\/falcon-forensics\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/identity-protection\/falcon-identity-threat-detection\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/identity-protection\/falcon-identity-threat-protection\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/identity-protection\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/cloud-security\/falcon-for-aws\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/cloud-security\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/cloud-security\/falcon-horizon-cspm\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/cloud-security\/falcon-for-google-cloud-platform\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/cloud-security\/falcon-for-azure\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/cloud-security\/falcon-cloud-workload-protection\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/cloud-security\/falcon-for-data-centers\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/security-and-it-operations\/falcon-spotlight-vulnerability-management\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/endpoint-security\/falcon-firewall-management\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/threat-intelligence\/falcon-intelligence-automated-intelligence\/premium\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/threat-intelligence\/falcon-intelligence-automated-intelligence\/elite\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/endpoint-security\/falcon-for-mobile\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/threat-intelligence\/falcon-intelligence-automated-intelligence\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/endpoint-security\/falcon-prevent-antivirus\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/security-and-it-operations\/falcon-discover-network-security-monitoring\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/endpoint-security\/falcon-insight-edr\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/cloud-security\/cloud-infrastructure-entitlement-management-ciem-features\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/endpoint-security\/falcon-insight-xdr\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/bundles\/falcon-go\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/endpoint-security\/falcon-long-term-repository\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/threat-intelligence\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/endpoint-security\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/security-and-it-operations\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/threat-intelligence\/falcon-intelligence-recon\/faq\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/endpoint-security\/falcon-prevent-antivirus\/falcon-prevent-for-home-use-faq\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/endpoint-security\/falcon-firewall-management\/faq\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/threat-intelligence\/falcon-intelligence-automated-intelligence\/premium\/faq\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/threat-intelligence\/falcon-intelligence-automated-intelligence\/elite\/faq\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/endpoint-security\/falcon-for-mobile\/faq\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/threat-intelligence\/falcon-intelligence-automated-intelligence\/faq\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/threat-intelligence\/falcon-cyber-threat-engine\/faq\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/threat-intelligence\/falcon-sandbox-malware-analysis\/faq\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/endpoint-security\/falcon-prevent-antivirus\/faq\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/endpoint-security\/falcon-insight-edr\/faq\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/security-and-it-operations\/falcon-discover-network-security-monitoring\/faq\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/managed-services\/falcon-complete\/faq\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/managed-services\/falcon-complete\/warranty-faq\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/endpoint-security\/falcon-device-control\/faq\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/bundles\/falcon-elite\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/bundles\/falcon-pro\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/bundles\/falcon-enterprise\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/crowdstrike-support\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/threat-intelligence\/falcon-sandbox-malware-analysis\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/threat-intelligence\/falcon-cyber-threat-engine\/","is_subfolder":false,"exclusions":false},{"url":"\/products\/faq\/","is_subfolder":false,"exclusions":false},{"url":"\/services\/","is_subfolder":true,"exclusions":[{"exclude_url":"\/experienced-a-breach\/"}]},{"url":"\/events\/","is_subfolder":true,"exclusions":false},{"url":"\/free-trial-guide\/","is_subfolder":true,"exclusions":false},{"url":"\/cybersecurity-101\/","is_subfolder":true,"exclusions":[{"exclude_url":"\/cybersecurity-101\/cloud-security\/test-ep\/"},{"exclude_url":"\/cybersecurity-101\/attack-types\/test-ep\/gtr\/"}]},{"url":"\/resources\/","is_subfolder":true,"exclusions":[{"exclude_url":"\/resources\/demos\/falcon-complete-mdr\/"},{"exclude_url":"\/resources\/reports\/threat-hunting-report\/"},{"exclude_url":"\/resources\/demos\/data-protection\/"},{"exclude_url":"\/resources\/crowdcasts\/fal-con-2023-series\/"}]},{"url":"\/products\/identity-protection\/active-directory-risk-review\/","is_subfolder":false,"exclusions":false}],"entrance_delay":"2000","animation_speed":"333","custom_class":"","disabled":false},"columns":[{"column_options":{"background_color":"dark","background_image":{"ID":167734,"id":167734,"title":"demo-blank-falcon-hero (1)","filename":"demo-blank-falcon-hero-1-1.png","filesize":597420,"url":"\/wp-content\/uploads\/2023\/07\/demo-blank-falcon-hero-1-1.png","link":"\/demo-blank-falcon-hero-1-2\/","alt":"","author":"25","description":"","caption":"","name":"demo-blank-falcon-hero-1-2","status":"inherit","uploaded_to":0,"date":"2023-07-11 22:51:05","modified":"2023-07-11 22:51:05","menu_order":0,"mime_type":"image\/png","type":"image","subtype":"png","icon":"\/wp-includes\/images\/media\/default.png","width":857,"height":1000}},"column":[{"acf_fc_layout":"text_content","title":{"title_text":"Try CrowdStrike free for 15 days","font_size_override":"50","font_color_override":""},"text":"<style>\n.ep--content--image {<br \/>  display: none;<br \/>}<br \/>@media screen and (min-height: 876px) {<br \/>  .ep--content--image {<br \/>    display: block;<br \/>  }<br \/>}<br \/><\/style>\n<p><center><img decoding=\"async\" class=\"ep--content--image\" src=\"https:\/\/www.crowdstrike.com\/wp-content\/uploads\/2023\/04\/real-time-visibility.jpeg\" \/><\/center><strong>Total protection has never been easier.<br \/>\nTake advantage of our free 15-day trial and explore the most popular solution for your business:<\/strong><\/p>\n<p>&#8211; Protect against malware with next-gen antivirus.<br \/>\n&#8211; Get unrivaled visibility with USB device control.<br \/>\n&#8211; Simplify your host firewall management.<br \/>\n&#8211; Receive real-time insights with automated threat intelligence.<\/p>\n","ctas":false}]},{"column_options":{"background_color":"light","background_image":false},"column":[{"acf_fc_layout":"form_content","form_title":"","form_subtitle":"Try it free","form_urlid":"5554","form_height":"900","form_privacy_message":"By clicking submit, I consent to the processing of my contact information by CrowdStrike and its partners, including to CrowdStrike contacting me and sharing my contact information with its partners. I acknowledge that CrowdStrike will use and keep my contact information for as long as necessary for these purposes in accordance with its <a href=\"\/privacy-notice\/\" target=\"_blank\">Privacy Notice<\/a>","form_ty_url":"\/products\/trials\/try-falcon-ep\/thank-you\/"}]}]},{"name":"Cloud AB Test","exit_promoter_options":{"url_whitelist":[{"url":"\/cybersecurity-101\/cloud-security\/test-ep\/","is_subfolder":false,"exclusions":false}],"entrance_delay":"2000","animation_speed":"333","custom_class":"","disabled":false},"columns":[{"column_options":{"background_color":"primary","background_image":false},"column":[{"acf_fc_layout":"text_content","title":{"title_text":"Cloud threats are on the rise","font_size_override":"0","font_color_override":""},"text":"<p><center><img decoding=\"async\" src=\"\/wp-content\/uploads\/2022\/06\/protectors-cloud-ebook-thumb.png\" \/><\/center>Discover the top threats, who is behind them, and what you can do to stop them.<\/p>\n","ctas":false}]},{"column_options":{"background_color":"dark","background_image":false},"column":[{"acf_fc_layout":"form_content","form_title":"","form_subtitle":"Download the Cloud\r\nThreat Report","form_urlid":"3716","form_height":"700","form_privacy_message":"","form_ty_url":""}]}]},{"name":"GTR CS101 EP","exit_promoter_options":{"url_whitelist":[{"url":"\/cybersecurity-101\/attack-types\/test-ep\/gtr\/","is_subfolder":false,"exclusions":false}],"entrance_delay":"2000","animation_speed":"333","custom_class":"","disabled":false},"columns":[{"column_options":{"background_color":"dark","background_image":false},"column":[{"acf_fc_layout":"text_content","title":{"title_text":"CrowdStrike discovers 33 newly named adversaries","font_size_override":"0","font_color_override":""},"text":"<p><center><img decoding=\"async\" src=\"\/wp-content\/uploads\/2023\/02\/GTR2023_Social_Banners_04_Resource-center-banner-825-x-360-GTR.png\" \/><\/center><br \/>\n<strong><span style=\"font-size: large;\">Get the latest threat intelligence and eCrime data from cyberattacks in 2022.<\/span><\/strong><\/p>\n","ctas":false}]},{"column_options":{"background_color":"light","background_image":false},"column":[{"acf_fc_layout":"form_content","form_title":"","form_subtitle":"","form_urlid":"2069","form_height":"830","form_privacy_message":"","form_ty_url":""}]}]},{"name":"test-ep-8286","exit_promoter_options":{"url_whitelist":[{"url":"\/test-form-gtr-3726-ep-8286\/","is_subfolder":false,"exclusions":false}],"entrance_delay":"500","animation_speed":"333","custom_class":"","disabled":false},"columns":[{"column_options":{"background_color":"light","background_image":false},"column":[{"acf_fc_layout":"form_content","form_title":"Test Form 8286","form_subtitle":"","form_urlid":"8286","form_height":"500","form_privacy_message":"Test privacy message.","form_ty_url":""}]}]}]}
</script>
</body>
</html>