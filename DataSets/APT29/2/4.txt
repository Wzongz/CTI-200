The recent expansive intrusion campaign of over half a dozen government agencies and as-yet unknown other organizations through malicious backdoors in the SolarWinds Orion platform is already one of the most significant acts of cyber espionage in history. This intrusion, dubbed SUNBURST/Solorigate, appears intended for information theft and espionage rather than destruction, placing this campaign within the realm of counterintelligence, not just incident response. Analyzing this incident within the realm of counterintelligence may fill the gap of descriptive language for this incident rather than bipolar descriptions of “sophisticated” or in-depth analysis which may add to confusion for network defenders. Additionally, only a handful of companies have direct access and the investigative resources to gain meaningful insights into the technical components of the backdoor. The actor is a different story. Like most complex, public intrusions, attribution has been messy. FireEye has named the actor behind this intrusion “UNC2452,” and Volexity dubbed the threat actor “Dark Halo,” stating that the actor is the same as UNC2452, though FireEye has not substantiated that claim. Adding further complexity, Washington Post correspondent Ellen Nakashima cited unnamed government sources claiming Russian actors, in particular APT29, are responsible for the attack. Members of the U.S. Congress have also publicly accused Russia, and in particular the Russian Foreign Intelligence Service (SVR), as the responsible party, and added calls for response. Microsoft President Brad Smith has also called for strong action. While we expect these organizations have far more insight into the nature of the breach, as well as classified sources of intelligence information, calls for strong response should include publicly disclosed information to support accusations. Public evidence for these claims is currently scant. Some, including Jake Williams, who runs Rendition Security and teaches for the SANS Institute, has said that technical evidence is forthcoming, but cannot be disclosed without tipping off the adversaries to missteps and giving them a means to cover their tracks. Still, the lack of public evidence gives rise to claims that other actors, even perhaps other countries, may be responsible, a claim made by President Donald Trump as well. Intelligence analysis, properly conducted, combats bias. Bias can lead to missteps in policy. Engaging in policy discussions about proportional responses (or, at times, very disproportionate response) without strong evidence is potentially dangerous. As rumors of attribution to Russia circulate, attribution prior to evidence is premature and myopic, biasing the analyst to only certain behaviors and actors. Further, intelligence analysis provides both strategic and tactical guidance for responses. At the strategic level, we can be assured that responses are coordinated and proportional. At the tactical level, defenders can apply intelligence to seed proactive activities, such as hunting for behaviors after indicators run dry. Among information security researchers, some discussion has occurred regarding the possibility alternate actors, such as APT41, may ultimately be found responsible. APT41, also known as Winnti and Barium, has been linked to the People’s Republic of China, and previously conducted attacks which beg comparison with the SUNBURST/Solorigate attack. (Note: Recorded Future has synonymized several named groups, including APT41, Axiom Hacking Group, Barium, Blackfly, Dogfish, Ragebeast, Wicked Panda, Winnti Group, as Winnti Umbrella Group.) In March 2017, APT41 executed a supply chain attack by breaching the company which made CCleaner, a system cleaner software. Researchers from Cisco Talos and Morphisec uncovered the campaign, which ultimately spread to 2.27 million computers. While these comparisons fall well short of the requirements for attribution, APT41 does merit consideration as a candidate actor group responsible for the SUNBURST/ Solorigate breach. Enter threat intelligence.We approached our analysis using existing techniques in order to focus on attribution and adversary mapping. We pursued methodologies including mapping MITRE ATT&CK techniques, victimology, temporal indications, and historic use of indicators to give insight into attacker motivation and intent. We analyzed both public information as well as information from Recorded Future’s historic index to determine a set of unique characteristics about this campaign. Our goal was not to conclusively attribute this attack, but rather to review existing data through the lens of intelligence analysis and contribute to conversation on adversary tracking. We conducted a comparison of ATT&CK techniques across the mentioned actors, including APT29 and APT41. We compiled 25 techniques and 14 sub-techniques for UNC2452 using MITRE ATT&CK Matrix for Enterprises and techniques mentioned in public reports from FireEye and Microsoft. We then used the MITRE guidance for comparison of groups, and compared UNC2452 ATT&CK techniques against those the MITRE team documented for APT29 and APT41 using ATT&CK Navigator (Appendix). Unfortunately, our analysis surfaced several challenges. First, there are significant differences in documented ATT&CK techniques between vendors analyzing the same actor group and/or malware. For example, FireEye lists seven techniques and 10 sub-techniques in their report dated December 13, 2020; Microsoft shows four techniques and six sub-techniques for their report dated December 18, 2020. Second, several techniques for APT29 and APT41 were missing from the ATT&CK groups cataloged by MITRE, appearing to lean towards more recent attacks, such as PowerDuke campaigns. We used MITRE’s maintained list of APT TTPs for initial comparison, however these appear to have notable gaps even malware techniques and techniques for actor groups attributed to leverage the malware. Third, there were specific instances where ATT&CK lacked the nuanced matching techniques described by security reporting. For example, within ATT&CK Navigator, several techniques are automatically assigned to tactics, such as T1078 Valid Accounts, which is assigned to Initial Access, Persistence, and Defense Evasion tactics. While Microsoft does cite this technique, they limit its applicability to the Persistence tactic. Additionally, some techniques gain meaning through both repeated applications and choices of what to encode. A salted FNV-1a hashing algorithm is used in both encoding blacklisted domains and blacklisted processes, corresponding to T1132 Data Encoding. However, the domains hashed with FNV-1a are also used to standardize various components of information in checks prior to downloading the second-stage payload, creating efficiencies for communication as well as obfuscation. While ATT&CK is a strong framework for mapping adversary TTPs, it is missing elements critical to describe ongoing adversary activity and map that activity to past activity. Vendor publication of ATT&CK techniques without in-line context further reduces applicability to adversary mapping. Historic activity tracking can provide insights into both the existing, and potentially ongoing, SUNBURST/Solorigate campaign and clues to actor motivation and attribution. Victimology, in particular, is notable for UNC2452, as it demonstrates an exacting approach to preserving continuity of operations while prioritizing victims. As reported in a statement from Microsoft President Brad Smith, of approximately 18,000 organizations who received the SolarWinds update containing the backdoor, only 0.2 percent received the second stage, and 40 of those companies, 80 percent of the chosen companies, were located in the United States. According to FireEye, adversary use of domain generation algorithms (DGA) custom to each victim allowed for various organizations to identify organizations beaconing to the backdoor Command-and-Control (C2) server through passive DNS records and cracking the encoded subdomains. The plurality of victims, according to Microsoft, are information technology companies. While much of the media coverage remains on government and government contractor victims, recent reports of victims from telecommunications providers to healthcare organizations, demonstrate targeting beyond traditional espionage targets. Some victimology can be determined through the reversing the DGA used by the Solorigate backdoor. Several organizations, such as the RedDrip Team, Netresec, and Kaspersky published methods for decoding the DGA used by the backdoor for initial C2 communications. Recorded Future collected and combined information gathered from open sources such as Pastebin, passive DNS datasets (pDNS), and others related to encoded subdomains of the SolarWinds Orion backdoor first stage command and control (C2) domain avsvmcloud[.]com, and utilized three DGA decoding scripts. As of December 21, 2020, we have identified some 286 domains. Microsoft noted in its report that the malware checks domains for certain strings prior to execution, but was not able to determine the domains as they were implemented via hashes. Itay Cohen, a security researcher at Checkpoint, identified the strings as FNV-1a hashes, and was able to brute-force reverse them. Cohen noted that many of the strings appear to be SolarWinds internal domain names. In combination with the checks conducted by the malware to look for regular expressions of “solarwinds” and “test”, Cohen posited the attackers gained intimate knowledge of the SolarWinds source code, as well as the network topology and internal development domain names, in order to “minimize the risk that a vigilant employee will notice the anomaly.” Costin Raiu, along with another Kaspersky researcher, cracked the remaining hashes and published the full list of internal domain names. Such care to avoid detection is highly uncommon, and points towards an impressive degree of reconnaissance and focus.Among the blacklisted processes are a number of digital forensics and endpoint detection and response tools. A full list of the drivers can be found on the SentinelOne blog. Similar to the Microsoft revelation of blacklisted domains, this care to avoid endpoint detection again highlights the cautiousness of the actors. Additionally, analysis is needed on the list of SUNBURST blacklisted processes. The full list was cracked by several open source researchers. A public Google Sheet was compiled by Royce Willams and the Hashcat team. The list of blacklisted processes is not comprehensive of all common endpoint or antivirus vendors; further analysis is required to understand why the malware authors focused on certain endpoint software to blacklist.A unique feature of the Solorigate backdoor is the timestamp check that the last write time for the DLL was 12-14 days prior. Even among unique malware samples, this duration is atypical. MITRE ATT&CK lists a few attackers leveraging this technique, and none approaching this level of time, but this may be due to incomplete documentation within ATT&CK, as mentioned above. In addition to evasion, the time-based evasion appears to be more related to avoiding detection by SolarWinds staff rather than analysis through virtualization/sandbox analysis. In a broader examination, the campaign appears to have breached SolarWinds in the fall of 2019 and made non-malicious changes to code. These changes amounted to a dry-run of the primary infection which would occur around March 2020. Additionally, the actors inflated the size of the targeted DLL file from 500k to 900k, which may have triggered detection rules for the file, but investigations would have turned up no malicious code. When infected code was added in February/March 2020, the size increase was minimal. Time to conduct these preparatory actions over the course of months shows a level of discipline and patience seen primarily in intelligence collection operations. For this domain and the next two domains, we see a reference to either a domain registration or a certificate registration, but not both. For this reference, we see the registration of solartrackingsystem[.]net on October 2, 2018, but do not see a TLS certificate registered. This absence of a TLS certificate does not indicate that there is no certificate, as DomainTools shows a certificate for this domain. More likely, this is a gap in our coverage for certificate registrations for that time period.These delays between domain registration and certification registration suggest that the actor may have parked these domains for future use. As a result, we suggest the addition of ATT&CK sub-technique, T1583.001 Acquire Infrastructure: Domains, to the UNC2452 actor. Three of the IP addresses associated with the second-stage domains in the DomainTools report were previously seen in Recorded Future. IP addresses 13[.]57[.]184[.]217 and 198[.]12[.]75[.]112 were previously reported on abuseipdb.com on April 6, 2018 and March 19, 2020, respectively. IP address 3[.]16[.]81[.]254 was first seen on a public Pastebin post on January 20, 2019.Microsoft has also published indicators for a second malware which has been discovered to affect the SolarWinds Orion product. It is undetermined whether this malware is associated with the Solorigate backdoor or represents an additional threat actor. As per the Appendix section on the Microsoft blog: Microsoft, GuidePoint, and Palo Alto Networks have dubbed this second malware, a .NET webshell, SUPERNOVA. SUPERNOVA is thought to load CosmicGale, a malicious Powershell script. Microsoft advises that if SUPERNOVA is detected on SolarWinds installations, it should be treated as a separate infection. While far from conclusive, this additional malware raises the possibility of multiple actors within the same environment. Multiple actors on the same system, knowingly or unknowingly, are not novel. For example, evidence of both APT28 and APT29 were found on Democratic National Committee servers breached in 2016. Additionally, a file leaked from the ShadowBrokers releases showed 45 file signatures that could be used to scan for infection from other actors, some not publicly known at the time. Still, this adds to the argument that we are far from decisive attribution.At the Virus Bulletin 2018 conference, security researcher Juan Andres Guerrero-Saade stated, “Currently, our understanding is stated in binary terms: ‘is the actor sophisticated or not?’” As evidenced by the plethora of media commentary around this new campaign, not much has changed. We have attempted to add more color to the current picture of attribution, as well as attribution in general. Based on our analysis, we believe the actor behind this campaign is exceptionally focused and patient, even when compared with other state-sponsored campaigns; demonstrates an intricate knowledge of modern information technology practices, architecture, and supply chains; is experienced in a wide variety of attacker techniques; and is very familiar with security researcher techniques and approaches. We don’t have a full picture of the details of this intrusion due a variety of factors, including at least partially, balkanized data collection among a variety of security vendors and providers. The actor behind the SolarWinds breach appears to be selective of targets, both in choosing particular organizations to pursue and purposefully excluding organizations. Careful selection denotes a set of requirements for targeting rather than targets of opportunity commonly seen in cybercrime incidents. Still, this curated targeting evidently included FireEye, a curious choice for a cautious actor. Targeting a company specializing in cybersecurity demonstrates a remarkable audacity, but has been previously seen from both Russian-affiliated actors (NotPetya) and Chinese-affiliated actors (CCleaner). We can conclude this actor either weighed requirements against high risk and believed FireEye was so critical a target as to risk an entire operation, or the actor believed their expertise was such that discovery would not destroy their entire operation. Alternatively, the actor may have been driven by a penchant for revenge: some have speculated part of the motivation behind targeting the Hilary Clinton Presidential Campaign in 2016 was due to her approaches while Secretary of State. Either way, the boldness speaks to the character of the actor, as well as escalates the importance of the companies they excluded. Logically, if they believed discovery was at least a moderate possibility, the actor likely excluded certain organizations from targeting to expand the time until the exposure. Our analysis of UNC2452 shows no conclusive attribution, however that was not our exclusive intent. Incident responses and investigations are ongoing at dozens of organizations, with hundreds of others assessing impact. The leading theory of a single, known actor, speculated to be the Russian intelligence services or, possibly, a Chinese actor should continue to be assessed. However, we conclude the particular nation behind this campaign is irrelevant for the purposes of tactical defensive actions. Any single actor hypothesis would inevitably be well-funded and state-affiliated, based on the operational time spent prior to breach and the target set involved. Undoubtedly, there will be further information released in coming days and weeks, as the full scope of the campaign comes into focus. Tactically, Recorded Future suggests following the advice provided by security vendors for securing your networks and best practices for conducting investigations. Strategically, we suggest clues be added to public, annotated ATT&CK matrixes of known techniques. In this way, defenders can identify organizational gaps and prioritize improvements based on their level of impact, better assessing risk to the organization at large.While this is not conclusive, it can be significant. Techniques shown in APT29 yet not appearing in UNC2452 tracking may be areas for further discovery by defenders. Alternately, these techniques may have not been applied toward this campaign. Conversely, techniques novel to UNC2452 yet not appearing in APT29 may demonstrate newly deployed capabilities. Lack of overlay may open the possibility that UNC2452 is not related to APT29, however this is far from conclusive. Either way, if UNC2452 is ultimately attributed to APT29, this would indicate substantial investment in structure and capabilities. Certain techniques used by UNC2452 have not been observed amongst known techniques for APT29. Rather than disprove association, these could indicate substantial expansion of techniques. If UNC2452 is ultimately synonymized with APT29, we can conclude extensive resources to support such technique expansion:Some sources have posited the possibility of threat actors other than APT29 being behind the breach. One possibility which is frequently mentioned is APT41, which is attributed to China according to the September 2020 U.S. Department of Justice indictments of seven defendants, and crosses between state-associated espionage and cybercrime. We identified eight technique overlaps between APT41 and UNC2452: