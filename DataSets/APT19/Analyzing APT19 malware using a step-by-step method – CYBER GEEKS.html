<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
	 <link rel="profile" href="https://gmpg.org/xfn/11"> 
	 <title>Analyzing APT19 malware using a step-by-step method &#8211; CYBER GEEKS</title>
<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel="alternate" type="application/rss+xml" title="CYBER GEEKS &raquo; Feed" href="https://cybergeeks.tech/feed/" />
<link rel="alternate" type="application/rss+xml" title="CYBER GEEKS &raquo; Comments Feed" href="https://cybergeeks.tech/comments/feed/" />
<script>
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/cybergeeks.tech\/wp-includes\/js\/wp-emoji-release.min.js?ver=4fd0f5bc13853fae144764d9c4a67c2c"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83e\udef1\ud83c\udffb\u200d\ud83e\udef2\ud83c\udfff","\ud83e\udef1\ud83c\udffb\u200b\ud83e\udef2\ud83c\udfff")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
</script>
<link rel='stylesheet' id='astra-theme-css-css' href='https://cybergeeks.tech/wp-content/themes/astra/assets/css/minified/style.min.css?ver=4.6.3' media='all' />
<style id='astra-theme-css-inline-css'>
.ast-no-sidebar .entry-content .alignfull {margin-left: calc( -50vw + 50%);margin-right: calc( -50vw + 50%);max-width: 100vw;width: 100vw;}.ast-no-sidebar .entry-content .alignwide {margin-left: calc(-41vw + 50%);margin-right: calc(-41vw + 50%);max-width: unset;width: unset;}.ast-no-sidebar .entry-content .alignfull .alignfull,.ast-no-sidebar .entry-content .alignfull .alignwide,.ast-no-sidebar .entry-content .alignwide .alignfull,.ast-no-sidebar .entry-content .alignwide .alignwide,.ast-no-sidebar .entry-content .wp-block-column .alignfull,.ast-no-sidebar .entry-content .wp-block-column .alignwide{width: 100%;margin-left: auto;margin-right: auto;}.wp-block-gallery,.blocks-gallery-grid {margin: 0;}.wp-block-separator {max-width: 100px;}.wp-block-separator.is-style-wide,.wp-block-separator.is-style-dots {max-width: none;}.entry-content .has-2-columns .wp-block-column:first-child {padding-right: 10px;}.entry-content .has-2-columns .wp-block-column:last-child {padding-left: 10px;}@media (max-width: 782px) {.entry-content .wp-block-columns .wp-block-column {flex-basis: 100%;}.entry-content .has-2-columns .wp-block-column:first-child {padding-right: 0;}.entry-content .has-2-columns .wp-block-column:last-child {padding-left: 0;}}body .entry-content .wp-block-latest-posts {margin-left: 0;}body .entry-content .wp-block-latest-posts li {list-style: none;}.ast-no-sidebar .ast-container .entry-content .wp-block-latest-posts {margin-left: 0;}.ast-header-break-point .entry-content .alignwide {margin-left: auto;margin-right: auto;}.entry-content .blocks-gallery-item img {margin-bottom: auto;}.wp-block-pullquote {border-top: 4px solid #555d66;border-bottom: 4px solid #555d66;color: #40464d;}:root{--ast-container-default-xlg-padding:6.67em;--ast-container-default-lg-padding:5.67em;--ast-container-default-slg-padding:4.34em;--ast-container-default-md-padding:3.34em;--ast-container-default-sm-padding:6.67em;--ast-container-default-xs-padding:2.4em;--ast-container-default-xxs-padding:1.4em;--ast-code-block-background:#EEEEEE;--ast-comment-inputs-background:#FAFAFA;--ast-normal-container-width:1200px;--ast-narrow-container-width:750px;--ast-blog-title-font-weight:normal;--ast-blog-meta-weight:inherit;}html{font-size:106.25%;}a,.page-title{color:#063ae5;}a:hover,a:focus{color:#07bcea;}body,button,input,select,textarea,.ast-button,.ast-custom-button{font-family:'Merriweather',serif;font-weight:400;font-size:17px;font-size:1rem;line-height:var(--ast-body-line-height,1.79em);text-transform:none;}blockquote{color:#000000;}p,.entry-content p{margin-bottom:1.52em;}h1,.entry-content h1,h2,.entry-content h2,h3,.entry-content h3,h4,.entry-content h4,h5,.entry-content h5,h6,.entry-content h6,.site-title,.site-title a{font-family:'Inconsolata',monospace;font-weight:400;}.site-title{font-size:36px;font-size:2.1176470588235rem;display:block;}header .custom-logo-link img{max-width:96px;}.astra-logo-svg{width:96px;}.site-header .site-description{font-size:17px;font-size:1rem;display:block;}.entry-title{font-size:30px;font-size:1.7647058823529rem;}.archive .ast-article-post .ast-article-inner,.blog .ast-article-post .ast-article-inner,.archive .ast-article-post .ast-article-inner:hover,.blog .ast-article-post .ast-article-inner:hover{overflow:hidden;}h1,.entry-content h1{font-size:64px;font-size:3.7647058823529rem;font-family:'Inconsolata',monospace;text-transform:uppercase;}h2,.entry-content h2{font-size:41px;font-size:2.4117647058824rem;font-family:'Inconsolata',monospace;line-height:1.4em;text-transform:uppercase;}h3,.entry-content h3{font-size:24px;font-size:1.4117647058824rem;font-family:'Inconsolata',monospace;}h4,.entry-content h4{font-size:20px;font-size:1.1764705882353rem;line-height:1.2em;font-family:'Inconsolata',monospace;}h5,.entry-content h5{font-size:18px;font-size:1.0588235294118rem;line-height:1.2em;font-family:'Inconsolata',monospace;}h6,.entry-content h6{font-size:15px;font-size:0.88235294117647rem;line-height:1.25em;font-family:'Inconsolata',monospace;}::selection{background-color:#07bcea;color:#000000;}body,h1,.entry-title a,.entry-content h1,h2,.entry-content h2,h3,.entry-content h3,h4,.entry-content h4,h5,.entry-content h5,h6,.entry-content h6{color:#222222;}.tagcloud a:hover,.tagcloud a:focus,.tagcloud a.current-item{color:#ffffff;border-color:#063ae5;background-color:#063ae5;}input:focus,input[type="text"]:focus,input[type="email"]:focus,input[type="url"]:focus,input[type="password"]:focus,input[type="reset"]:focus,input[type="search"]:focus,textarea:focus{border-color:#063ae5;}input[type="radio"]:checked,input[type=reset],input[type="checkbox"]:checked,input[type="checkbox"]:hover:checked,input[type="checkbox"]:focus:checked,input[type=range]::-webkit-slider-thumb{border-color:#063ae5;background-color:#063ae5;box-shadow:none;}.site-footer a:hover + .post-count,.site-footer a:focus + .post-count{background:#063ae5;border-color:#063ae5;}.single .nav-links .nav-previous,.single .nav-links .nav-next{color:#063ae5;}.entry-meta,.entry-meta *{line-height:1.45;color:#063ae5;}.entry-meta a:not(.ast-button):hover,.entry-meta a:not(.ast-button):hover *,.entry-meta a:not(.ast-button):focus,.entry-meta a:not(.ast-button):focus *,.page-links > .page-link,.page-links .page-link:hover,.post-navigation a:hover{color:#07bcea;}#cat option,.secondary .calendar_wrap thead a,.secondary .calendar_wrap thead a:visited{color:#063ae5;}.secondary .calendar_wrap #today,.ast-progress-val span{background:#063ae5;}.secondary a:hover + .post-count,.secondary a:focus + .post-count{background:#063ae5;border-color:#063ae5;}.calendar_wrap #today > a{color:#ffffff;}.page-links .page-link,.single .post-navigation a{color:#063ae5;}.ast-search-menu-icon .search-form button.search-submit{padding:0 4px;}.ast-search-menu-icon form.search-form{padding-right:0;}.ast-search-menu-icon.slide-search input.search-field{width:0;}.ast-header-search .ast-search-menu-icon.ast-dropdown-active .search-form,.ast-header-search .ast-search-menu-icon.ast-dropdown-active .search-field:focus{transition:all 0.2s;}.search-form input.search-field:focus{outline:none;}.widget-title,.widget .wp-block-heading{font-size:24px;font-size:1.4117647058824rem;color:#222222;}#secondary,#secondary button,#secondary input,#secondary select,#secondary textarea{font-size:17px;font-size:1rem;}.ast-search-menu-icon.slide-search a:focus-visible:focus-visible,.astra-search-icon:focus-visible,#close:focus-visible,a:focus-visible,.ast-menu-toggle:focus-visible,.site .skip-link:focus-visible,.wp-block-loginout input:focus-visible,.wp-block-search.wp-block-search__button-inside .wp-block-search__inside-wrapper,.ast-header-navigation-arrow:focus-visible,.woocommerce .wc-proceed-to-checkout > .checkout-button:focus-visible,.woocommerce .woocommerce-MyAccount-navigation ul li a:focus-visible,.ast-orders-table__row .ast-orders-table__cell:focus-visible,.woocommerce .woocommerce-order-details .order-again > .button:focus-visible,.woocommerce .woocommerce-message a.button.wc-forward:focus-visible,.woocommerce #minus_qty:focus-visible,.woocommerce #plus_qty:focus-visible,a#ast-apply-coupon:focus-visible,.woocommerce .woocommerce-info a:focus-visible,.woocommerce .astra-shop-summary-wrap a:focus-visible,.woocommerce a.wc-forward:focus-visible,#ast-apply-coupon:focus-visible,.woocommerce-js .woocommerce-mini-cart-item a.remove:focus-visible,#close:focus-visible,.button.search-submit:focus-visible,#search_submit:focus,.normal-search:focus-visible{outline-style:dotted;outline-color:inherit;outline-width:thin;}input:focus,input[type="text"]:focus,input[type="email"]:focus,input[type="url"]:focus,input[type="password"]:focus,input[type="reset"]:focus,input[type="search"]:focus,input[type="number"]:focus,textarea:focus,.wp-block-search__input:focus,[data-section="section-header-mobile-trigger"] .ast-button-wrap .ast-mobile-menu-trigger-minimal:focus,.ast-mobile-popup-drawer.active .menu-toggle-close:focus,.woocommerce-ordering select.orderby:focus,#ast-scroll-top:focus,#coupon_code:focus,.woocommerce-page #comment:focus,.woocommerce #reviews #respond input#submit:focus,.woocommerce a.add_to_cart_button:focus,.woocommerce .button.single_add_to_cart_button:focus,.woocommerce .woocommerce-cart-form button:focus,.woocommerce .woocommerce-cart-form__cart-item .quantity .qty:focus,.woocommerce .woocommerce-billing-fields .woocommerce-billing-fields__field-wrapper .woocommerce-input-wrapper > .input-text:focus,.woocommerce #order_comments:focus,.woocommerce #place_order:focus,.woocommerce .woocommerce-address-fields .woocommerce-address-fields__field-wrapper .woocommerce-input-wrapper > .input-text:focus,.woocommerce .woocommerce-MyAccount-content form button:focus,.woocommerce .woocommerce-MyAccount-content .woocommerce-EditAccountForm .woocommerce-form-row .woocommerce-Input.input-text:focus,.woocommerce .ast-woocommerce-container .woocommerce-pagination ul.page-numbers li a:focus,body #content .woocommerce form .form-row .select2-container--default .select2-selection--single:focus,#ast-coupon-code:focus,.woocommerce.woocommerce-js .quantity input[type=number]:focus,.woocommerce-js .woocommerce-mini-cart-item .quantity input[type=number]:focus,.woocommerce p#ast-coupon-trigger:focus{border-style:dotted;border-color:inherit;border-width:thin;}input{outline:none;}.main-header-menu .menu-link,.ast-header-custom-item a{color:#222222;}.main-header-menu .menu-item:hover > .menu-link,.main-header-menu .menu-item:hover > .ast-menu-toggle,.main-header-menu .ast-masthead-custom-menu-items a:hover,.main-header-menu .menu-item.focus > .menu-link,.main-header-menu .menu-item.focus > .ast-menu-toggle,.main-header-menu .current-menu-item > .menu-link,.main-header-menu .current-menu-ancestor > .menu-link,.main-header-menu .current-menu-item > .ast-menu-toggle,.main-header-menu .current-menu-ancestor > .ast-menu-toggle{color:#063ae5;}.header-main-layout-3 .ast-main-header-bar-alignment{margin-right:auto;}.header-main-layout-2 .site-header-section-left .ast-site-identity{text-align:left;}.site-logo-img img{ transition:all 0.2s linear;}body .ast-oembed-container *{position:absolute;top:0;width:100%;height:100%;left:0;}.ast-header-break-point .ast-mobile-menu-buttons-minimal.menu-toggle{background:transparent;color:#ffffff;}.ast-header-break-point .ast-mobile-menu-buttons-outline.menu-toggle{background:transparent;border:1px solid #ffffff;color:#ffffff;}.ast-header-break-point .ast-mobile-menu-buttons-fill.menu-toggle{background:#ffffff;color:#ffffff;}.ast-single-post-featured-section + article {margin-top: 2em;}.site-content .ast-single-post-featured-section img {width: 100%;overflow: hidden;object-fit: cover;}.site > .ast-single-related-posts-container {margin-top: 0;}@media (min-width: 922px) {.ast-desktop .ast-container--narrow {max-width: var(--ast-narrow-container-width);margin: 0 auto;}}#secondary {margin: 4em 0 2.5em;word-break: break-word;line-height: 2;}#secondary li {margin-bottom: 0.25em;}#secondary li:last-child {margin-bottom: 0;}@media (max-width: 768px) {.js_active .ast-plain-container.ast-single-post #secondary {margin-top: 1.5em;}}.ast-separate-container.ast-two-container #secondary .widget {background-color: #fff;padding: 2em;margin-bottom: 2em;}@media (min-width: 993px) {.ast-left-sidebar #secondary {padding-right: 60px;}.ast-right-sidebar #secondary {padding-left: 60px;}}@media (max-width: 993px) {.ast-right-sidebar #secondary {padding-left: 30px;}.ast-left-sidebar #secondary {padding-right: 30px;}}.ast-small-footer{color:#d3d3d3;}.ast-small-footer > .ast-footer-overlay{background-color:#191919;;}.ast-small-footer a{color:#fb2056;}.ast-small-footer a:hover{color:#fb2056;}.footer-adv .footer-adv-overlay{border-top-style:solid;border-top-color:#7a7a7a;}.wp-block-buttons.aligncenter{justify-content:center;}@media (max-width:782px){.entry-content .wp-block-columns .wp-block-column{margin-left:0px;}}.wp-block-image.aligncenter{margin-left:auto;margin-right:auto;}.wp-block-table.aligncenter{margin-left:auto;margin-right:auto;}.wp-block-buttons .wp-block-button.is-style-outline .wp-block-button__link.wp-element-button,.ast-outline-button{border-color:#ffffff;border-top-width:2px;border-right-width:2px;border-bottom-width:2px;border-left-width:2px;font-family:inherit;font-weight:700;font-size:14px;font-size:0.82352941176471rem;line-height:1em;border-top-left-radius:30px;border-top-right-radius:30px;border-bottom-right-radius:30px;border-bottom-left-radius:30px;}.wp-block-button.is-style-outline .wp-block-button__link:hover,.wp-block-buttons .wp-block-button.is-style-outline .wp-block-button__link:focus,.wp-block-buttons .wp-block-button.is-style-outline > .wp-block-button__link:not(.has-text-color):hover,.wp-block-buttons .wp-block-button.wp-block-button__link.is-style-outline:not(.has-text-color):hover,.ast-outline-button:hover,.ast-outline-button:focus{background-color:#d6d6d6;}.wp-block-button .wp-block-button__link.wp-element-button.is-style-outline:not(.has-background),.wp-block-button.is-style-outline>.wp-block-button__link.wp-element-button:not(.has-background),.ast-outline-button{background-color:#ffffff;}.entry-content[ast-blocks-layout] > figure{margin-bottom:1em;}@media (max-width:921px){.ast-separate-container #primary,.ast-separate-container #secondary{padding:1.5em 0;}#primary,#secondary{padding:1.5em 0;margin:0;}.ast-left-sidebar #content > .ast-container{display:flex;flex-direction:column-reverse;width:100%;}.ast-separate-container .ast-article-post,.ast-separate-container .ast-article-single{padding:1.5em 2.14em;}.ast-author-box img.avatar{margin:20px 0 0 0;}}@media (max-width:921px){#secondary.secondary{padding-top:0;}.ast-separate-container.ast-right-sidebar #secondary{padding-left:1em;padding-right:1em;}.ast-separate-container.ast-two-container #secondary{padding-left:0;padding-right:0;}.ast-page-builder-template .entry-header #secondary,.ast-page-builder-template #secondary{margin-top:1.5em;}}@media (max-width:921px){.ast-right-sidebar #primary{padding-right:0;}.ast-page-builder-template.ast-left-sidebar #secondary,.ast-page-builder-template.ast-right-sidebar #secondary{padding-right:20px;padding-left:20px;}.ast-right-sidebar #secondary,.ast-left-sidebar #primary{padding-left:0;}.ast-left-sidebar #secondary{padding-right:0;}}@media (min-width:922px){.ast-separate-container.ast-right-sidebar #primary,.ast-separate-container.ast-left-sidebar #primary{border:0;}.search-no-results.ast-separate-container #primary{margin-bottom:4em;}}@media (min-width:922px){.ast-right-sidebar #primary{border-right:1px solid var(--ast-border-color);}.ast-left-sidebar #primary{border-left:1px solid var(--ast-border-color);}.ast-right-sidebar #secondary{border-left:1px solid var(--ast-border-color);margin-left:-1px;}.ast-left-sidebar #secondary{border-right:1px solid var(--ast-border-color);margin-right:-1px;}.ast-separate-container.ast-two-container.ast-right-sidebar #secondary{padding-left:30px;padding-right:0;}.ast-separate-container.ast-two-container.ast-left-sidebar #secondary{padding-right:30px;padding-left:0;}.ast-separate-container.ast-right-sidebar #secondary,.ast-separate-container.ast-left-sidebar #secondary{border:0;margin-left:auto;margin-right:auto;}.ast-separate-container.ast-two-container #secondary .widget:last-child{margin-bottom:0;}}.elementor-button-wrapper .elementor-button{border-style:solid;text-decoration:none;border-top-width:0;border-right-width:0;border-left-width:0;border-bottom-width:0;}body .elementor-button.elementor-size-sm,body .elementor-button.elementor-size-xs,body .elementor-button.elementor-size-md,body .elementor-button.elementor-size-lg,body .elementor-button.elementor-size-xl,body .elementor-button{border-top-left-radius:30px;border-top-right-radius:30px;border-bottom-right-radius:30px;border-bottom-left-radius:30px;padding-top:17px;padding-right:40px;padding-bottom:17px;padding-left:40px;}.elementor-button-wrapper .elementor-button{border-color:#ffffff;background-color:#ffffff;}.elementor-button-wrapper .elementor-button:hover,.elementor-button-wrapper .elementor-button:focus{color:#ffffff;background-color:#d6d6d6;border-color:#d6d6d6;}.wp-block-button .wp-block-button__link ,.elementor-button-wrapper .elementor-button,.elementor-button-wrapper .elementor-button:visited{color:#ffffff;}.elementor-button-wrapper .elementor-button{font-weight:700;font-size:14px;font-size:0.82352941176471rem;line-height:1em;text-transform:uppercase;}body .elementor-button.elementor-size-sm,body .elementor-button.elementor-size-xs,body .elementor-button.elementor-size-md,body .elementor-button.elementor-size-lg,body .elementor-button.elementor-size-xl,body .elementor-button{font-size:14px;font-size:0.82352941176471rem;}.wp-block-button .wp-block-button__link:hover,.wp-block-button .wp-block-button__link:focus{color:#ffffff;background-color:#d6d6d6;border-color:#d6d6d6;}.elementor-widget-heading h2.elementor-heading-title{line-height:1.4em;}.elementor-widget-heading h4.elementor-heading-title{line-height:1.2em;}.elementor-widget-heading h5.elementor-heading-title{line-height:1.2em;}.elementor-widget-heading h6.elementor-heading-title{line-height:1.25em;}.wp-block-button .wp-block-button__link{border-top-width:0;border-right-width:0;border-left-width:0;border-bottom-width:0;border-color:#ffffff;background-color:#ffffff;color:#ffffff;font-family:inherit;font-weight:700;line-height:1em;text-transform:uppercase;font-size:14px;font-size:0.82352941176471rem;border-top-left-radius:30px;border-top-right-radius:30px;border-bottom-right-radius:30px;border-bottom-left-radius:30px;padding-top:17px;padding-right:40px;padding-bottom:17px;padding-left:40px;}.menu-toggle,button,.ast-button,.ast-custom-button,.button,input#submit,input[type="button"],input[type="submit"],input[type="reset"]{border-style:solid;border-top-width:0;border-right-width:0;border-left-width:0;border-bottom-width:0;color:#ffffff;border-color:#ffffff;background-color:#ffffff;padding-top:17px;padding-right:40px;padding-bottom:17px;padding-left:40px;font-family:inherit;font-weight:700;font-size:14px;font-size:0.82352941176471rem;line-height:1em;text-transform:uppercase;border-top-left-radius:30px;border-top-right-radius:30px;border-bottom-right-radius:30px;border-bottom-left-radius:30px;}button:focus,.menu-toggle:hover,button:hover,.ast-button:hover,.ast-custom-button:hover .button:hover,.ast-custom-button:hover ,input[type=reset]:hover,input[type=reset]:focus,input#submit:hover,input#submit:focus,input[type="button"]:hover,input[type="button"]:focus,input[type="submit"]:hover,input[type="submit"]:focus{color:#ffffff;background-color:#d6d6d6;border-color:#d6d6d6;}@media (max-width:921px){.ast-mobile-header-stack .main-header-bar .ast-search-menu-icon{display:inline-block;}.ast-header-break-point.ast-header-custom-item-outside .ast-mobile-header-stack .main-header-bar .ast-search-icon{margin:0;}.ast-comment-avatar-wrap img{max-width:2.5em;}.ast-comment-meta{padding:0 1.8888em 1.3333em;}.ast-separate-container .ast-comment-list li.depth-1{padding:1.5em 2.14em;}.ast-separate-container .comment-respond{padding:2em 2.14em;}}@media (min-width:544px){.ast-container{max-width:100%;}}@media (max-width:544px){.ast-separate-container .ast-article-post,.ast-separate-container .ast-article-single,.ast-separate-container .comments-title,.ast-separate-container .ast-archive-description{padding:1.5em 1em;}.ast-separate-container #content .ast-container{padding-left:0.54em;padding-right:0.54em;}.ast-separate-container .ast-comment-list .bypostauthor{padding:.5em;}.ast-search-menu-icon.ast-dropdown-active .search-field{width:170px;}.ast-separate-container #secondary{padding-top:0;}.ast-separate-container.ast-two-container #secondary .widget{margin-bottom:1.5em;padding-left:1em;padding-right:1em;}.site-branding img,.site-header .site-logo-img .custom-logo-link img{max-width:100%;}}body,.ast-separate-container{background-color:#f2f4f5;;}.ast-no-sidebar.ast-separate-container .entry-content .alignfull {margin-left: -6.67em;margin-right: -6.67em;width: auto;}@media (max-width: 1200px) {.ast-no-sidebar.ast-separate-container .entry-content .alignfull {margin-left: -2.4em;margin-right: -2.4em;}}@media (max-width: 768px) {.ast-no-sidebar.ast-separate-container .entry-content .alignfull {margin-left: -2.14em;margin-right: -2.14em;}}@media (max-width: 544px) {.ast-no-sidebar.ast-separate-container .entry-content .alignfull {margin-left: -1em;margin-right: -1em;}}.ast-no-sidebar.ast-separate-container .entry-content .alignwide {margin-left: -20px;margin-right: -20px;}.ast-no-sidebar.ast-separate-container .entry-content .wp-block-column .alignfull,.ast-no-sidebar.ast-separate-container .entry-content .wp-block-column .alignwide {margin-left: auto;margin-right: auto;width: 100%;}@media (max-width:921px){.site-title{display:block;}.site-header .site-description{display:block;}h1,.entry-content h1{font-size:44px;}h2,.entry-content h2{font-size:32px;}h3,.entry-content h3{font-size:20px;}}@media (max-width:544px){.widget-title{font-size:21px;font-size:1.4rem;}body,button,input,select,textarea,.ast-button,.ast-custom-button{font-size:15px;font-size:0.88235294117647rem;}#secondary,#secondary button,#secondary input,#secondary select,#secondary textarea{font-size:15px;font-size:0.88235294117647rem;}.site-title{font-size:20px;font-size:1.1764705882353rem;display:block;}.site-header .site-description{font-size:14px;font-size:0.82352941176471rem;display:block;}h1,.entry-content h1{font-size:30px;}h2,.entry-content h2{font-size:24px;}h3,.entry-content h3{font-size:20px;}h4,.entry-content h4{font-size:19px;font-size:1.1176470588235rem;}h5,.entry-content h5{font-size:16px;font-size:0.94117647058824rem;}h6,.entry-content h6{font-size:15px;font-size:0.88235294117647rem;}header .custom-logo-link img,.ast-header-break-point .site-branding img,.ast-header-break-point .custom-logo-link img{max-width:100px;}.astra-logo-svg{width:100px;}.ast-header-break-point .site-logo-img .custom-mobile-logo-link img{max-width:100px;}}@media (max-width:921px){html{font-size:96.9%;}}@media (max-width:544px){html{font-size:106.25%;}}@media (min-width:922px){.ast-container{max-width:1240px;}}@font-face {font-family: "Astra";src: url(https://cybergeeks.tech/wp-content/themes/astra/assets/fonts/astra.woff) format("woff"),url(https://cybergeeks.tech/wp-content/themes/astra/assets/fonts/astra.ttf) format("truetype"),url(https://cybergeeks.tech/wp-content/themes/astra/assets/fonts/astra.svg#astra) format("svg");font-weight: normal;font-style: normal;font-display: fallback;}@media (max-width:921px) {.main-header-bar .main-header-bar-navigation{display:none;}}.ast-desktop .main-header-menu.submenu-with-border .sub-menu,.ast-desktop .main-header-menu.submenu-with-border .astra-full-megamenu-wrapper{border-color:#07bcea;}.ast-desktop .main-header-menu.submenu-with-border .sub-menu{border-top-width:2px;border-style:solid;}.ast-desktop .main-header-menu.submenu-with-border .sub-menu .sub-menu{top:-2px;}.ast-desktop .main-header-menu.submenu-with-border .sub-menu .menu-link,.ast-desktop .main-header-menu.submenu-with-border .children .menu-link{border-bottom-width:0px;border-style:solid;border-color:#eaeaea;}@media (min-width:922px){.main-header-menu .sub-menu .menu-item.ast-left-align-sub-menu:hover > .sub-menu,.main-header-menu .sub-menu .menu-item.ast-left-align-sub-menu.focus > .sub-menu{margin-left:-0px;}}.ast-header-break-point.ast-header-custom-item-inside .main-header-bar .main-header-bar-navigation .ast-search-icon {display: none;}.ast-header-break-point.ast-header-custom-item-inside .main-header-bar .ast-search-menu-icon .search-form {padding: 0;display: block;overflow: hidden;}.ast-header-break-point .ast-header-custom-item .widget:last-child {margin-bottom: 1em;}.ast-header-custom-item .widget {margin: 0.5em;display: inline-block;vertical-align: middle;}.ast-header-custom-item .widget p {margin-bottom: 0;}.ast-header-custom-item .widget li {width: auto;}.ast-header-custom-item-inside .button-custom-menu-item .menu-link {display: none;}.ast-header-custom-item-inside.ast-header-break-point .button-custom-menu-item .ast-custom-button-link {display: none;}.ast-header-custom-item-inside.ast-header-break-point .button-custom-menu-item .menu-link {display: block;}.ast-header-break-point.ast-header-custom-item-outside .main-header-bar .ast-search-icon {margin-right: 1em;}.ast-header-break-point.ast-header-custom-item-inside .main-header-bar .ast-search-menu-icon .search-field,.ast-header-break-point.ast-header-custom-item-inside .main-header-bar .ast-search-menu-icon.ast-inline-search .search-field {width: 100%;padding-right: 5.5em;}.ast-header-break-point.ast-header-custom-item-inside .main-header-bar .ast-search-menu-icon .search-submit {display: block;position: absolute;height: 100%;top: 0;right: 0;padding: 0 1em;border-radius: 0;}.ast-header-break-point .ast-header-custom-item .ast-masthead-custom-menu-items {padding-left: 20px;padding-right: 20px;margin-bottom: 1em;margin-top: 1em;}.ast-header-custom-item-inside.ast-header-break-point .button-custom-menu-item {padding-left: 0;padding-right: 0;margin-top: 0;margin-bottom: 0;}.astra-icon-down_arrow::after {content: "\e900";font-family: Astra;}.astra-icon-close::after {content: "\e5cd";font-family: Astra;}.astra-icon-drag_handle::after {content: "\e25d";font-family: Astra;}.astra-icon-format_align_justify::after {content: "\e235";font-family: Astra;}.astra-icon-menu::after {content: "\e5d2";font-family: Astra;}.astra-icon-reorder::after {content: "\e8fe";font-family: Astra;}.astra-icon-search::after {content: "\e8b6";font-family: Astra;}.astra-icon-zoom_in::after {content: "\e56b";font-family: Astra;}.astra-icon-check-circle::after {content: "\e901";font-family: Astra;}.astra-icon-shopping-cart::after {content: "\f07a";font-family: Astra;}.astra-icon-shopping-bag::after {content: "\f290";font-family: Astra;}.astra-icon-shopping-basket::after {content: "\f291";font-family: Astra;}.astra-icon-circle-o::after {content: "\e903";font-family: Astra;}.astra-icon-certificate::after {content: "\e902";font-family: Astra;}blockquote {padding: 1.2em;}:root .has-ast-global-color-0-color{color:var(--ast-global-color-0);}:root .has-ast-global-color-0-background-color{background-color:var(--ast-global-color-0);}:root .wp-block-button .has-ast-global-color-0-color{color:var(--ast-global-color-0);}:root .wp-block-button .has-ast-global-color-0-background-color{background-color:var(--ast-global-color-0);}:root .has-ast-global-color-1-color{color:var(--ast-global-color-1);}:root .has-ast-global-color-1-background-color{background-color:var(--ast-global-color-1);}:root .wp-block-button .has-ast-global-color-1-color{color:var(--ast-global-color-1);}:root .wp-block-button .has-ast-global-color-1-background-color{background-color:var(--ast-global-color-1);}:root .has-ast-global-color-2-color{color:var(--ast-global-color-2);}:root .has-ast-global-color-2-background-color{background-color:var(--ast-global-color-2);}:root .wp-block-button .has-ast-global-color-2-color{color:var(--ast-global-color-2);}:root .wp-block-button .has-ast-global-color-2-background-color{background-color:var(--ast-global-color-2);}:root .has-ast-global-color-3-color{color:var(--ast-global-color-3);}:root .has-ast-global-color-3-background-color{background-color:var(--ast-global-color-3);}:root .wp-block-button .has-ast-global-color-3-color{color:var(--ast-global-color-3);}:root .wp-block-button .has-ast-global-color-3-background-color{background-color:var(--ast-global-color-3);}:root .has-ast-global-color-4-color{color:var(--ast-global-color-4);}:root .has-ast-global-color-4-background-color{background-color:var(--ast-global-color-4);}:root .wp-block-button .has-ast-global-color-4-color{color:var(--ast-global-color-4);}:root .wp-block-button .has-ast-global-color-4-background-color{background-color:var(--ast-global-color-4);}:root .has-ast-global-color-5-color{color:var(--ast-global-color-5);}:root .has-ast-global-color-5-background-color{background-color:var(--ast-global-color-5);}:root .wp-block-button .has-ast-global-color-5-color{color:var(--ast-global-color-5);}:root .wp-block-button .has-ast-global-color-5-background-color{background-color:var(--ast-global-color-5);}:root .has-ast-global-color-6-color{color:var(--ast-global-color-6);}:root .has-ast-global-color-6-background-color{background-color:var(--ast-global-color-6);}:root .wp-block-button .has-ast-global-color-6-color{color:var(--ast-global-color-6);}:root .wp-block-button .has-ast-global-color-6-background-color{background-color:var(--ast-global-color-6);}:root .has-ast-global-color-7-color{color:var(--ast-global-color-7);}:root .has-ast-global-color-7-background-color{background-color:var(--ast-global-color-7);}:root .wp-block-button .has-ast-global-color-7-color{color:var(--ast-global-color-7);}:root .wp-block-button .has-ast-global-color-7-background-color{background-color:var(--ast-global-color-7);}:root .has-ast-global-color-8-color{color:var(--ast-global-color-8);}:root .has-ast-global-color-8-background-color{background-color:var(--ast-global-color-8);}:root .wp-block-button .has-ast-global-color-8-color{color:var(--ast-global-color-8);}:root .wp-block-button .has-ast-global-color-8-background-color{background-color:var(--ast-global-color-8);}:root{--ast-global-color-0:#0170B9;--ast-global-color-1:#3a3a3a;--ast-global-color-2:#3a3a3a;--ast-global-color-3:#4B4F58;--ast-global-color-4:#F5F5F5;--ast-global-color-5:#FFFFFF;--ast-global-color-6:#E5E5E5;--ast-global-color-7:#424242;--ast-global-color-8:#000000;}:root {--ast-border-color : #dddddd;}.ast-single-entry-banner {-js-display: flex;display: flex;flex-direction: column;justify-content: center;text-align: center;position: relative;background: #eeeeee;}.ast-single-entry-banner[data-banner-layout="layout-1"] {max-width: 1200px;background: inherit;padding: 20px 0;}.ast-single-entry-banner[data-banner-width-type="custom"] {margin: 0 auto;width: 100%;}.ast-single-entry-banner + .site-content .entry-header {margin-bottom: 0;}.site .ast-author-avatar {--ast-author-avatar-size: ;}a.ast-underline-text {text-decoration: underline;}.ast-container > .ast-terms-link {position: relative;display: block;}a.ast-button.ast-badge-tax {padding: 4px 8px;border-radius: 3px;font-size: inherit;}header.entry-header .entry-title{font-size:30px;font-size:1.7647058823529rem;}header.entry-header > *:not(:last-child){margin-bottom:10px;}.ast-archive-entry-banner {-js-display: flex;display: flex;flex-direction: column;justify-content: center;text-align: center;position: relative;background: #eeeeee;}.ast-archive-entry-banner[data-banner-width-type="custom"] {margin: 0 auto;width: 100%;}.ast-archive-entry-banner[data-banner-layout="layout-1"] {background: inherit;padding: 20px 0;text-align: left;}body.archive .ast-archive-description{max-width:1200px;width:100%;text-align:left;padding-top:3em;padding-right:3em;padding-bottom:3em;padding-left:3em;}body.archive .ast-archive-description .ast-archive-title,body.archive .ast-archive-description .ast-archive-title *{font-size:40px;font-size:2.3529411764706rem;text-transform:capitalize;}body.archive .ast-archive-description > *:not(:last-child){margin-bottom:10px;}@media (max-width:921px){body.archive .ast-archive-description{text-align:left;}}@media (max-width:544px){body.archive .ast-archive-description{text-align:left;}}.ast-breadcrumbs .trail-browse,.ast-breadcrumbs .trail-items,.ast-breadcrumbs .trail-items li{display:inline-block;margin:0;padding:0;border:none;background:inherit;text-indent:0;text-decoration:none;}.ast-breadcrumbs .trail-browse{font-size:inherit;font-style:inherit;font-weight:inherit;color:inherit;}.ast-breadcrumbs .trail-items{list-style:none;}.trail-items li::after{padding:0 0.3em;content:"\00bb";}.trail-items li:last-of-type::after{display:none;}h1,.entry-content h1,h2,.entry-content h2,h3,.entry-content h3,h4,.entry-content h4,h5,.entry-content h5,h6,.entry-content h6{color:#222222;}.elementor-template-full-width .ast-container{display:block;}.elementor-screen-only,.screen-reader-text,.screen-reader-text span,.ui-helper-hidden-accessible{top:0 !important;}@media (max-width:544px){.elementor-element .elementor-wc-products .woocommerce[class*="columns-"] ul.products li.product{width:auto;margin:0;}.elementor-element .woocommerce .woocommerce-result-count{float:none;}}.ast-header-break-point .main-header-bar{border-bottom-width:0px;}@media (min-width:922px){.main-header-bar{border-bottom-width:0px;}}@media (min-width:922px){#primary{width:70%;}#secondary{width:30%;}}.main-header-menu .menu-item, #astra-footer-menu .menu-item, .main-header-bar .ast-masthead-custom-menu-items{-js-display:flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;}.main-header-menu > .menu-item > .menu-link, #astra-footer-menu > .menu-item > .menu-link{height:100%;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-js-display:flex;display:flex;}.ast-primary-menu-disabled .main-header-bar .ast-masthead-custom-menu-items{flex:unset;}.header-main-layout-1 .ast-flex.main-header-container, .header-main-layout-3 .ast-flex.main-header-container{-webkit-align-content:center;-ms-flex-line-pack:center;align-content:center;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;}.main-header-menu .sub-menu .menu-item.menu-item-has-children > .menu-link:after{position:absolute;right:1em;top:50%;transform:translate(0,-50%) rotate(270deg);}.ast-header-break-point .main-header-bar .main-header-bar-navigation .page_item_has_children > .ast-menu-toggle::before, .ast-header-break-point .main-header-bar .main-header-bar-navigation .menu-item-has-children > .ast-menu-toggle::before, .ast-mobile-popup-drawer .main-header-bar-navigation .menu-item-has-children>.ast-menu-toggle::before, .ast-header-break-point .ast-mobile-header-wrap .main-header-bar-navigation .menu-item-has-children > .ast-menu-toggle::before{font-weight:bold;content:"\e900";font-family:Astra;text-decoration:inherit;display:inline-block;}.ast-header-break-point .main-navigation ul.sub-menu .menu-item .menu-link:before{content:"\e900";font-family:Astra;font-size:.65em;text-decoration:inherit;display:inline-block;transform:translate(0, -2px) rotateZ(270deg);margin-right:5px;}.widget_search .search-form:after{font-family:Astra;font-size:1.2em;font-weight:normal;content:"\e8b6";position:absolute;top:50%;right:15px;transform:translate(0, -50%);}.astra-search-icon::before{content:"\e8b6";font-family:Astra;font-style:normal;font-weight:normal;text-decoration:inherit;text-align:center;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;z-index:3;}.main-header-bar .main-header-bar-navigation .page_item_has_children > a:after, .main-header-bar .main-header-bar-navigation .menu-item-has-children > a:after, .menu-item-has-children .ast-header-navigation-arrow:after{content:"\e900";display:inline-block;font-family:Astra;font-size:.6rem;font-weight:bold;text-rendering:auto;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;margin-left:10px;line-height:normal;}.menu-item-has-children .sub-menu .ast-header-navigation-arrow:after{margin-left:0;}.ast-mobile-popup-drawer .main-header-bar-navigation .ast-submenu-expanded>.ast-menu-toggle::before{transform:rotateX(180deg);}.ast-header-break-point .main-header-bar-navigation .menu-item-has-children > .menu-link:after{display:none;}@media (min-width:922px){.ast-builder-menu .main-navigation > ul > li:last-child a{margin-right:0;}}.ast-separate-container .ast-article-inner{background-color:transparent;background-image:none;}.ast-separate-container .ast-article-post{background-color:var(--ast-global-color-5);;}@media (max-width:921px){.ast-separate-container .ast-article-post{background-color:var(--ast-global-color-5);;}}@media (max-width:544px){.ast-separate-container .ast-article-post{background-color:var(--ast-global-color-5);;}}.ast-separate-container .ast-article-single:not(.ast-related-post), .woocommerce.ast-separate-container .ast-woocommerce-container, .ast-separate-container .error-404, .ast-separate-container .no-results, .single.ast-separate-container  .ast-author-meta, .ast-separate-container .related-posts-title-wrapper,.ast-separate-container .comments-count-wrapper, .ast-box-layout.ast-plain-container .site-content,.ast-padded-layout.ast-plain-container .site-content, .ast-separate-container .ast-archive-description, .ast-separate-container .comments-area .comment-respond, .ast-separate-container .comments-area .ast-comment-list li, .ast-separate-container .comments-area .comments-title{background-color:var(--ast-global-color-5);;}@media (max-width:921px){.ast-separate-container .ast-article-single:not(.ast-related-post), .woocommerce.ast-separate-container .ast-woocommerce-container, .ast-separate-container .error-404, .ast-separate-container .no-results, .single.ast-separate-container  .ast-author-meta, .ast-separate-container .related-posts-title-wrapper,.ast-separate-container .comments-count-wrapper, .ast-box-layout.ast-plain-container .site-content,.ast-padded-layout.ast-plain-container .site-content, .ast-separate-container .ast-archive-description{background-color:var(--ast-global-color-5);;}}@media (max-width:544px){.ast-separate-container .ast-article-single:not(.ast-related-post), .woocommerce.ast-separate-container .ast-woocommerce-container, .ast-separate-container .error-404, .ast-separate-container .no-results, .single.ast-separate-container  .ast-author-meta, .ast-separate-container .related-posts-title-wrapper,.ast-separate-container .comments-count-wrapper, .ast-box-layout.ast-plain-container .site-content,.ast-padded-layout.ast-plain-container .site-content, .ast-separate-container .ast-archive-description{background-color:var(--ast-global-color-5);;}}.ast-separate-container.ast-two-container #secondary .widget{background-color:var(--ast-global-color-5);;}@media (max-width:921px){.ast-separate-container.ast-two-container #secondary .widget{background-color:var(--ast-global-color-5);;}}@media (max-width:544px){.ast-separate-container.ast-two-container #secondary .widget{background-color:var(--ast-global-color-5);;}}:root{--e-global-color-astglobalcolor0:#0170B9;--e-global-color-astglobalcolor1:#3a3a3a;--e-global-color-astglobalcolor2:#3a3a3a;--e-global-color-astglobalcolor3:#4B4F58;--e-global-color-astglobalcolor4:#F5F5F5;--e-global-color-astglobalcolor5:#FFFFFF;--e-global-color-astglobalcolor6:#E5E5E5;--e-global-color-astglobalcolor7:#424242;--e-global-color-astglobalcolor8:#000000;}
</style>
<link rel='stylesheet' id='astra-google-fonts-css' href='https://fonts.googleapis.com/css?family=Merriweather%3A400%2C%7CInconsolata%3A400%2C&#038;display=fallback&#038;ver=4.6.3' media='all' />
<link rel='stylesheet' id='astra-menu-animation-css' href='https://cybergeeks.tech/wp-content/themes/astra/assets/css/minified/menu-animation.min.css?ver=4.6.3' media='all' />
<style id='wp-emoji-styles-inline-css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://cybergeeks.tech/wp-includes/css/dist/block-library/style.min.css?ver=4fd0f5bc13853fae144764d9c4a67c2c' media='all' />
<link rel='stylesheet' id='nfd-wonder-blocks-utilities-css' href='https://cybergeeks.tech/wp-content/plugins/bluehost-wordpress-plugin/vendor/newfold-labs/wp-module-patterns/assets/build/utilities.css?ver=0.1.12' media='all' />
<style id='global-styles-inline-css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--ast-global-color-0: var(--ast-global-color-0);--wp--preset--color--ast-global-color-1: var(--ast-global-color-1);--wp--preset--color--ast-global-color-2: var(--ast-global-color-2);--wp--preset--color--ast-global-color-3: var(--ast-global-color-3);--wp--preset--color--ast-global-color-4: var(--ast-global-color-4);--wp--preset--color--ast-global-color-5: var(--ast-global-color-5);--wp--preset--color--ast-global-color-6: var(--ast-global-color-6);--wp--preset--color--ast-global-color-7: var(--ast-global-color-7);--wp--preset--color--ast-global-color-8: var(--ast-global-color-8);--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}body { margin: 0;--wp--style--global--content-size: var(--wp--custom--ast-content-width-size);--wp--style--global--wide-size: var(--wp--custom--ast-wide-width-size); }.wp-site-blocks > .alignleft { float: left; margin-right: 2em; }.wp-site-blocks > .alignright { float: right; margin-left: 2em; }.wp-site-blocks > .aligncenter { justify-content: center; margin-left: auto; margin-right: auto; }:where(.wp-site-blocks) > * { margin-block-start: 24px; margin-block-end: 0; }:where(.wp-site-blocks) > :first-child:first-child { margin-block-start: 0; }:where(.wp-site-blocks) > :last-child:last-child { margin-block-end: 0; }body { --wp--style--block-gap: 24px; }:where(body .is-layout-flow)  > :first-child:first-child{margin-block-start: 0;}:where(body .is-layout-flow)  > :last-child:last-child{margin-block-end: 0;}:where(body .is-layout-flow)  > *{margin-block-start: 24px;margin-block-end: 0;}:where(body .is-layout-constrained)  > :first-child:first-child{margin-block-start: 0;}:where(body .is-layout-constrained)  > :last-child:last-child{margin-block-end: 0;}:where(body .is-layout-constrained)  > *{margin-block-start: 24px;margin-block-end: 0;}:where(body .is-layout-flex) {gap: 24px;}:where(body .is-layout-grid) {gap: 24px;}body .is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}body .is-layout-grid{display: grid;}body .is-layout-grid > *{margin: 0;}body{padding-top: 0px;padding-right: 0px;padding-bottom: 0px;padding-left: 0px;}a:where(:not(.wp-element-button)){text-decoration: none;}.wp-element-button, .wp-block-button__link{background-color: #32373c;border-width: 0;color: #fff;font-family: inherit;font-size: inherit;line-height: inherit;padding: calc(0.667em + 2px) calc(1.333em + 2px);text-decoration: none;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-ast-global-color-0-color{color: var(--wp--preset--color--ast-global-color-0) !important;}.has-ast-global-color-1-color{color: var(--wp--preset--color--ast-global-color-1) !important;}.has-ast-global-color-2-color{color: var(--wp--preset--color--ast-global-color-2) !important;}.has-ast-global-color-3-color{color: var(--wp--preset--color--ast-global-color-3) !important;}.has-ast-global-color-4-color{color: var(--wp--preset--color--ast-global-color-4) !important;}.has-ast-global-color-5-color{color: var(--wp--preset--color--ast-global-color-5) !important;}.has-ast-global-color-6-color{color: var(--wp--preset--color--ast-global-color-6) !important;}.has-ast-global-color-7-color{color: var(--wp--preset--color--ast-global-color-7) !important;}.has-ast-global-color-8-color{color: var(--wp--preset--color--ast-global-color-8) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-ast-global-color-0-background-color{background-color: var(--wp--preset--color--ast-global-color-0) !important;}.has-ast-global-color-1-background-color{background-color: var(--wp--preset--color--ast-global-color-1) !important;}.has-ast-global-color-2-background-color{background-color: var(--wp--preset--color--ast-global-color-2) !important;}.has-ast-global-color-3-background-color{background-color: var(--wp--preset--color--ast-global-color-3) !important;}.has-ast-global-color-4-background-color{background-color: var(--wp--preset--color--ast-global-color-4) !important;}.has-ast-global-color-5-background-color{background-color: var(--wp--preset--color--ast-global-color-5) !important;}.has-ast-global-color-6-background-color{background-color: var(--wp--preset--color--ast-global-color-6) !important;}.has-ast-global-color-7-background-color{background-color: var(--wp--preset--color--ast-global-color-7) !important;}.has-ast-global-color-8-background-color{background-color: var(--wp--preset--color--ast-global-color-8) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-ast-global-color-0-border-color{border-color: var(--wp--preset--color--ast-global-color-0) !important;}.has-ast-global-color-1-border-color{border-color: var(--wp--preset--color--ast-global-color-1) !important;}.has-ast-global-color-2-border-color{border-color: var(--wp--preset--color--ast-global-color-2) !important;}.has-ast-global-color-3-border-color{border-color: var(--wp--preset--color--ast-global-color-3) !important;}.has-ast-global-color-4-border-color{border-color: var(--wp--preset--color--ast-global-color-4) !important;}.has-ast-global-color-5-border-color{border-color: var(--wp--preset--color--ast-global-color-5) !important;}.has-ast-global-color-6-border-color{border-color: var(--wp--preset--color--ast-global-color-6) !important;}.has-ast-global-color-7-border-color{border-color: var(--wp--preset--color--ast-global-color-7) !important;}.has-ast-global-color-8-border-color{border-color: var(--wp--preset--color--ast-global-color-8) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='ppress-frontend-css' href='https://cybergeeks.tech/wp-content/plugins/wp-user-avatar/assets/css/frontend.min.css?ver=4.14.2' media='all' />
<link rel='stylesheet' id='ppress-flatpickr-css' href='https://cybergeeks.tech/wp-content/plugins/wp-user-avatar/assets/flatpickr/flatpickr.min.css?ver=4.14.2' media='all' />
<link rel='stylesheet' id='ppress-select2-css' href='https://cybergeeks.tech/wp-content/plugins/wp-user-avatar/assets/select2/select2.min.css?ver=4fd0f5bc13853fae144764d9c4a67c2c' media='all' />
<!--[if IE]>
<script src="https://cybergeeks.tech/wp-content/themes/astra/assets/js/minified/flexibility.min.js?ver=4.6.3" id="astra-flexibility-js"></script>
<script id="astra-flexibility-js-after">
flexibility(document.documentElement);
</script>
<![endif]-->
<script src="https://cybergeeks.tech/wp-content/plugins/bluehost-wordpress-plugin/vendor/newfold-labs/wp-module-patterns/assets/build/utilities.js?ver=0.1.12" id="nfd-wonder-blocks-utilities-js"></script>
<script src="https://cybergeeks.tech/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script src="https://cybergeeks.tech/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script src="https://cybergeeks.tech/wp-content/plugins/wp-user-avatar/assets/flatpickr/flatpickr.min.js?ver=4.14.2" id="ppress-flatpickr-js"></script>
<script src="https://cybergeeks.tech/wp-content/plugins/wp-user-avatar/assets/select2/select2.min.js?ver=4.14.2" id="ppress-select2-js"></script>
<link rel="https://api.w.org/" href="https://cybergeeks.tech/wp-json/" /><link rel="alternate" type="application/json" href="https://cybergeeks.tech/wp-json/wp/v2/posts/512" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://cybergeeks.tech/xmlrpc.php?rsd" />
<link rel="canonical" href="https://cybergeeks.tech/analyzing-apt19-malware-using-a-step-by-step-method/" />
<link rel="alternate" type="application/json+oembed" href="https://cybergeeks.tech/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fcybergeeks.tech%2Fanalyzing-apt19-malware-using-a-step-by-step-method%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://cybergeeks.tech/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fcybergeeks.tech%2Fanalyzing-apt19-malware-using-a-step-by-step-method%2F&#038;format=xml" />
        <style>
            #nfd-site-status {
                background-color: #F8F8F8;
                color: #333333;
                padding: 0 16px;
            }

            #nfd-site-status-coming-soon {
                color: #E01C1C;
                display: none;
            }

            #nfd-site-status-live {
                color: #048200;
                display: none;
            }

            #nfd-site-status[data-coming-soon="true"] #nfd-site-status-coming-soon {
                display: inline-block;
            }

            #nfd-site-status[data-coming-soon="false"] #nfd-site-status-live {
                display: inline-block;
            }
        </style>
		<meta name="generator" content="Elementor 3.18.3; features: e_dom_optimization, e_optimized_assets_loading, additional_custom_breakpoints, block_editor_assets_optimize, e_image_loading_optimization; settings: css_print_method-external, google_font-enabled, font_display-auto">
		<style id="wp-custom-css">
			button {
    display: inline-block;
    height: 50px;
    padding: 0;
    margin: 0;
    vertical-align: top;
    width: 50px;
}
figure.wp-block-image {
    margin: auto;
    }
#close-image img {
    display: block;
    height: 50px;  
    width: 50px;
}
#close-CSS {
    background-image: url( 'https://cybergeeks.tech/wp-content/uploads/2020/07/RSS-button.png' );
    background-size: 49px 49px;
    height: 50px;  
    width: 50px;
		border-radius: 2px;
}
		</style>
		<style id="wpforms-css-vars-root">
				:root {
					--wpforms-field-border-radius: 3px;
--wpforms-field-background-color: #ffffff;
--wpforms-field-border-color: rgba( 0, 0, 0, 0.25 );
--wpforms-field-text-color: rgba( 0, 0, 0, 0.7 );
--wpforms-label-color: rgba( 0, 0, 0, 0.85 );
--wpforms-label-sublabel-color: rgba( 0, 0, 0, 0.55 );
--wpforms-label-error-color: #d63637;
--wpforms-button-border-radius: 3px;
--wpforms-button-background-color: #066aab;
--wpforms-button-text-color: #ffffff;
--wpforms-field-size-input-height: 43px;
--wpforms-field-size-input-spacing: 15px;
--wpforms-field-size-font-size: 16px;
--wpforms-field-size-line-height: 19px;
--wpforms-field-size-padding-h: 14px;
--wpforms-field-size-checkbox-size: 16px;
--wpforms-field-size-sublabel-spacing: 5px;
--wpforms-field-size-icon-size: 1;
--wpforms-label-size-font-size: 16px;
--wpforms-label-size-line-height: 19px;
--wpforms-label-size-sublabel-font-size: 14px;
--wpforms-label-size-sublabel-line-height: 17px;
--wpforms-button-size-font-size: 17px;
--wpforms-button-size-height: 41px;
--wpforms-button-size-padding-h: 15px;
--wpforms-button-size-margin-top: 10px;

				}
			</style></head>

<body data-rsssl=1 itemtype='https://schema.org/Blog' itemscope='itemscope' class="post-template-default single single-post postid-512 single-format-standard ast-desktop ast-plain-container ast-right-sidebar astra-4.6.3 ast-header-custom-item-inside group-blog ast-blog-single-style-1 ast-single-post ast-mobile-inherit-site-logo ast-inherit-site-logo-transparent ast-normal-title-enabled elementor-default elementor-kit-212">

<a
	class="skip-link screen-reader-text"
	href="#content"
	role="link"
	title="Skip to content">
		Skip to content</a>

<div
class="hfeed site" id="page">
			<header
		class="site-header ast-primary-submenu-animation-fade header-main-layout-1 ast-primary-menu-enabled ast-menu-toggle-icon ast-mobile-header-inline" id="masthead" itemtype="https://schema.org/WPHeader" itemscope="itemscope" itemid="#masthead"		>
			
<div class="main-header-bar-wrap">
	<div class="main-header-bar">
				<div class="ast-container">

			<div class="ast-flex main-header-container">
				
		<div class="site-branding">
			<div
			class="ast-site-identity" itemtype="https://schema.org/Organization" itemscope="itemscope"			>
				<div class="ast-site-title-wrap">
						<span class="site-title" itemprop="name">
				<a href="https://cybergeeks.tech/" rel="home" itemprop="url" >
					CYBER GEEKS
				</a>
			</span>
						<p class="site-description" itemprop="description">
				All Things Infosec
			</p>
				</div>			</div>
		</div>

		<!-- .site-branding -->
				<div class="ast-mobile-menu-buttons">

			
					<div class="ast-button-wrap">
			<button type="button" class="menu-toggle main-header-menu-toggle  ast-mobile-menu-buttons-fill "  aria-controls='primary-menu' aria-expanded='false'>
				<span class="screen-reader-text">Main Menu</span>
				<span class="ast-icon icon-menu-bars"><span class="menu-toggle-icon"></span></span>							</button>
		</div>
			
			
		</div>
			<div class="ast-main-header-bar-alignment"><div class="main-header-bar-navigation"><nav class="site-navigation ast-flex-grow-1 navigation-accessibility" id="primary-site-navigation" aria-label="Site Navigation" itemtype="https://schema.org/SiteNavigationElement" itemscope="itemscope"><div class="main-navigation"><ul id="primary-menu" class="main-header-menu ast-menu-shadow ast-nav-menu ast-flex ast-justify-content-flex-end  submenu-with-border astra-menu-animation-fade ">			<li class="ast-masthead-custom-menu-items text-html-custom-menu-item">
				<div class="ast-custom-html"><form action="/feed"><button id="close-CSS"></button>
</form></div>			</li>
			</ul></div></nav></div></div>			</div><!-- Main Header Container -->
		</div><!-- ast-row -->
			</div> <!-- Main Header Bar -->
</div> <!-- Main Header Bar Wrap -->
		</header><!-- #masthead -->
			<div id="content" class="site-content">
		<div class="ast-container">
		

	<div id="primary" class="content-area primary">

		
					<main id="main" class="site-main">
				

<article
class="post-512 post type-post status-publish format-standard hentry category-malwareanalysis ast-article-single" id="post-512" itemtype="https://schema.org/CreativeWork" itemscope="itemscope">

	
	
<div class="ast-post-format- ast-no-thumb single-layout-1">

	
	
		<header class="entry-header ast-no-thumbnail">

			
			<h1 class="entry-title" itemprop="headline">Analyzing APT19 malware using a step-by-step method</h1><div class="entry-meta">By <span class="posted-by vcard author" itemtype="https://schema.org/Person" itemscope="itemscope" itemprop="author">			<a title="View all posts by CyberMasterV"
				href="https://cybergeeks.tech/author/cybermaster/" rel="author"
				class="url fn n" itemprop="url"				>
				<span
				class="author-name" itemprop="name"				>
				CyberMasterV			</span>
			</a>
		</span>

		 / <span class="posted-on"><span class="published" itemprop="datePublished"> December 26, 2020 </span></span> / <span class="ast-terms-link"><a href="https://cybergeeks.tech/category/malwareanalysis/" class="">Malware analysis</a></span></div>
			
		</header><!-- .entry-header -->

	
	
	<div class="entry-content clear"
	itemprop="text"	>

		
		
<p style="font-size:25px">Summary</p>



<p>In this blog post we&#8217;re presenting a full analysis of a DLL backdoor also reported publicly as Derusbi. This particular piece of malware is associated with the actor known as APT19 (Codoso, C0d0so, Sunshop Group).</p>



<p>APT19, also known as C0d0so or Deep Panda, is allegedly a Chinese-based threat group that targeted a lot of industries in the past. FireEye reported that APT19 was active in 2017 when they used 3 different methods to compromise targets: CVE-2017-0199 vulnerability, macro-enabled Microsoft Excel (XLSM) documents and an application whitelisting bypass to the XLSM documents.</p>



<p>The malware registers itself as a service if it has run with administrator privileges, otherwise, it establishes persistence via the &#8220;Run&#8221; registry key. The main purpose of the malicious DLL is to gather information about the victim&#8217;s environment such as username, hostname, IP address of the host, the CPU architecture, the default language for the local system, the amount of physical memory, the amount of physical memory currently available, the processor name, the width and the height of the screen of the primary display monitor. The exfiltrated data is encrypted using a XOR operation (the 1-byte key seems to be randomly-chosen), and then encoded using the Base64 algorithm. There is a lot of network communication performed by the malware, however, due to the fact that the C2 server seems to be sinkholed now, we were not able to retrieve the file that was intended to be downloaded by the process.</p>



<p style="font-size:25px">Technical analysis</p>



<p>SHA256: DE33DFCE8143F9F929ABDA910632F7536FFA809603EC027A4193D5E57880B292</p>



<p>The file analyzed in this blog post is a DLL that has the following export functions:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img fetchpriority="high" decoding="async" width="532" height="105" src="https://cybergeeks.tech/wp-content/uploads/2020/12/1.jpg" alt="" class="wp-image-513" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/1.jpg 532w, https://cybergeeks.tech/wp-content/uploads/2020/12/1-300x59.jpg 300w" sizes="(max-width: 532px) 100vw, 532px" /><figcaption>Figure 1</figcaption></figure></div>



<p>DebugCreate and DebugConnect entries have the same address and represent the starting point of the malicious activity.  The process computes a random string of 3 characters using GetTickCount API calls and the algorithm shown in figure 2:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img decoding="async" width="402" height="581" src="https://cybergeeks.tech/wp-content/uploads/2020/12/2.jpg" alt="" class="wp-image-515" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/2.jpg 402w, https://cybergeeks.tech/wp-content/uploads/2020/12/2-208x300.jpg 208w" sizes="(max-width: 402px) 100vw, 402px" /><figcaption>Figure 2</figcaption></figure></div>



<p>It tries to delete a file/directory called &lt;3 random chars generated earlier&gt;.dll from System32 directory as shown below:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img decoding="async" width="382" height="437" src="https://cybergeeks.tech/wp-content/uploads/2020/12/3.jpg" alt="" class="wp-image-516" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/3.jpg 382w, https://cybergeeks.tech/wp-content/uploads/2020/12/3-262x300.jpg 262w" sizes="(max-width: 382px) 100vw, 382px" /><figcaption>Figure 3</figcaption></figure></div>



<p>Because the file doesn&#8217;t exist at this time, it&#8217;s created using CreateFileA API and then deleted using DeleteFileA API. This technique is used to confirm that it has enough rights to write files in the System32 directory:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="368" src="https://cybergeeks.tech/wp-content/uploads/2020/12/4-1024x368.jpg" alt="" class="wp-image-517" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/4-1024x368.jpg 1024w, https://cybergeeks.tech/wp-content/uploads/2020/12/4-300x108.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/4-768x276.jpg 768w, https://cybergeeks.tech/wp-content/uploads/2020/12/4.jpg 1090w" sizes="(max-width: 1024px) 100vw, 1024px" /><figcaption>Figure 4</figcaption></figure></div>



<p>The malicious process retrieves process privilege details by calling GetTokenInformation with parameter type 0x14 (TokenElevation):</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="994" height="327" src="https://cybergeeks.tech/wp-content/uploads/2020/12/5.jpg" alt="" class="wp-image-520" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/5.jpg 994w, https://cybergeeks.tech/wp-content/uploads/2020/12/5-300x99.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/5-768x253.jpg 768w" sizes="(max-width: 994px) 100vw, 994px" /><figcaption>Figure 5</figcaption></figure></div>



<p class="has-medium-font-size">Malware running with admin privileges</p>



<p>Now it queries the &#8220;HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows NT\CurrentVersion\Svchost\netsvcs&#8221; registry value using RegQueryValueExA&nbsp;function:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="777" height="350" src="https://cybergeeks.tech/wp-content/uploads/2020/12/6.jpg" alt="" class="wp-image-521" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/6.jpg 777w, https://cybergeeks.tech/wp-content/uploads/2020/12/6-300x135.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/6-768x346.jpg 768w" sizes="(max-width: 777px) 100vw, 777px" /><figcaption>Figure 6</figcaption></figure></div>



<p>The list of services retrieved earlier is shown in the next figure:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="521" height="254" src="https://cybergeeks.tech/wp-content/uploads/2020/12/7.jpg" alt="" class="wp-image-522" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/7.jpg 521w, https://cybergeeks.tech/wp-content/uploads/2020/12/7-300x146.jpg 300w" sizes="(max-width: 521px) 100vw, 521px" /><figcaption>Figure 7</figcaption></figure></div>



<p>There is another service called WinHelpSrv that is added to this list. The &#8220;netsvcs&#8221; value is modified to reflect the change by calling RegSetValueExA API:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="793" height="399" src="https://cybergeeks.tech/wp-content/uploads/2020/12/8.jpg" alt="" class="wp-image-523" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/8.jpg 793w, https://cybergeeks.tech/wp-content/uploads/2020/12/8-300x151.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/8-768x386.jpg 768w" sizes="(max-width: 793px) 100vw, 793px" /><figcaption>Figure 8</figcaption></figure></div>



<p>The file creates a new service named WinHelpSrv (Windows Helper Service) as follows:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="570" height="417" src="https://cybergeeks.tech/wp-content/uploads/2020/12/9.jpg" alt="" class="wp-image-524" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/9.jpg 570w, https://cybergeeks.tech/wp-content/uploads/2020/12/9-300x219.jpg 300w" sizes="(max-width: 570px) 100vw, 570px" /><figcaption>Figure 9</figcaption></figure></div>



<p>The description of the service is set to &#8220;This is windows helper service. Include windows update and windows error&#8221;:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="189" src="https://cybergeeks.tech/wp-content/uploads/2020/12/10-1024x189.jpg" alt="" class="wp-image-525" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/10-1024x189.jpg 1024w, https://cybergeeks.tech/wp-content/uploads/2020/12/10-300x55.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/10-768x142.jpg 768w, https://cybergeeks.tech/wp-content/uploads/2020/12/10.jpg 1180w" sizes="(max-width: 1024px) 100vw, 1024px" /><figcaption>Figure 10</figcaption></figure></div>



<p>The malicious DLL is registered as a service by adding the &#8220;ServiceDll&#8221; value that points to its location to the newly created service registry keys:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="903" height="218" src="https://cybergeeks.tech/wp-content/uploads/2020/12/11.jpg" alt="" class="wp-image-526" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/11.jpg 903w, https://cybergeeks.tech/wp-content/uploads/2020/12/11-300x72.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/11-768x185.jpg 768w" sizes="(max-width: 903px) 100vw, 903px" /><figcaption>Figure 11</figcaption></figure></div>



<p>The confirmation that the operation was successful:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="124" src="https://cybergeeks.tech/wp-content/uploads/2020/12/12-1024x124.jpg" alt="" class="wp-image-527" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/12-1024x124.jpg 1024w, https://cybergeeks.tech/wp-content/uploads/2020/12/12-300x36.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/12-768x93.jpg 768w, https://cybergeeks.tech/wp-content/uploads/2020/12/12.jpg 1148w" sizes="(max-width: 1024px) 100vw, 1024px" /><figcaption>Figure 12</figcaption></figure></div>



<p>The process creates a batch file called &lt;10 random chars&gt;.bat (the same algorithm utilized before to generate the random letters is used):</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="844" height="130" src="https://cybergeeks.tech/wp-content/uploads/2020/12/13.jpg" alt="" class="wp-image-528" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/13.jpg 844w, https://cybergeeks.tech/wp-content/uploads/2020/12/13-300x46.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/13-768x118.jpg 768w" sizes="(max-width: 844px) 100vw, 844px" /><figcaption>Figure 13</figcaption></figure></div>



<p>The content of the .bat file is presented below:</p>



<pre class="wp-block-code"><code>@echo off

net start %1

del %0</code></pre>



<p>The malicious file sets the priority class 0x100 (REALTIME_PRIORITY_CLASS) for the current process (this means that the current process has the highest possible priority):</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="844" height="199" src="https://cybergeeks.tech/wp-content/uploads/2020/12/14-1.jpg" alt="" class="wp-image-532" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/14-1.jpg 844w, https://cybergeeks.tech/wp-content/uploads/2020/12/14-1-300x71.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/14-1-768x181.jpg 768w" sizes="(max-width: 844px) 100vw, 844px" /><figcaption>Figure 14</figcaption></figure></div>



<p>After this operation, there is a call to SetThreadPriority that sets the priority 15 (THREAD_PRIORITY_TIME_CRITICAL) for the current thread:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="699" height="152" src="https://cybergeeks.tech/wp-content/uploads/2020/12/15.jpg" alt="" class="wp-image-533" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/15.jpg 699w, https://cybergeeks.tech/wp-content/uploads/2020/12/15-300x65.jpg 300w" sizes="(max-width: 699px) 100vw, 699px" /><figcaption>Figure 15</figcaption></figure></div>



<p>Now there are 2 SHChangeNotify API calls with the following parameters: 0x4 (SHCNE_DELETE), 0x5 (SHCNF_PATH), the 3rd parameter is the path to rundll32.exe (because the dll was run using rundll32) and the name of the batch file, respectively, and the 4th parameter is 0. These calls have the purpose of notifying the system if rundll32.exe or the batch file is deleted:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="961" height="187" src="https://cybergeeks.tech/wp-content/uploads/2020/12/16.jpg" alt="" class="wp-image-534" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/16.jpg 961w, https://cybergeeks.tech/wp-content/uploads/2020/12/16-300x58.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/16-768x149.jpg 768w" sizes="(max-width: 961px) 100vw, 961px" /><figcaption>Figure 16</figcaption></figure></div>



<p>The batch file is executed using the WinExec function. Basically, it starts the WinHelpSrv service, and then the batch file is deleted:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="890" height="123" src="https://cybergeeks.tech/wp-content/uploads/2020/12/17.jpg" alt="" class="wp-image-535" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/17.jpg 890w, https://cybergeeks.tech/wp-content/uploads/2020/12/17-300x41.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/17-768x106.jpg 768w" sizes="(max-width: 890px) 100vw, 890px" /><figcaption>Figure 17</figcaption></figure></div>



<p>Now we&#8217;ll talk a bit about the ServiceMain export function that is called when the new service starts. The process registers a function to handle service control requests by calling the RegisterServiceCtrlHandlerA&nbsp;function:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="954" height="144" src="https://cybergeeks.tech/wp-content/uploads/2020/12/18.jpg" alt="" class="wp-image-536" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/18.jpg 954w, https://cybergeeks.tech/wp-content/uploads/2020/12/18-300x45.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/18-768x116.jpg 768w" sizes="(max-width: 954px) 100vw, 954px" /><figcaption>Figure 18</figcaption></figure></div>



<p>There is a call to SetServiceStatus function using the following SERVICE_STATUS structure: 0x10 (SERVICE_WIN32_OWN_PROCESS), 0x2 (SERVICE_START_PENDING), 0 (no controls are accepted), 0 (dwWin32ExitCode), 0 (dwServiceSpecificExitCode), 0x1 (dwCheckPoint) and 0xbb8 (3000 ms, the amount of time that the service expects an operation to take before the next status update):</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="961" height="181" src="https://cybergeeks.tech/wp-content/uploads/2020/12/19.jpg" alt="" class="wp-image-537" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/19.jpg 961w, https://cybergeeks.tech/wp-content/uploads/2020/12/19-300x57.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/19-768x145.jpg 768w" sizes="(max-width: 961px) 100vw, 961px" /><figcaption>Figure 19</figcaption></figure></div>



<p>The malicious process creates an unnamed event object by calling the CreateEvent function:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="863" height="182" src="https://cybergeeks.tech/wp-content/uploads/2020/12/20.jpg" alt="" class="wp-image-538" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/20.jpg 863w, https://cybergeeks.tech/wp-content/uploads/2020/12/20-300x63.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/20-768x162.jpg 768w" sizes="(max-width: 863px) 100vw, 863px" /><figcaption>Figure 20</figcaption></figure></div>



<p>Now it follows another SetServiceStatus call by using the following SERVICE_STATUS structure: 0x10 (SERVICE_WIN32_OWN_PROCESS), 0x4 (SERVICE_RUNNING), 0x1 (SERVICE_ACCEPT_STOP), 0 (dwWin32ExitCode), 0 (dwServiceSpecificExitCode), 0 (dwCheckPoint) and 0 (dwWaitHint):</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="951" height="170" src="https://cybergeeks.tech/wp-content/uploads/2020/12/21.jpg" alt="" class="wp-image-539" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/21.jpg 951w, https://cybergeeks.tech/wp-content/uploads/2020/12/21-300x54.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/21-768x137.jpg 768w" sizes="(max-width: 951px) 100vw, 951px" /><figcaption>Figure 21</figcaption></figure></div>



<p>The final operation of this section is to create a new thread using the CreateThread function. The same action will be performed even if the process hasn&#8217;t run with admin privileges, as we&#8217;ll see later on:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="954" height="222" src="https://cybergeeks.tech/wp-content/uploads/2020/12/22.jpg" alt="" class="wp-image-540" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/22.jpg 954w, https://cybergeeks.tech/wp-content/uploads/2020/12/22-300x70.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/22-768x179.jpg 768w" sizes="(max-width: 954px) 100vw, 954px" /><figcaption>Figure 22</figcaption></figure></div>



<p class="has-medium-font-size">Malware running without admin privileges</p>



<p>The malware uses an anti-analysis technique by comparing the image path of the executable with rundll32.exe. It is done to ensure that the file is not executed by a sandbox/analyst (it exits if that&#8217;s the case):</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="624" height="479" src="https://cybergeeks.tech/wp-content/uploads/2020/12/23-1.jpg" alt="" class="wp-image-543" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/23-1.jpg 624w, https://cybergeeks.tech/wp-content/uploads/2020/12/23-1-300x230.jpg 300w" sizes="(max-width: 624px) 100vw, 624px" /><figcaption>Figure 23</figcaption></figure></div>



<p>The malware is made persistent by adding a new value called WinHelpSrv under the &#8220;Run&#8221; registry key. In our case, this value points to the location of rundll32.exe because the DLL was run using this executable:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="227" src="https://cybergeeks.tech/wp-content/uploads/2020/12/24-1024x227.jpg" alt="" class="wp-image-545" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/24-1024x227.jpg 1024w, https://cybergeeks.tech/wp-content/uploads/2020/12/24-300x67.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/24-768x170.jpg 768w, https://cybergeeks.tech/wp-content/uploads/2020/12/24.jpg 1037w" sizes="(max-width: 1024px) 100vw, 1024px" /><figcaption>Figure 24</figcaption></figure></div>



<p>The confirmation that the persistence was successfully established:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="122" src="https://cybergeeks.tech/wp-content/uploads/2020/12/25-1024x122.jpg" alt="" class="wp-image-546" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/25-1024x122.jpg 1024w, https://cybergeeks.tech/wp-content/uploads/2020/12/25-300x36.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/25-768x92.jpg 768w, https://cybergeeks.tech/wp-content/uploads/2020/12/25.jpg 1148w" sizes="(max-width: 1024px) 100vw, 1024px" /><figcaption>Figure 25</figcaption></figure></div>



<p>As written before, a new thread is created to execute the same function mentioned when the malware has run with administrator privileges. CreateThread API call is displayed in the next picture:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="838" height="222" src="https://cybergeeks.tech/wp-content/uploads/2020/12/26.jpg" alt="" class="wp-image-547" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/26.jpg 838w, https://cybergeeks.tech/wp-content/uploads/2020/12/26-300x79.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/26-768x203.jpg 768w" sizes="(max-width: 838px) 100vw, 838px" /><figcaption>Figure 26</figcaption></figure></div>



<p>There is a call to GetMessage API to retrieve messages from the thread&#8217;s message queue. If the message is 0x10 (WM_CLOSE), 0x11 (WM_QUERYENDSESSION) or 0x16 (WM_ENDSESSION) the current function terminates its execution:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="599" height="626" src="https://cybergeeks.tech/wp-content/uploads/2020/12/27.jpg" alt="" class="wp-image-548" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/27.jpg 599w, https://cybergeeks.tech/wp-content/uploads/2020/12/27-287x300.jpg 287w" sizes="(max-width: 599px) 100vw, 599px" /><figcaption>Figure 27</figcaption></figure></div>



<p class="has-medium-font-size">Thread activity &#8211; StartAddress address</p>



<p>During the entire execution, the internet is emulated using Fakenet. We&#8217;ve observed multiple MultiByteToWideChar function calls used to convert character strings to UTF-16 (wide character) strings. One such call is shown below:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="213" src="https://cybergeeks.tech/wp-content/uploads/2020/12/28-1024x213.jpg" alt="" class="wp-image-549" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/28-1024x213.jpg 1024w, https://cybergeeks.tech/wp-content/uploads/2020/12/28-300x62.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/28-768x160.jpg 768w, https://cybergeeks.tech/wp-content/uploads/2020/12/28.jpg 1100w" sizes="(max-width: 1024px) 100vw, 1024px" /><figcaption>Figure 28</figcaption></figure></div>



<p>The malware uses the WinHttpOpen function to initialize the use of WinHTTP functions. The user agent is hardcoded in the DLL file:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="164" src="https://cybergeeks.tech/wp-content/uploads/2020/12/29-1024x164.jpg" alt="" class="wp-image-550" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/29-1024x164.jpg 1024w, https://cybergeeks.tech/wp-content/uploads/2020/12/29-300x48.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/29-768x123.jpg 768w, https://cybergeeks.tech/wp-content/uploads/2020/12/29.jpg 1282w" sizes="(max-width: 1024px) 100vw, 1024px" /><figcaption>Figure 29</figcaption></figure></div>



<p>There is a call to WinHttpSetTimeouts function in order to set time-outs involved in HTTP transactions. nResolveTimeout, nConnectTimeout, nSendTimeout and nReceiveTimeout are set to 0x1D4C0 (120.000ms = 120 seconds):</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="922" height="196" src="https://cybergeeks.tech/wp-content/uploads/2020/12/30.jpg" alt="" class="wp-image-551" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/30.jpg 922w, https://cybergeeks.tech/wp-content/uploads/2020/12/30-300x64.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/30-768x163.jpg 768w" sizes="(max-width: 922px) 100vw, 922px" /><figcaption>Figure 30</figcaption></figure></div>



<p>The initial target server of an HTTP request is set to 106.185.43.96 on port 0x50 (80). The WinHttpConnect API call is displayed in figure 31.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="183" src="https://cybergeeks.tech/wp-content/uploads/2020/12/31-1024x183.jpg" alt="" class="wp-image-552" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/31-1024x183.jpg 1024w, https://cybergeeks.tech/wp-content/uploads/2020/12/31-300x54.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/31-768x138.jpg 768w, https://cybergeeks.tech/wp-content/uploads/2020/12/31.jpg 1044w" sizes="(max-width: 1024px) 100vw, 1024px" /><figcaption>Figure 31</figcaption></figure></div>



<p>The process performs a GET request to the server mentioned above, with the target resource being /user/atv.html. The pwszReferrer parameter is set to &#8220;http://www.google.com&#8221; and dwFlags is set to 0x100 (WINHTTP_FLAG_BYPASS_PROXY_CACHE):</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="213" src="https://cybergeeks.tech/wp-content/uploads/2020/12/32-1024x213.jpg" alt="" class="wp-image-553" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/32-1024x213.jpg 1024w, https://cybergeeks.tech/wp-content/uploads/2020/12/32-300x63.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/32-768x160.jpg 768w, https://cybergeeks.tech/wp-content/uploads/2020/12/32.jpg 1099w" sizes="(max-width: 1024px) 100vw, 1024px" /><figcaption>Figure 32</figcaption></figure></div>



<p>After the WinHttpOpenRequest call there is a WinHttpSendRequest function call. The HTTP request is intercepted by Fakenet, and it replies with a fake response:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="126" src="https://cybergeeks.tech/wp-content/uploads/2020/12/33-1024x126.jpg" alt="" class="wp-image-554" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/33-1024x126.jpg 1024w, https://cybergeeks.tech/wp-content/uploads/2020/12/33-300x37.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/33-768x95.jpg 768w, https://cybergeeks.tech/wp-content/uploads/2020/12/33.jpg 1201w" sizes="(max-width: 1024px) 100vw, 1024px" /><figcaption>Figure 33</figcaption></figure></div>



<p>Now the process is awaiting a response to the HTTP request by calling the WinHttpReceiveResponse function:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="925" height="131" src="https://cybergeeks.tech/wp-content/uploads/2020/12/34.jpg" alt="" class="wp-image-555" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/34.jpg 925w, https://cybergeeks.tech/wp-content/uploads/2020/12/34-300x42.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/34-768x109.jpg 768w" sizes="(max-width: 925px) 100vw, 925px" /><figcaption>Figure 34</figcaption></figure></div>



<p>Afterward, the malicious file retrieves header information using WinHttpQueryHeaders API with 0x16 (WINHTTP_QUERY_RAW_HEADERS_CRLF) parameter &#8211; receives all the headers returned by the HTTP server:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="929" height="234" src="https://cybergeeks.tech/wp-content/uploads/2020/12/35.jpg" alt="" class="wp-image-556" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/35.jpg 929w, https://cybergeeks.tech/wp-content/uploads/2020/12/35-300x76.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/35-768x193.jpg 768w" sizes="(max-width: 929px) 100vw, 929px" /><figcaption>Figure 35</figcaption></figure></div>



<p>There is a second WinHttpQueryHeaders API call with 0x20000013 (WINHTTP_QUERY_FLAG_NUMBER|WINHTTP_QUERY_STATUS_CODE) parameter &#8211; the status code returned by the HTTP server. It expects a status code of 200 (OK):</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="927" height="261" src="https://cybergeeks.tech/wp-content/uploads/2020/12/36.jpg" alt="" class="wp-image-557" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/36.jpg 927w, https://cybergeeks.tech/wp-content/uploads/2020/12/36-300x84.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/36-768x216.jpg 768w" sizes="(max-width: 927px) 100vw, 927px" /><figcaption>Figure 36</figcaption></figure></div>



<p>The process uses the WinHttpQueryDataAvailable function to see how many bytes are available to be read with WinHttpReadData:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="926" height="132" src="https://cybergeeks.tech/wp-content/uploads/2020/12/37.jpg" alt="" class="wp-image-558" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/37.jpg 926w, https://cybergeeks.tech/wp-content/uploads/2020/12/37-300x43.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/37-768x109.jpg 768w" sizes="(max-width: 926px) 100vw, 926px" /><figcaption>Figure 37</figcaption></figure></div>



<p>Next, there is a call to the WinHttpReadData function that is used to read data returned by the server:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="184" src="https://cybergeeks.tech/wp-content/uploads/2020/12/38-1024x184.jpg" alt="" class="wp-image-559" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/38-1024x184.jpg 1024w, https://cybergeeks.tech/wp-content/uploads/2020/12/38-300x54.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/38-768x138.jpg 768w, https://cybergeeks.tech/wp-content/uploads/2020/12/38.jpg 1073w" sizes="(max-width: 1024px) 100vw, 1024px" /><figcaption>Figure 38</figcaption></figure></div>



<p>The malicious process uses the WSAStartup function with 0x202 parameter (wVersionRequired) in order to use the Winsock DLL. The current directory for the process is changed to the location of the current executable (rundll32.exe):</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="102" src="https://cybergeeks.tech/wp-content/uploads/2020/12/39-1024x102.jpg" alt="" class="wp-image-560" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/39-1024x102.jpg 1024w, https://cybergeeks.tech/wp-content/uploads/2020/12/39-300x30.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/39-768x77.jpg 768w, https://cybergeeks.tech/wp-content/uploads/2020/12/39.jpg 1104w" sizes="(max-width: 1024px) 100vw, 1024px" /><figcaption>Figure 39</figcaption></figure></div>



<p>GetAdaptersInfo&nbsp;API is utilized to find adapter information for the local machine. The function call is presented in the next figure.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="923" height="181" src="https://cybergeeks.tech/wp-content/uploads/2020/12/40.jpg" alt="" class="wp-image-561" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/40.jpg 923w, https://cybergeeks.tech/wp-content/uploads/2020/12/40-300x59.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/40-768x151.jpg 768w" sizes="(max-width: 923px) 100vw, 923px" /><figcaption>Figure 40</figcaption></figure></div>



<p>The malware opens the &#8220;Software\Microsoft\Windows\CurrentVersion\Internet Settings&#8221; registry key by calling the RegCreateKeyExA&nbsp;function:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1277" height="300" src="https://cybergeeks.tech/wp-content/uploads/2020/12/41-1024x241.jpg" alt="" class="wp-image-563" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/41-1024x241.jpg 1024w, https://cybergeeks.tech/wp-content/uploads/2020/12/41-300x70.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/41-768x180.jpg 768w, https://cybergeeks.tech/wp-content/uploads/2020/12/41.jpg 1277w" sizes="(max-width: 1277px) 100vw, 1277px" /><figcaption>Figure 41</figcaption></figure></div>



<p>Now the user agent is extracted from the local host by calling the RegQueryValueExA function, as follows:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="908" height="250" src="https://cybergeeks.tech/wp-content/uploads/2020/12/42.jpg" alt="" class="wp-image-565" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/42.jpg 908w, https://cybergeeks.tech/wp-content/uploads/2020/12/42-300x83.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/42-768x211.jpg 768w" sizes="(max-width: 908px) 100vw, 908px" /><figcaption>Figure 42</figcaption></figure></div>



<p>The GetNetworkParams&nbsp;function is utilized to obtain network parameters for the local machine. This information will be exfiltrated as we&#8217;ll see later on:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="904" height="158" src="https://cybergeeks.tech/wp-content/uploads/2020/12/43.jpg" alt="" class="wp-image-566" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/43.jpg 904w, https://cybergeeks.tech/wp-content/uploads/2020/12/43-300x52.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/43-768x134.jpg 768w" sizes="(max-width: 904px) 100vw, 904px" /><figcaption>Figure 43</figcaption></figure></div>



<p>GetComputerNameW&nbsp;and GetUserNameW APIs are used to retrieve the NetBIOS name of the local computer and the name of the user associated with the thread, respectively:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="896" height="281" src="https://cybergeeks.tech/wp-content/uploads/2020/12/44.jpg" alt="" class="wp-image-567" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/44.jpg 896w, https://cybergeeks.tech/wp-content/uploads/2020/12/44-300x94.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/44-768x241.jpg 768w" sizes="(max-width: 896px) 100vw, 896px" /><figcaption>Figure 44</figcaption></figure></div>



<p>gethostname and gethostbyname&nbsp;functions are used to get the standard host name for the local machine and host information corresponding to the local host, respectively:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="898" height="211" src="https://cybergeeks.tech/wp-content/uploads/2020/12/45.jpg" alt="" class="wp-image-568" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/45.jpg 898w, https://cybergeeks.tech/wp-content/uploads/2020/12/45-300x70.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/45-768x180.jpg 768w" sizes="(max-width: 898px) 100vw, 898px" /><figcaption>Figure 45</figcaption></figure></div>



<p>The process verifies the operating system version by calling GetVersionExA function and then it checks if the process is running on a 64-bit machine by calling GetCurrentProcess and IsWow64Process APIs (this information is stored in the buffer along with the hostname and username). The malware retrieves the default locale for the OS by calling GetLocaleInfoA function with the following parameters: 0x800 (LOCALE_SYSTEM_DEFAULT), 0xb (LOCALE_IDEFAULTCODEPAGE). The result is OEMCP 437 for English ( United States ) that is converted to hex and copied in the buffer that will be exfiltrated:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="975" height="195" src="https://cybergeeks.tech/wp-content/uploads/2020/12/46.jpg" alt="" class="wp-image-571" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/46.jpg 975w, https://cybergeeks.tech/wp-content/uploads/2020/12/46-300x60.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/46-768x154.jpg 768w" sizes="(max-width: 975px) 100vw, 975px" /><figcaption>Figure 46</figcaption></figure></div>



<p>There is a call to the GlobalMemoryStatusEx function in order to retrieve information about the physical and virtual memory. The amount of physical memory and the amount of physical memory currently available are saved as 32-bits values to the buffer which will be exfiltrated. Also, the processor name is retrieved using a few cpuid instructions (&#8220;AMD Ryzen 5 3550H with Radeon Vega Mobile Gfx&#8221;) and then copied to the same buffer. The malicious process extracts the width and the height of the screen of the primary monitor (in pixels) via 2 GetSystemMetrics calls, as follows (these are copied to the same buffer as before):</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="933" height="235" src="https://cybergeeks.tech/wp-content/uploads/2020/12/47.jpg" alt="" class="wp-image-572" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/47.jpg 933w, https://cybergeeks.tech/wp-content/uploads/2020/12/47-300x76.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/47-768x193.jpg 768w" sizes="(max-width: 933px) 100vw, 933px" /><figcaption>Figure 47</figcaption></figure></div>



<p>Again 12 random chars are generated via the same algorithm as presented before, and then the following URI is constructed (data=12 random chars): &#8220;/money/ofcom-fines-nuisance-calls?0023528461146965&amp;data=qgvuclxxlgip&#8221;. The function WinHttpOpen is called using the user agent extracted earlier from registry, &#8220;Mozilla/4.0 (compatible; MSIE 8.0; Win32)&#8221;:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="199" src="https://cybergeeks.tech/wp-content/uploads/2020/12/48-1024x199.jpg" alt="" class="wp-image-573" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/48-1024x199.jpg 1024w, https://cybergeeks.tech/wp-content/uploads/2020/12/48-300x58.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/48-768x149.jpg 768w, https://cybergeeks.tech/wp-content/uploads/2020/12/48.jpg 1253w" sizes="(max-width: 1024px) 100vw, 1024px" /><figcaption>Figure 48</figcaption></figure></div>



<p>As before, the file calls the WinHttpSetTimeouts function using the parameters set as 120 seconds, and then it tries to connect to the C2 server (www.microsoft-cache[.]com) on port 443:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="171" src="https://cybergeeks.tech/wp-content/uploads/2020/12/49-1024x171.jpg" alt="" class="wp-image-574" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/49-1024x171.jpg 1024w, https://cybergeeks.tech/wp-content/uploads/2020/12/49-300x50.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/49-768x129.jpg 768w, https://cybergeeks.tech/wp-content/uploads/2020/12/49.jpg 1123w" sizes="(max-width: 1024px) 100vw, 1024px" /><figcaption>Figure 49</figcaption></figure></div>



<p>The process performs a GET request using WinHttpOpenRequest and WinHttpSendRequest APIs:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="180" src="https://cybergeeks.tech/wp-content/uploads/2020/12/50-1024x180.jpg" alt="" class="wp-image-575" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/50-1024x180.jpg 1024w, https://cybergeeks.tech/wp-content/uploads/2020/12/50-300x53.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/50-768x135.jpg 768w, https://cybergeeks.tech/wp-content/uploads/2020/12/50.jpg 1298w" sizes="(max-width: 1024px) 100vw, 1024px" /><figcaption>Figure 50</figcaption></figure></div>



<p>If the request is not successful, the process sleeps for 180 seconds, and then it tries again. The process retrieves header information by calling WinHttpQueryHeaders&nbsp;with 0x16 (WINHTTP_QUERY_RAW_HEADERS_CRLF) parameter:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="796" height="235" src="https://cybergeeks.tech/wp-content/uploads/2020/12/51.jpg" alt="" class="wp-image-576" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/51.jpg 796w, https://cybergeeks.tech/wp-content/uploads/2020/12/51-300x89.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/51-768x227.jpg 768w" sizes="(max-width: 796px) 100vw, 796px" /><figcaption>Figure 51</figcaption></figure></div>



<p>As before, the malware extracts the status code and checks if it&#8217;s equal to 200 by calling WinHttpQueryHeaders API with 0x20000013 (WINHTTP_QUERY_FLAG_NUMBER|WINHTTP_QUERY_STATUS_CODE) parameter:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="796" height="412" src="https://cybergeeks.tech/wp-content/uploads/2020/12/52.jpg" alt="" class="wp-image-577" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/52.jpg 796w, https://cybergeeks.tech/wp-content/uploads/2020/12/52-300x155.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/52-768x398.jpg 768w" sizes="(max-width: 796px) 100vw, 796px" /><figcaption>Figure 52</figcaption></figure></div>



<p>Now there is a call to the WinHttpQueryDataAvailable function, and then it reads the data returned by the C2 server using WinHttpReadData&nbsp;API:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="802" height="181" src="https://cybergeeks.tech/wp-content/uploads/2020/12/53.jpg" alt="" class="wp-image-578" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/53.jpg 802w, https://cybergeeks.tech/wp-content/uploads/2020/12/53-300x68.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/53-768x173.jpg 768w" sizes="(max-width: 802px) 100vw, 802px" /><figcaption>Figure 53</figcaption></figure></div>



<p>The buffer containing the information that will be exfiltrated is XORed byte-by-byte with a one-byte key. The following information belongs to the buffer: the C2 server address, hostname, username, IP address represented as hex values, 01 constant because the process is running on a 64-bit environment, the result of GetLocaleInfoA call (0x1b5 = 437 in our case), the amount of physical memory represented as a 32-bit value, the amount of physical memory currently available&nbsp;represented as a 32-bit value, the processor name, the width of the screen of the primary display monitor represented as a 32-bit value (0x780 = 1920 in our case) and the height of the screen of the primary display monitor represented as a 32-bit value (0x438 = 1080 in our case):</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="661" height="410" src="https://cybergeeks.tech/wp-content/uploads/2020/12/54.jpg" alt="" class="wp-image-581" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/54.jpg 661w, https://cybergeeks.tech/wp-content/uploads/2020/12/54-300x186.jpg 300w" sizes="(max-width: 661px) 100vw, 661px" /><figcaption>Figure 54</figcaption></figure></div>



<p>After the operation is complete, the buffer looks like in the following picture:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="521" height="226" src="https://cybergeeks.tech/wp-content/uploads/2020/12/55.jpg" alt="" class="wp-image-582" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/55.jpg 521w, https://cybergeeks.tech/wp-content/uploads/2020/12/55-300x130.jpg 300w" sizes="(max-width: 521px) 100vw, 521px" /><figcaption>Figure 55</figcaption></figure></div>



<p>The malware developers have written their implementation of the Base64 algorithm rather than relying on Windows APIs. The following picture presents a part of the assembly code corresponding to it:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="374" height="833" src="https://cybergeeks.tech/wp-content/uploads/2020/12/56.jpg" alt="" class="wp-image-583" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/56.jpg 374w, https://cybergeeks.tech/wp-content/uploads/2020/12/56-135x300.jpg 135w" sizes="(max-width: 374px) 100vw, 374px" /><figcaption>Figure 56</figcaption></figure></div>



<p>The encrypted buffer is encoded with the Base64 algorithm:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="521" height="227" src="https://cybergeeks.tech/wp-content/uploads/2020/12/57.jpg" alt="" class="wp-image-584" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/57.jpg 521w, https://cybergeeks.tech/wp-content/uploads/2020/12/57-300x131.jpg 300w" sizes="(max-width: 521px) 100vw, 521px" /><figcaption>Figure 57</figcaption></figure></div>



<p>As before, there is a WinHttpOpen API call (same user agent as the last time) followed by a WinHttpSetTimeouts function call, and then it tries to connect to www.microsoft-cache[.]com on port 443 using WinHttpConnect API. The malware performs a POST request by calling the WinHttpOpenRequest function (as before, the data parameter contains randomly-generated characters):</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="195" src="https://cybergeeks.tech/wp-content/uploads/2020/12/58-1024x195.jpg" alt="" class="wp-image-585" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/58-1024x195.jpg 1024w, https://cybergeeks.tech/wp-content/uploads/2020/12/58-300x57.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/58-768x146.jpg 768w, https://cybergeeks.tech/wp-content/uploads/2020/12/58.jpg 1203w" sizes="(max-width: 1024px) 100vw, 1024px" /><figcaption>Figure 58</figcaption></figure></div>



<p>The encrypted + encoded buffer is exfiltrated to the C2 server via a WinHttpWriteData function call, as shown below:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="732" height="390" src="https://cybergeeks.tech/wp-content/uploads/2020/12/59.jpg" alt="" class="wp-image-586" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/59.jpg 732w, https://cybergeeks.tech/wp-content/uploads/2020/12/59-300x160.jpg 300w" sizes="(max-width: 732px) 100vw, 732px" /><figcaption>Figure 59</figcaption></figure></div>



<p>The malicious process performs 2 WinHttpQueryHeaders function calls: 1st one has 0x16 (WINHTTP_QUERY_RAW_HEADERS_CRLF) parameter and the 2nd one has 0x20000013 (WINHTTP_QUERY_FLAG_NUMBER|WINHTTP_QUERY_STATUS_CODE) parameter. It checks out the status code and ensures that it&#8217;s 200. The thread continues by calling WinHttpQueryDataAvailable and WinHttpReadData APIs to retrieve the server&#8217;s response. The malware performs another GET request to the C2 server:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="215" src="https://cybergeeks.tech/wp-content/uploads/2020/12/60-1024x215.jpg" alt="" class="wp-image-588" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/60-1024x215.jpg 1024w, https://cybergeeks.tech/wp-content/uploads/2020/12/60-300x63.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/60-768x161.jpg 768w, https://cybergeeks.tech/wp-content/uploads/2020/12/60.jpg 1112w" sizes="(max-width: 1024px) 100vw, 1024px" /><figcaption>Figure 60</figcaption></figure></div>



<p>The same steps as before are repeated one more time: 2 WinHttpQueryHeaders calls followed by WinHttpQueryDataAvailable and then WinHttpReadData in order to read the data sent by the server. As mentioned in the Unit42 article at <a href="https://unit42.paloaltonetworks.com/new-attacks-linked-to-c0d0s0-group/">https://unit42.paloaltonetworks.com/new-attacks-linked-to-c0d0s0-group/</a>, the server&#8217;s response should contain a &#8220;background-color&#8221; parameter followed by &#8220;#&#8221; and an offset. The offset is read, converted to an integer using the atoi function, and then divided by 100, as shown in figure 61:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="403" height="347" src="https://cybergeeks.tech/wp-content/uploads/2020/12/61.jpg" alt="" class="wp-image-590" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/61.jpg 403w, https://cybergeeks.tech/wp-content/uploads/2020/12/61-300x258.jpg 300w" sizes="(max-width: 403px) 100vw, 403px" /><figcaption>Figure 61</figcaption></figure></div>



<p>The idea is that the malware reads the data found at the position equal to offset/100. In our case, we&#8217;ve modified the response to contain &#8220;#28300&#8221; which translates to an offset of 28300 (the position will be 28300/100 = 283). The following picture reveals the fact that the process reads the data found at that specific position (0x11b = 283):</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="601" height="548" src="https://cybergeeks.tech/wp-content/uploads/2020/12/62.jpg" alt="" class="wp-image-591" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/62.jpg 601w, https://cybergeeks.tech/wp-content/uploads/2020/12/62-300x274.jpg 300w" sizes="(max-width: 601px) 100vw, 601px" /><figcaption>Figure 62</figcaption></figure></div>



<p>According to the same article, the first 4 bytes represent the total length, and the remaining data would be Base64-encoded. Indeed we were able to identify the function where the server&#8217;s response is Base64-decoded:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="688" height="564" src="https://cybergeeks.tech/wp-content/uploads/2020/12/63.jpg" alt="" class="wp-image-592" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/63.jpg 688w, https://cybergeeks.tech/wp-content/uploads/2020/12/63-300x246.jpg 300w" sizes="(max-width: 688px) 100vw, 688px" /><figcaption>Figure 63</figcaption></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="441" height="615" src="https://cybergeeks.tech/wp-content/uploads/2020/12/64.jpg" alt="" class="wp-image-593" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/64.jpg 441w, https://cybergeeks.tech/wp-content/uploads/2020/12/64-215x300.jpg 215w" sizes="(max-width: 441px) 100vw, 441px" /><figcaption>Figure 64</figcaption></figure></div>



<p>At the time of analysis, no live response has been provided by the C2 server. According to the Unit42 article, the server would respond with a DLL file with 4 exports: StartWorker, StopWorker, WorkerRun and DllEntryPoint. Even if we didn&#8217;t receive a valid response from the server, we were able to find out that the malicious process allocates a new memory area in order to write the DLL code inside:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="524" height="431" src="https://cybergeeks.tech/wp-content/uploads/2020/12/65.jpg" alt="" class="wp-image-594" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/65.jpg 524w, https://cybergeeks.tech/wp-content/uploads/2020/12/65-300x247.jpg 300w" sizes="(max-width: 524px) 100vw, 524px" /><figcaption>Figure 65</figcaption></figure></div>



<p>The new area of memory has to be executable because the potential DLL has to run, and that&#8217;s why the malware uses VirtualProtect in order to change the protection of the area:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="809" height="186" src="https://cybergeeks.tech/wp-content/uploads/2020/12/66.jpg" alt="" class="wp-image-595" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/66.jpg 809w, https://cybergeeks.tech/wp-content/uploads/2020/12/66-300x69.jpg 300w, https://cybergeeks.tech/wp-content/uploads/2020/12/66-768x177.jpg 768w" sizes="(max-width: 809px) 100vw, 809px" /><figcaption>Figure 66</figcaption></figure></div>



<p>After the malicious code would be written in the new memory location, the process would pass the execution flow to the new DLL file, as shown in the figure below:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="478" height="174" src="https://cybergeeks.tech/wp-content/uploads/2020/12/67-2.jpg" alt="" class="wp-image-598" srcset="https://cybergeeks.tech/wp-content/uploads/2020/12/67-2.jpg 478w, https://cybergeeks.tech/wp-content/uploads/2020/12/67-2-300x109.jpg 300w" sizes="(max-width: 478px) 100vw, 478px" /><figcaption>Figure 67</figcaption></figure></div>



<p style="font-size:25px">References</p>



<p>Unit42 report: <a href="https://unit42.paloaltonetworks.com/new-attacks-linked-to-c0d0s0-group/">https://unit42.paloaltonetworks.com/new-attacks-linked-to-c0d0s0-group/</a></p>



<p>VirusTotal link: <a href="https://www.virustotal.com/gui/file/de33dfce8143f9f929abda910632f7536ffa809603ec027a4193d5e57880b292/detection">https://www.virustotal.com/gui/file/de33dfce8143f9f929abda910632f7536ffa809603ec027a4193d5e57880b292/detection</a></p>



<p>MSDN:&nbsp;<a href="https://docs.microsoft.com/en-us/windows/win32/api/">https://docs.microsoft.com/en-us/windows/win32/api/</a></p>



<p>Fakenet: <a href="https://github.com/fireeye/flare-fakenet-ng">https://github.com/fireeye/flare-fakenet-ng</a></p>



<p>FireEye: <a href="https://www.fireeye.com/current-threats/apt-groups.html#apt19">https://www.fireeye.com/current-threats/apt-groups.html#apt19</a></p>



<p style="font-size:25px">INDICATORS OF COMPROMISE</p>



<p>C2 domain: www.microsoft-cache[.]com</p>



<p>C2 IP address: 106.185.43.96</p>



<p>SHA256: DE33DFCE8143F9F929ABDA910632F7536FFA809603EC027A4193D5E57880B292</p>



<p>URLs: 106.185.43.96/user/atv.html</p>



<p>www.microsoft-cache[.]com:443/money/ofcom-fines-nuisance-calls?0023528460592137&amp;data=&lt;12 random chars&gt;</p>



<p>www.microsoft-cache[.]com:443/world/video/shrien-dewani-arrives-uk-murder-trial-collapses-video?0023528461146965&amp;data=&lt;12 random chars&gt;</p>



<p>www.microsoft-cache[.]com:443/lifeandstyle/marmalade-paddington-sales-up-making-drinking?0023528460592137&amp;data=&lt;12 random chars&gt;</p>



<p style="font-size:25px">Yara rules for detecting the threat</p>



<pre class="wp-block-code"><code>rule APT19_1 {
    meta:
        author = "CyberMasterV"
	Date = "2020-12-26"

    strings:
	$s1 = "http://www.google.com" wide ascii
	$s2 = "Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_2; en-US) AppleWebKit/533.3 (KHTML, like Gecko) Chrome/5.0.354.0 Safari/533.3" wide ascii
	$s3 = "%s?%016I64d&amp;data=%s"
	$s4 = "DebugCreate"
	$s5 = "DebugConnect"
    condition:
	4 of them
}</code></pre>



<pre class="wp-block-code"><code>rule APT19_2 {
    meta:
        author = "CyberMasterV"
        Date = "2020-12-26"
		
    strings:
        $s1 = "DbgEng.Dll" wide ascii
        $s2 = "Windows Helper Service"
        $s3 = "WinHelpSrv"
	$s4 = "KBKBKBKBKBKB"
    condition:
        3 of them
}</code></pre>

		
		
			</div><!-- .entry-content .clear -->
</div>

	
</article><!-- #post-## -->


	        <nav class="navigation post-navigation" role="navigation" aria-label="Post navigation">
	                <span class="screen-reader-text">Post navigation</span>
	                <div class="nav-links"><div class="nav-previous"><a title="Dissecting APT21 samples using a step-by-step approach"href="https://cybergeeks.tech/dissecting-apt21-samples-using-a-step-by-step-approach/" rel="prev"><span class="ast-left-arrow">&larr;</span> Previous Post</a></div><div class="nav-next"><a title="A detailed analysis of ELMER Backdoor used by APT16"href="https://cybergeeks.tech/a-detailed-analysis-of-elmer-backdoor-used-by-apt16/" rel="next">Next Post <span class="ast-right-arrow">&rarr;</span></a></div></div>
	        </nav>			</main><!-- #main -->
			
		
	</div><!-- #primary -->


	<div class="widget-area secondary" id="secondary" itemtype="https://schema.org/WPSideBar" itemscope="itemscope">
	<div class="sidebar-main" >
		
		<aside id="search-3" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://cybergeeks.tech/">
	<label>
		<span class="screen-reader-text">Search for:</span>
		<input type="search" class="search-field"  placeholder="Search..." value="" name="s" tabindex="-1">
			</label>
			<input type="submit" class="search-submit" value="Search">
	</form>
</aside>
		<aside id="recent-posts-3" class="widget widget_recent_entries">
		<h2 class="widget-title">Recent Posts</h2><nav aria-label="Recent Posts">
		<ul>
											<li>
					<a href="https://cybergeeks.tech/attackers-target-romania-using-ai-generated-videos/">Attackers target Romania using AI-generated videos</a>
									</li>
											<li>
					<a href="https://cybergeeks.tech/attackers-impersonate-romanian-gas-companies-osint-investigation/">Attackers impersonate Romanian Gas Companies &#8211; OSINT Investigation</a>
									</li>
											<li>
					<a href="https://cybergeeks.tech/a-deep-dive-into-brute-ratel-c4-payloads-part-2/">A Deep Dive into Brute Ratel C4 payloads &#8211; Part 2</a>
									</li>
											<li>
					<a href="https://cybergeeks.tech/a-deep-dive-into-brute-ratel-c4-payloads/">A Deep Dive into Brute Ratel C4 payloads</a>
									</li>
											<li>
					<a href="https://cybergeeks.tech/a-technical-analysis-of-the-saltwater-backdoor-used-in-barracuda-0-day-vulnerability-cve-2023-2868-exploitation/">A technical analysis of the SALTWATER backdoor used in Barracuda 0-day vulnerability (CVE-2023-2868) exploitation</a>
									</li>
					</ul>

		</nav></aside><aside id="archives-3" class="widget widget_archive"><h2 class="widget-title">Archives</h2><nav aria-label="Archives">
			<ul>
					<li><a href='https://cybergeeks.tech/2024/01/'>January 2024</a></li>
	<li><a href='https://cybergeeks.tech/2023/11/'>November 2023</a></li>
	<li><a href='https://cybergeeks.tech/2023/09/'>September 2023</a></li>
	<li><a href='https://cybergeeks.tech/2023/08/'>August 2023</a></li>
	<li><a href='https://cybergeeks.tech/2023/06/'>June 2023</a></li>
	<li><a href='https://cybergeeks.tech/2023/01/'>January 2023</a></li>
	<li><a href='https://cybergeeks.tech/2022/10/'>October 2022</a></li>
	<li><a href='https://cybergeeks.tech/2022/09/'>September 2022</a></li>
	<li><a href='https://cybergeeks.tech/2022/08/'>August 2022</a></li>
	<li><a href='https://cybergeeks.tech/2022/07/'>July 2022</a></li>
	<li><a href='https://cybergeeks.tech/2022/06/'>June 2022</a></li>
	<li><a href='https://cybergeeks.tech/2022/04/'>April 2022</a></li>
	<li><a href='https://cybergeeks.tech/2022/03/'>March 2022</a></li>
	<li><a href='https://cybergeeks.tech/2022/02/'>February 2022</a></li>
	<li><a href='https://cybergeeks.tech/2022/01/'>January 2022</a></li>
	<li><a href='https://cybergeeks.tech/2021/11/'>November 2021</a></li>
	<li><a href='https://cybergeeks.tech/2021/10/'>October 2021</a></li>
	<li><a href='https://cybergeeks.tech/2021/09/'>September 2021</a></li>
	<li><a href='https://cybergeeks.tech/2021/08/'>August 2021</a></li>
	<li><a href='https://cybergeeks.tech/2021/07/'>July 2021</a></li>
	<li><a href='https://cybergeeks.tech/2021/06/'>June 2021</a></li>
	<li><a href='https://cybergeeks.tech/2021/02/'>February 2021</a></li>
	<li><a href='https://cybergeeks.tech/2021/01/'>January 2021</a></li>
	<li><a href='https://cybergeeks.tech/2020/12/'>December 2020</a></li>
	<li><a href='https://cybergeeks.tech/2020/11/'>November 2020</a></li>
	<li><a href='https://cybergeeks.tech/2020/08/'>August 2020</a></li>
	<li><a href='https://cybergeeks.tech/2020/07/'>July 2020</a></li>
			</ul>

			</nav></aside><aside id="categories-3" class="widget widget_categories"><h2 class="widget-title">Categories</h2><nav aria-label="Categories">
			<ul>
					<li class="cat-item cat-item-7"><a href="https://cybergeeks.tech/category/binary-exploitation/">Binary exploitation</a>
</li>
	<li class="cat-item cat-item-2"><a href="https://cybergeeks.tech/category/malwareanalysis/">Malware analysis</a>
</li>
	<li class="cat-item cat-item-9"><a href="https://cybergeeks.tech/category/osint/">OSINT</a>
</li>
	<li class="cat-item cat-item-4"><a href="https://cybergeeks.tech/category/rants/">Rants</a>
</li>
			</ul>

			</nav></aside>
	</div><!-- .sidebar-main -->
</div><!-- #secondary -->


	</div> <!-- ast-container -->
	</div><!-- #content -->

		<footer
		class="site-footer" id="colophon" itemtype="https://schema.org/WPFooter" itemscope="itemscope" itemid="#colophon"		>

			
			
			
		</footer><!-- #colophon -->
			</div><!-- #page -->
<!-- Matomo --><script>
var _paq = window._paq = window._paq || [];
_paq.push(['trackPageView']);_paq.push(['enableLinkTracking']);_paq.push(['alwaysUseSendBeacon']);_paq.push(['setTrackerUrl', "\/\/cybergeeks.tech\/wp-content\/plugins\/matomo\/app\/matomo.php"]);_paq.push(['setSiteId', '1']);var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
g.type='text/javascript'; g.async=true; g.src="\/\/cybergeeks.tech\/wp-content\/uploads\/matomo\/matomo.js"; s.parentNode.insertBefore(g,s);
</script>
<!-- End Matomo Code --><script id="astra-theme-js-js-extra">
var astra = {"break_point":"921","isRtl":"","is_scroll_to_id":"","is_scroll_to_top":"","is_header_footer_builder_active":""};
</script>
<script src="https://cybergeeks.tech/wp-content/themes/astra/assets/js/minified/style.min.js?ver=4.6.3" id="astra-theme-js-js"></script>
<script id="ppress-frontend-script-js-extra">
var pp_ajax_form = {"ajaxurl":"https:\/\/cybergeeks.tech\/wp-admin\/admin-ajax.php","confirm_delete":"Are you sure?","deleting_text":"Deleting...","deleting_error":"An error occurred. Please try again.","nonce":"313378e565","disable_ajax_form":"false","is_checkout":"0","is_checkout_tax_enabled":"0"};
</script>
<script src="https://cybergeeks.tech/wp-content/plugins/wp-user-avatar/assets/js/frontend.min.js?ver=4.14.2" id="ppress-frontend-script-js"></script>
<script src="https://cybergeeks.tech/wp-includes/js/dist/vendor/wp-polyfill-inert.min.js?ver=3.1.2" id="wp-polyfill-inert-js"></script>
<script src="https://cybergeeks.tech/wp-includes/js/dist/vendor/regenerator-runtime.min.js?ver=0.14.0" id="regenerator-runtime-js"></script>
<script src="https://cybergeeks.tech/wp-includes/js/dist/vendor/wp-polyfill.min.js?ver=3.15.0" id="wp-polyfill-js"></script>
<script src="https://cybergeeks.tech/wp-includes/js/dist/dom-ready.min.js?ver=392bdd43726760d1f3ca" id="wp-dom-ready-js"></script>
<script id="starter-templates-zip-preview-js-extra">
var starter_templates_zip_preview = {"AstColorPaletteVarPrefix":"--ast-global-color-","AstEleColorPaletteVarPrefix":["ast-global-color-0","ast-global-color-1","ast-global-color-2","ast-global-color-3","ast-global-color-4","ast-global-color-5","ast-global-color-6","ast-global-color-7","ast-global-color-8"]};
</script>
<script src="https://cybergeeks.tech/wp-content/plugins/astra-sites/inc/lib/onboarding/assets/dist/template-preview/main.js?ver=06758d4d807d9d22c6ea" id="starter-templates-zip-preview-js"></script>
			<script>
			/(trident|msie)/i.test(navigator.userAgent)&&document.getElementById&&window.addEventListener&&window.addEventListener("hashchange",function(){var t,e=location.hash.substring(1);/^[A-z0-9_-]+$/.test(e)&&(t=document.getElementById(e))&&(/^(?:a|select|input|button|textarea)$/i.test(t.tagName)||(t.tabIndex=-1),t.focus())},!1);
			</script>
				</body>
</html>
