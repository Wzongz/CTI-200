Researchers with Symantec have uncovered a malicious threat actor group called Leafminer, which is based in Iran and has been active since at least 2017. Since last year, the group has targeted hundreds of organizations, including government, finance and energy in the Middle East, according to the July 25 report. In their report, Symantec researchers found that the group will adapt publicly available techniques and tools for their attacks and experiments, as well as publishing proof-of-concept exploits. The group has attempted to infiltrate target networks by water holing websites, creating vulnerability scans of network services on the Internet and using brute-force and dictionary login attempts. The group seems to be looking for email data, files and database servers on the target systems, according to Symantec. Symantec detection telemetry showed malware, as well as the custom tools used by Leafminer, distributed through 44 different systems across Saudi Arabia, Kuwait, Israel and Lebanon.A list of 809 vulnerability scan targets was also found. The targets were in Saudi Arabia, United Arab Emirates, Qatar, Kuwait, Bahrain, Egypt, Israel and Afghanistan. Obfuscated JavaScript code was also seen on compromised servers that were affected by a watering hole attack conducted by the group, which used a Lebanese government site, a Saudi Arabian healthcare site and an Azerbaijan university as the platforms. The code was designed to steal Samba networking protocol (SMB) credential hashes that could subsequently be brute-forced offline. The threat actor is not afraid to mimic other successful techniques as well. The group uses the EternalBlue vulnerability, which was leaked by the Shadow Brokers, to laterally move within networks that they have breached. The group also uses a Python script to scan for Heartbleed, a well-known OpenSSL vulnerability, in an attempt to get at encrypted data. Leafminer does have their own custom tools, however. Symantec did identity two strains of custom malware that were used: Trojan.Imecab and Backdoor.Sorgu. Directly connected to this malware are several sets of reflective loader DLLs that are used as droppers or to execute specific commands on a compromised system. Interestingly, these custom tools required Leafminer to load the .NET framework onto a compromised machines in order to allow them to run. Backdoor.Sorgu provides remote access to the infected machine. It is installed as a service in a Windows system through a shell command script. Zero in on the most attractive 5G NR deployment strategies, and take a look ahead to later technology developments and service innovations. Join us for the Deployment Strategies for 5G NR breakfast workshop in LA at MWCA on September 12. Register now to learn from and network with industry experts – communications service providers get in free! Trojan.Imecab sets up a persistent remote access account on the victim machine that has a hardcoded password. It installs itself in the system as a Windows service to achieve persistence. File exfiltration borrows a technique that was revealed at Black Hat Europe 2017 during a presentation called "Lost in Transaction: Process Doppelgänging." It uses NTFS transactions to modify the executable of a seemingly benign process that is suspended right after creation. All this borrowing from other attackers has led Symantec researchers to conclude that group is likely still active, but the people running it are also inexperienced. "Leafminer's eagerness to learn from others suggests some inexperience on the part of the attackers, a conclusion that's supported by the group's poor operational security," according to Symantec's research. "It made a major blunder in leaving a staging server publicly accessible, exposing the group's entire arsenal of tools." This suggests Leafminer is not state-backed, but more a criminal operation with a Middle Eastern focus.