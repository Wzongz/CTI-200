Charming Kitten, also known as APT35 or Ajax, is an Iranian cyberespionage group active since 20141 . Their primary targets are Iranian experts working in the Academy, human rights activists and media personnel. Most victims are in the Middle East, US and the UK. Below here is a key event timeline: Despite the considerable unrest in the Iranian cyber sphere, it appears that similarly to the MuddyWater APT, Charming Kitten were unaffected4 . In August, the campaign has progressed, and unlike July, it seems like the APT group is now expanding its activities toward influential public figures around the world, rather than academic researchers an state organizations. Additionally, in August 2019, we found that the group had begun adding a tracker to their email correspondences, enabling them to follow an email message forwarded to additional accounts and obtain geolocation information.Analyzing this campaign, we identified two attack scenarios. Based on our investigation, Charming Kitten tried to carry out both of the attack scenarios against the same victims. Note however that in most cases, the attack begun with the first scenario.While impersonating to research institution, the attackers try to contact the victims privately and encourage them to review their resume (CV). In order to do so, linked within the email is a unique URL address for the fake website (Please notice the spelling and grammatical error, most notably the mispronunciation of the Sender name. Instead of Andrea, as written in the email address, the attacker mistakenly wrote Andera):As this link is not malicious, we believe that it is currently used only as the first stage in the attack - gaining the trust of the victims. The website contains the exact page from the original website on which it is based, with one single change – the sender’s email address embedded within the website content.Same as the original website, the email is embedded in the webpage content with a javascript code encoded in decimal. The attackers changed the last 22 numbers – from isis-online[.]org to the fake email address isis-online[.]net, as seen below: In this scenario, the attackers impersonate a known journalist. Unlike the first format, the latter does not contain any link to a fake website. The attacker offers the victim to participate in an online meeting about Iran and other subjects of interest for the target (e.g.recent discourse between Iran and the US). After presenting himself and the subject of the meeting, the attacker would ask whether the victim is interested in participating. If so, they are requested to replay in order to receive the following details:We identified on the website URLScan a few scans of a link from the website of Deutcshe Welle, a Germany-based international news portal. As presented in the following image, the victims were redirected to the website from malicious domains of the group (which can be found on the ClearSky Twitter account6 ). One of the domains is dw[.]de – a decoy domain which was mentioned in the previous email.This link was scanned via URLScan by an anonymous user less than a month days ago, which might reveal another attack by Charming Kitten7 . A second wave of attacks using the same vector took place in August. The attackers sent multiple email messages in a single night to multiple potential victims, impersonating a woman called Samantha Vinograd from who works at CNN. Similarly to the previous attack wave, the email message distributed to the victims contained multiple spelling mistakes, especially in the names of the reporters the attackers impersonated. For example, in the email address used to send the decoy emails is the last name of the reporter is misspelled. Below here is the phishing email’s content:An analysis of the email’s headers reveals that the attackers planted an email tracker within the message. The tracker can be seen below:The tracker is used by the attackers to check whether the message is forwarded to additional recipients, and to obtain the geolocation and IP address of the victim. Data is collected via a cookie that is installed on the victim machine in the following route: We Identified more than six unique servers hosting the fake Charming Kitten websites. Of which, four impersonate entities as part of the first stage, while the other two host servers impersonating Google services. We asses that these are likely to be used as in second stage of the attack – data theft. After a month of campaign operations, The attackers switched the servers used to store the email addresses, containing thousands of addresses.It should be noted that these domains can only be accessed via the aforementioned link in the spearphishing email. In any other case, the server will redirect the client to the original website (HTTP 302 in port 442 or 301 in port 80). The following image presents the headers of 185.141.63[.]160 from Shodan9 . The fake domain is unirsd[.]com, however, it redirects to the original website.All of the servers used in the latest attack are hosted by BelCloud Hosting Corporation, located in Bulgaria (ISP Kiwi Technologies Ltd.). Older servers in the campaign, such as 46.21.150[.]197, are hosted by other hosting services. As presented in the last image, all servers are Apache/2.4.39 (Win64), using OpenSSL/1.1.1b and PHP versions 7.3.5 or 7.3.6.Searching other servers with these unique parameters returned less than 300 results. Most of these results are not malicious. We ruled out the legitimate servers that pointed in their redirect to the same IP address or to a domain the server hosts. Within these servers, we identified one server that redirects to Google services, which concurrently hosts two Iranians Name Servers. We consider this server to be part of this campaign in medium-high level of confidence:First and foremost, it should be noted that the Iranian cyber divisions use servers belonging to Hetzner Online GmbH in many of their operations10. Second, there is an overlap of the server version, the SSL version, the PHP version and even the serial number of the SSL certificate.In March 2019, ClearSky identified another attack as part of this campaign, using an email address pointing to jewishjournal[.]online. From the Passive DNS records of this domain, we identified another domain impersonating Deutsche Welle – deutcshewelle[.]netApart from the above reasons, additional information also ties the group’s activity to Iran. One the NetBlock of the IP addresses of the original servers we found the website exnovin[.]org. ExNovin is an Iranian company that developed a platform for money exchange. The domain was previously hosted on Hetzner, a German Internet hosting company. We estimate that these factors are likely related to the Charming Kitten group.