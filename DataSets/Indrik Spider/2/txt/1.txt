Exploring the current globaltrend of increasing threat actors'sophistication, Cybernt researchershave been tracking various activities following the spear-phishingcampaign targeting large US-basedretailers detected in December 2018.The research focused on scenarioswith the same tactics, techniquesand procedures (TTP) along withthe repeated nefarious use of alegitimate' remote administrationtool Remote Manipulator System(RMS), developed by a Russian-based company TektonlT'. Based on this continued analysis, an additional campaigntargeting financial institutions in Chile, India, ltaly, Malawi.Pakistan and South Korea was identified as previouslyconducted during December 2018. Given the use ofspecific malware, it is with high certainty attributed tothe financially-motivated threat actor group TA505 Whilst TA505 are almost certainly responsible for severaof these recent campaigns, broader analysis of the ITP employed indicates that multiple threat actors are conducting similar operations against a variety of victims.especially with the use of RMS. Whilst sophisticated and organized cybercriminal threat actors, such as TA505 are successfully conducting large scale campaigns against high-value targets using these tried-and-tested TTP, Russian-language forum discussions and tutorials provide detail to unsophisticated and disparate threat actors that could enable them to package and deliver the same threats As such, numerous recent campaigns observed as deploying the RMS tool cannot all be attributed to the same threat actor and may be serving a variety of objectives. Organized cybercriminal groups, and many less organized threat actors, utilising these TTPs are likely financially motivated, seeking access to systems from which valuable data can be stolen or on which they can perform fraudulent fnancial transactions In order to achieve these goals, threat actors appear to be utilising remote administration tools to directhy perform this activity as well as leveraging the tool's capabilities to conduct reconnaissance and lateral moverment within a victim network. Given the capabilities of the remote administration tool and the accessibility of inforation on how to conduct malicious operations, 1one-wolf threat actors and groups with differing objectives or motivations may be utilising the same toolsets and TTPs for general malevolence or mischief. Tried and tested attack patterns appear to be consistent across these recently observed cammpaians and commence with the delivery of phishing emails that have ure document attachments. Utilising legitimate logos. language and terminology consistent with common business interactions or the target organization, the email encourages the potential victim to open the lure document attachment which in turn instructs them todisable security controls within Microsoft Office to allowa nefarious macro to be executed. The macro, if executed, subsequently attempts todownload malicious payloads from the threat actor's C2infrastructure that in most cases also masquerades as, ormimics, legitimate-looking domains such as using namesand misspellings related to "Cloud,, "Microsoft Office 365or "Security Typically, the initial payload will be a more robustmalware downloader that is used to gather furthercomponents including a remote access trojan (RAT).in mamy cases the legitimate remote administrationtool RMS', as well as supporting shell scripts (BAT) andconfig uration files. Given continued activity sharing the same or similarITP, this report provides an oerview of the recentobservations along with detailing the capabilities ofthe legitimate remote administration tool RMs' andassociated indicators of compromise (l0C). Following the decline in the popularity ofransomware, likely due to mitigation tacticsemployed by organizations and victims lackingconfidence in data restoration followingpayment, TA505 were observed as returning totried and tested payloads such as informationstealing backdoors and remote access trojans(RAT) that are delivered using downloaders andweaponised Microsoft Offce files.Subsequently TA505 were observed inNovember 2018 as deploying a threat known as'ServHelper' of which there are reported twovariants, one which provides remote desktopcapabilities via a reverse-SSH tunnel and another which primarily acts as a downloader, presumablyto allow additional malicious payloads to beinstalled on the victim system.Notably, recent TA505 attributed campaignsinclude the use of the Remote ManipulatorSystem' (RMS), an off-the-shelf commercialremote administration tool, as observed in theDecember 2018 campaigns against US-basedretailers as well as targeting the financial industrybetween December 2018 and February 2019Furthermore, indicators of compromiseidentifed in this US retail campaign areconsistent with an attack against the NotaryChamber of Ukraine (HotapianbHa nanataYkpaihw), also during December 2018. Whilstthe cryptographic hashes and payload filenamesdeployed in both December 2018 campaignswere identical, the Ukrainian attacks cannotnecessarily be attributed to TA505 as othergroups may be utilising similar TTP along withthe commercial tool.in mid-December 2018 a spear-phishing campaign was detected as targeting large US-based retailers alowith organizations in the food and beverage industry. Masquerading as a legitimate communication sentfrom a Ricoh printer, the initial email lured victims into opening an attached malicious Microsoft Word document. The remote payload to install is specifed by passing the URL to the '/i' command line option whilst thequiet 7g' option ensures that the installation is performed in the background without displaying userinterface (U) elements to the victim. Additionally, three variables are provided, 'step, 'done' and 'changethat, along with their corresponding values, would be passed to the installation package to infiluence ormodify the installation Presumably to thwart detection or casual analysis, the VBA macro code has some code obfuscation withclass and module attributes being used to store values (Figure 3) that are later referenced (Figure 4).Potentially remaining from previous versions of this VBA macro, artefacts include code comments thatappear to be variable assignments referencing Templscype0, a potential file path and misspeling of "Skype(Figure 5), as well as a seemingly unreferenced iP logging service hxxps://iplogger.org/6vfgp that provideslogs detail of any lP address accessing the URL (Figure 6).The use of this lP logging service provides auseful insight into those that have executed theweaponised document with details of the visitor'sor more aptly victim's, IP address, operating system,browser and geolocation being available to thethreat actor through a statistics page accessible viaa specific link combined with their IPLogger ID.Having dropped a binary file to disk,"%SystemRoot%\installer'msi2adctmp, the RAT executable'exit.exe', self-extracting archive 'syst.dl' and shell script icmd' are extracted to the "%TEMP%directory. Subsequently, 'exitexe' is launched and spawns the command-line interpreter 'cmd.exe'which in turn executes the i.cmd' shell script (Figure 8).The use of the ping command (lines 2 and 4) sendsthree echo requests to the legitimate domain'cloudflare.com' with the timeout value set to3,000 milliseconds, and potentially acts as botha connectivity test and a pause between steps.Assuming the ping process exits without error,indicated by the %ERRORLEVEL%' not being equalto one, the dropped self-extracting archive file 'systdll' is first renamed as 7zinstall.exe' (line 3) and thenexecuted (line 5). The self-extracting archive is extracted, as specifiedby the 'x' option, using the password provided afterthe '-p' switch whilst the -y switch suppresses anypotential user interaction by assuming 'yes' to anyquery or prompt. Remote Manipulator System (RMS).Having extracted the contents of the selfextracting archive to %%PROGRAMDATA%Microtik, a second copy of the 'exit.exe' file ispresent along with a legitimate signed RemoteManipulator System (RMS) executable 'winserv.exe', RMS configuration file 'settings.dat' and adifferent i.cmd' shell script.The final stage of the self-extraction processlaunches 'exitexe' (Figure 9) which in turn spawnsanother commandine interpreter cmd.exe' toexecute the new i.cmd' shell script (Figure 10). Additionally, the RMS executable is launched (line 3) before the script tries to forcefully kill the'rundll32.exe' process, causing the script to go into a loop.Finally, the RMS executable attempts to 'call home' with connection attempts being observed, atthe time, to "89.144.25.32' on port 5655â€™, a C2 server located in Germany.Pivoting on the indicators observed in this campaign identify additional malicious samples andassociated C2 domains/1P addresses that, in addition to identifying a pattern of activity, link thisobserved activity to TA505 operations utilising the "ServHelper' backdoor. Unlike the US-based retail campaign, the spreadsheet lure does not contain VBA macros andinstead spawns a Microsoft Windows lnstaller process (Figure 18) to download an additionapayload from the threat actor's command and control (C2) infrastructure. Unlike the Us-based retail campaign, the spreadsheet lure does not contain VBA macros andinstead spawns a Microsoft Windows installer process (Figure 18) to download an additionapayload from the threat actor's command and control (C2) infrastructure. This behaviour is consistent with other TA505 campaigns utilising a combination of weaponisedMicrosoft Office files containing either VBA macros or exploit code to spawn additional processes.Of the spreadsheet lures analysed in this campaign, four different C2 servers and payloads wereidentifed, with each likely being unique to a specifc target organization or victim cluster (Figure 19). in addition to specifying the remote package to install, using the /i' command line option, the quiet 7g'option ensures that the installation is performed in the background without displaying any user interface(u) elements to the victim. Additionally, variables are passed to the installation package with 'OnLoad' beingpresent in all cases along with either 'serf and 'done' or 'val' and 'rdp' Whilst the nature of these variableshas not been determined, they may influence or modify the installation of the specified MSI file.in addition to specifying the remote package to install, using the i' command line option, the quiet a'option ensures that the installation is performed in the background without displaying any user interface(U) elements to the victim.Additionally, variables are passed to the installation package with 'OnLoad' beingpresent in all cases along with either 'serf and 'done' or 'val' and 'rdp'. Whilst the nature of these variableshas not been determined, they may influence or modify the installation of the specified MSI file.The C2 domains observed in this campaignshare a common Microsoft Office 365' theme,presumably in an attempt to thwart casualanalysis by appearing legitimate to the untrained eye. Given this theme, pivots on DNSWhois data can be used to identify additionalpotential infrastructure and are provided inAppendix A for referenceã€‚Having downloaded and installed the MSl installationpackage, an executable is dropped that spawns numerousprocesses and commences the installation of "ServHelper.a threat reportedly developed using Delphi' and firstidentified in November 2018.Upon execution, further confirmation that the threat wasdeveloped using the Delphi integrated developmentenvironment (1DE) is gained through attempts to accessthe following legitimate registry keys:Whilst these registry keys are not in themselves an indicator of compromise(l0C), attempts to access them in environments not using Delphi-developedapplications may be of interest Having created the file that resulted in the threat's name, "%SYSTEMROOT%\ServHelper.dllr, the process checks for the presence of the Terminal Services'service and changes the configuration, if necessary, to ensure that the service isstarted automatically during system start-up (dwStartType=0x2) (Figure 20).Also observed in December 2018, the same TTP, including RMS' being deployed, were used in an attackagainst the Notary Chamber of Ukraine (Hotapianbha nanata ykpaihw).In this instance, the initial email spear-phishing campaign mimicked the Shevchenkivsky District Court ofKyiv (UlebyeHkiecbkni paoHHm cyA Mica Kncea) regarding a notary issue and encouraged the victimto open the weaponised Microsoft Word document attachment (Figure 28).Remote Manipulator System (RMS) is a legitimate remote administration tool developed by a Russianorganization TektonlT' and has been observed in campaigns conducted by TA505 as well as numeroussmaller campaigns likely attributable to other, disparate, threat actors. In addition to the availability ofcommercial licences, the tool is free for non-commercial use and supports the remote administration ofboth Microsoft Windows and Android devices.As to be expected when dealing with cybercriminals, 'cracked' versions of RMS also appear to be distributed on underground forums and likely remove licencing restrictions.Negating the need for a threat actor to develop their own tools, RMS features include remote control withmulti-monitor support, task manager, file transfer, command line interface, network mapping capabilities and webcam/microphone access, all of which are common traits of a well-developed remote access trojan (RAT).These features, coupled with the ability to install and operate the tool silently, make RMS an attractive of-the-shelf solution for 'abuse' by both sophisticated and unsophisticated threat actors alike.In addition to RMS implementing its own remote desktop capabilities, which are compressed and encryptedthe Microsoft Remote Desktop Protocol (RDP) is also supported and as such could facilitate the control ofServHelper' compromised devices. Notably, whilst most malicious RATs would need to call home to the threat actor's command and control(C2) infrastructure, RMS includes an Internet-lD' feature which calls home to the developers' servers andsends a notifcation via email (Figure 31), further reducing attack complexity for less sophisticated threat actors.Within this notifcation email, the victim's username and device name is provided along with the internetlD and password required for remote administration.Alternatively, and seemingly favour by more sophisticated threat actors such as TA505, a self-hostedoption is supported by RMS and allows them to configure their own "Remote Utilities' (Ru) Server. This RUServer supports three roles that can be deployed individually or together, although only one, the "RelayServer, would likely be utilised in nefarious implementations. This Relay Server acts as an intermediarywith 'compromised' RMS clients calling-home to it and identifying themselves with their "Internet-lDyfacilitating communications that allow firewalls and NAT devices to be bypassed.The additional roles, "Authorization Server, supporting the management of access permissions, andSync Server, synchronising address books, are likely only deployed in legitimate environments such ascorporate IT support teams.Numerous RussianÂ·language forum and social media posts, along with YouTube video tutorials, detail howto package the legitimate RMS components for use in malicious campaigns and appear to date back to atleast 2011.Threat actors such as TA505 have likelyevolved their use of RMS over time to thepoint where they now package and deliverthe capable tool with their own malware;a blend of proprietary threats with off-the-shelf components combined with triedand tested TTP.That being said, the accessibility and simplicity of using RMS for nefarious purposes likely explains theprevalence of the tool in unrelated malicious campaigns, many of which share similar TTP but difer in theirconfiquration and use of RMS.Whilst the recent TA505 campaigns illustrate how a sophisticated threat actor may deliver the RMS toolalong with other payloads, numerous tutorials, guides and tools are available on underground forums toallow unsophisticated threat actors to conduct similar operations.As if RMS didn't already provide enough functionality that can be abused by threat actors, the "Viewer'application includes a MSl Configurator' option that allows an installer package to be created. Having firstdownloaded the latest RMS Host package from the leqitimate website, the confiqurator wizard allows thecreation of three distribution types (Figure 33).Notably within these settings is the ability to supress notifications and otherpotentially victim-alerting features as well as configuring the network port andpreventing the future modification of settings without a passwordOnce the package and configuration have been prepared, they can then bedelivered via various means to potential victims. In the case of TA505, thisinvolved a lure file acting as a downloader which delivered custom payloadswhich ultimately silently install RMS. Lesssophisticated threat actors may chooseto follow an existing tutorial or obtain one of many builder tools available onunderground forums to further prepare their pre-configured RMS host which canthen subsequently be delivered to victims via common methods such as phishingemails or by masquerading as legitimate downloads.Early tutorials regarding the silent installation of RMS demonstrate the use of AutolTâ€™, a legitimateautomation tool, that supresses user interactive elements of a preconfigured RMS installer, such as sendinga mouse click command to close the installation completion dialog (Figure 37).C2 communications between the RMS host and server have been observed as using a predefined user.agent string 'Mozilla/4.0 (compatible; RMS). In the absence of a configuration option for this string, it is likelyhardcoded and therefore communications identifying themselves as this user-agent are likely compromisedC2 communications, via TCP, appear to transmit XML data with a structure similar to the RMS confiquration data with base64 encoded elements (Fiqure 44).In the case of a RMs host configured to call home to the legitimate servers, resulting in a notification email to the threat actor, a HTTP POST is used to send the data comprised of email address, additional text (as specified in the configuration, and potentially providing an indication of a tool being used), victim user name, victim computer name, Internet-ID, victim language and theproduct name (Figure 46).