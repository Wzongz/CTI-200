It would seem that the TA505 intrusion set goes back to at least 2014 but was only mentioned publicly for the first time on Twitter in 2017. Until 2017, its activity seems to have been confined to the distribution of trojans and ransomwares [1]. In terms of final payload, TA505 has always widely used banking trojans that are not specific to it, such as Dridex and Trickbot:TA505 is supposed to have distributed the Dridex malware [2] as of July 2014, i.e. one month after its creation (June 2014) [1]. Its use of specific ID botnets1 within the Dridex network of botnets, controlled by the Evil Corp cybercriminal group, would suggest that TA505 was a Dridex affiliate from 2014 to 2017. ID botnets used by TA505 between 2014 and 2015 would have been botnet IDs 125, 220 and 223. The 220 botnet is thought to have contained 9650 bots in April 2015 [3], and mainly targeted banks [4], particularly in France. In 2016, TA505 is thought to have mainly concentrated on the use of Locky ransomware, to the detriment of Dridex malware, then resumed propagation of Dridex in 2017 through 7200 and 7500 ID botnets. TA505 finally stopped using Dridex in 2018 [5].TA505 is also thought to have been an affiliate of TrickBot2 , known under the pseudonym of mac1 [5]. The use of TrickBot by TA505 only lasted a few months in 2017. For example, a campaign dating back to June 2017 targeted France and the United Kingdom [5].2016 saw the appearance of Locky ransomware. Frequently used, it has targeted many victims. Like Dridex, Locky works on the principle of affiliates [1]. According to Proofpoint, affiliate number 3 of Locky and the affiliate of ID botnet Dridex 220, TA505, have points in common, such as similar lures on their phishing emails and very strong similarities regarding Javascript, VBScript codes and Microsoft Word macros used [7]. There is also an absence of Dridex 220 campaigns concomitant with the emergence of Locky [8]. Proofpoint [7] also pinpoints links between Locky and the affiliate of Dridex ID botnet 7200, TA505 at this time, comparing Dridex 2017 campaigns with Locky past campaigns [1]. TA505 is therefore presumed to be affiliate number 3 (”Affid=3”) of this ransomware. Although the main ransomware used by the group remains Locky, TA505 is thought to occasionally use other ransomwares (Bart3 , Jaff4 , Scarab 5 , Philadelphia6 , GlobeImposter7 and GandCrab8 ). TA505 seems to have distributed its malware only through phishing email campaigns. This intrusion set was characterised by its massive use of Necurs botnet (see appendix in chapter 5) for the distribution of emails [9]. Comment: open source reports associate all ransomwares distributed by the Necurs botnet to TA505. However, some of these ransomwares were used over the same periods. It seems unlikely that TA505 operated as many encryption codes at the same time. It is more likely that Necurs had several clients simultaneously. This intrusion set relies exclusively over that period on social engineering to run its payload contained in malicious attachments linked to emails sent [9]. These attachments could be zip or 7zip archives containing VBS script or Javascript to be run by their victims, HTML pages containing malicious Javascript, or Offices documents bugged with malicious macros. Although TA505 does not seem to have used software vunerability to compromise its targets, it is interesting to observe that it has kept up to speed with the latest social engineering techniques. It therefore distributed bugged Office documents via the DDE mechanism less than a month after the potential abuse of this feature became common knowledge [10].The year 2018 was a turning point in the attack methods of the intrusion set. TA505 gradually reduced its distribution of malicious banking codes and ransomwares to move into the distribution of backdoors. However, this intrusion set does not seem to be content with running a payload on its victim’s computer. When it deems it useful, TA505 tries to compromise the entirety of the information system (IS) it penetrated. It also seems, in some cases, to resell accesses to the backdoors it has installed, which makes it difficult to distinguish between specific TA505 activities and those of potential clients. The chain of attack described in this chapter corresponds to the activities that ANSSI believes are linked to the intrusion set.The only infection vector currently known to be used by the TA505 intrusion set is phishing emails including a malicious attachment or link. Until 2018, the intrusion set relied practically exclusively on the Necurs botnet to distribute its payloads. However, following the unavailability of the botnet in January and February 2018, TA505 seems to have less often used its services [9]. This last point however is uncertain as there is little information on the alternative email distribution methods of the intrusion set. Given that TA505 has often deployed an email credentials theft implant among its victims [11][12], it is possible that it accumulates email addresses to distribute its new phishing campaigns. It has also been mentioned that some of its phishing emails had been distributed via machines infected by the Amadey [11] malware. Given that TA505 also uses Amadey malware as indicated in section 2.3.1, it may have created its own Amadey botnet to distribute its malicious emails, or may use the services of an existing Amadey botnet. This operating mode also usurps the recipient addresses of its emails, which makes it difficult to analyse its email distribution infrastructure [13].The intrusion set continues to rely on social engineering to run its malicious payloads on the machines of its email recipients, using several formats for attachments to work around its targets’ security systems: .url [14], .iqy [9], SettingContent-ms [15], MS publisher files [16], .wiz and .pub [17], .iso [18]. The aim of these documents was often to run msiexec9 commands via macros on the victim’s machine to upload and run a malware. However, in the second half of 2019 and first half of 2020, TA505 seems to have modified and stabilised its social engineering scheme. It now sends an HTML page as an attachment containing malicious Javascript code. This code redirects the victim towards an URL of a legitimate but compromised website. This same URL corresponds to an HTML page containing a minimal Javascript code redirecting the victim towards a page hosted by a machine controlled by the intrusion set. This page mimicks that of a legitimate file-sharing site adapted to the target such as Onedrive, Dropbox [19] or Naver10 (during one of its campaigns in South Korea) [20]. The victim is then encouraged to download, open and enable VBA macros of an Office document, usually Excel, containing a malicious payload .The intrusion set gradually increases the complexity of its social engineering method. In October 2019, it is thought to have directly sent links towards phishing pages in its malicious emails. It then used URL shorteners to mask these malicious links. In late February 2020, it abandoned the URL shortener strategy and started to use HTML attachments with Javascript with redirection from a compromised site, which made it even more difficult to detect its emails. Furthermore, some of its redirection pages integrate a link towards iplogger.org, a service allowing the intrusion set to inspect IP addresses visiting these pages[21]. Finally, it has already been observed that the phishing pages of the intrusion set distributed empty Office documents when a person other than the victim visited them. This behaviour can be explained by the fact that the intrusion set filters the IP addresses to which it chooses to distribute its malicious documents or only distributes them within limited time slots.TA505 has a varied attack arsenal to be deployed among its victims having run its malicious attachments. It consists of codes available both publicly and commercially on the black market or which seem to be exclusive to it. It therefore has malware development capabilites or financial resources to obtain them. The intrusion set deploys its arsenal in several stages and has different codes for each of them.The TA505 intrusion set seems to have tested several stage 1 codes11. It briefly used the following codes:The TA505 intrusion set therefore does not seem to hesitate to discard some of its malwares in order to test others. Despite that, a trend does emerge: it seems to more regularly use the stage 1 malware Get2, whose backdoor component is also called Friendspeak [13]. Since the first publication of this malware in September 2019 [19], the intrusion set regularly uses it. Get2 performs a basic reconnaissance of the machine it infects by sending to its C2 server information such as the name of the infected machine, the name of the user, the version of the Windows operating system and list of active processes on the machine. In return, if the machine is deemed to be of interest, it receives the URL to which it can upload the next stage malware.Once its stage 1 code has been deployed, the intrusion set can deploy several malwares.Once its malwares are installed, the intrusion set can try to lateralise itself within a compromised network. Its goal is to become the domain administrator. To achieve this, it uses several methods.The intrusion set scans the network to collect more information on the IS and discover vulnerable services [28]. One of the tools used by TA505 is the PowerSploit suite, a set of PowerShell scripts available in open-source and used to test the security of an IT network. The intrusion set particularly focuses on the Active Directory of the IS and has already deployed in the past another penetration test tool, PingCastle, to test configuration weaknesses affecting that service. Although crucial to take over the network, the intrusion set does not necessarily seem to perform these operations first. In several cases observed, the intrusion set firstly tends to try to compromise several other machines before scanning the IS and the Active Directory. The intrusion set seems to continue its network mapping work after having compromised the credentials of a domain administrator. It has already been observed that TA505 used a query software of Active Directory called AdFind on a domain controller to fully map an IS of which it had become the domain administrator.The method preferred by TA505 to increase its privileges and lateralise throughout a network seems to be the collection of credentials on compromised machines. The Mimikatz collection tool, available free of charge in opensource, is regularly used by the intrusion set and other tools of this type may also have been used. Unconfirmed hypotheses have also been made on the use of MS17-010 vulnerability 13 by the intrusion set [28].To facilitate its lateralisation operations and increase its robustness within a compromised network, the intrusion set has very frequently used Cobalt Strike, a penetration testing framework, and the TinyMet tool14. However, TA505 also often uses native Window tools such as WMIC and RDP to run its malware on new machines by using stolen credentials. The main goal of the intrusion set is to deploy ransomware. The use of ransomware by this intrusion set goes back to at least 2016 with its use of the Locky malware. Major developments since 2018 can be explained by the fact that TA505 now seeks to use ransomware to compromise entities liable to pay a high ransom (big game hunting) and to encrypt all the machines of the compromised IS. During TA505-related attacks, Clop ransomware, also called Ciop, was deployed. This malware was observed for the first time in February 2019 [20]. It has no automatic propagation functions. Consequently, the intrusion set uses some specific tools to deploy it within a whole IT system. Using a script, it deploys a malware, poorly documented in open-source but until now systematically called « sage.exe » by the intrusion set, on several machines [28]. These machines then connect to all the machines of the victim IS to successively run two payloads on each of them with a domain administrator account：It is probable that TA505 relies on the network mappings performed during the gradual compromission of the IS to choose the machines on which to run « sage.exe » and maximise the impact of its ransomware. An occurrence of use of the Rapid ransomware by TA505 was also observed by the South Korean Financial Security Institute (FSI) [20] in December 2019.A website was created in March 2020 to publish exfiltrated data of Clop ransomware victims not having paid their ransom, probably to increase pressure on future victims. A release was published by the attackers stating that should a hospital be accidentally victim of their ransomware, the data decrypter would be immediately provided. If, as sugested in section 2.5.3, Clop is specific to TA505, this illustrates the capability of this intrusion set to follow a trend initiated by other ransomware operators [29]. This trend is also interesting as it indicates that the intrusion set is required to exfiltrate data of its victim’s IS. If such data were to exceed a certain volume, it is then probable that TA505 needs to deploy specific tools and infrastructure for this task. Such things have not yet been observed for this intrusion set.ANSSI had mentioned a technical link between Clop ransomware and TA505. Indeed, Clop and FlawedAmmyy had been signed by the same valid but malicious security certificate [30]. To this, it is possible to add that these two malwares were compiled in similar environments and modified at the same time to change the letter « l » into « i » uppercase [20] in their chains. Furthermore, they have the same characteristic name « swaqp.exe » in separate attacks. It therefore seems probable that one single intrusion set handles both codes. Given that TA505 is the only one to have been seen to use them since 2018, it seems that both codes are specific to it.The intrusion set multiplies strategies to minimise the detection of its malware. Besides the use of attached document with unusual formats mentioned in section 2.2, TA505 has also used Excel 4.0 type macros. These very old macros were not often detected by security solutions during their adoption by the intrusion set. Likewise, TA505 relies heavily on native Windows tools, which require closer supervision of the IS to detect their malicious use.TA505 uses a compression code15 to make it more difficult to analyse its malware. This code, called Minedoor [13], was used to compress both early stage malwares such as FlawedGrace, and final codes deployed by TA505 such as Clop or DeactivateDefender [31]. Although this compression code is a valuable way to monitor TA505’s arsenal, caution is required. Attacks using codes protected by Minedoor with very different kill chains from that of TA505 have already been observed [13]. It therefore seems that this code is not specific to TA505.The intrusion set signs its malware by using legitimate but malicious security certificates. They often take over names of existing businesses. TA505’s codes are therefore more difficult to detect [20]. Like the Minedoor malware, it is not certain that all the malware signed by the certificates used by TA505 are linked to this intrusion set. Indeed it may be that TA505 used a third party to sign its codes and that this same third party may reuse those certificates to sign the malware of other intrusion sets .As mentioned in section 2.1, the infrastructure used by the intrusion set to distribute its emails is not widely documented. TA505 particularly seems to rent its infrastructure to conduct its operations, in particular to host its malicious Office documents and for its Get2 C2 servers16. The life cycle of this infrastructure is usually less than a month and the intrusion set permanently generates new domain names. These domain names often consist of several words separated by « - » and usually try to typosquat17 file-sharing services such as Onedrive ou Onehub for example. TA505 is thought to use a different strategy for the C2 servers of its penetration tools such as TinyMet or Cobalt Strike. It directly uses IP adresses as C2 servers and not domain names but still relies on a rented infrastucture.Little information is available about the infrastructure compromised by TA505. Web servers compromised by the intrusion set were analysed in February 2019 [20], indicating that several copies of the malicious web console Filesman had been found as well as a non-documented Linux backdoor.Although they only represent a fraction of the intrusion set’s real activity, the table below presents a set of campaigns conducted by TA505, documented in open-source since 2018. The financial sector used to be the exclusive target of the intrusion set before 2018 and has remained a regular target since. TA505 has however gradually expanded its victim profile to other new sectors.From a geographical point of view, all the continents are targeted by this intrusion set. A point of interest is the special attention TA505 seems to pay to South Korea. This interest could be linked to the fact that the intrusion set could have been working in connection with the Lazarus intrusion set as mentioned in chapter 3.Given its varied arsenal, the broadness of its targets, its sometimes massive, sometimes targeted campaigns, TA505 could well be a hacker-for-hire i.e. a provider of IS compromise and access qualification services. Its clients will provide it with a list of potential targets which TA505 will try to compromise, to then sell these compromised or qualified accesses to clients. At least two potential clients have been identified by editors: the Lazarus intrusion set known to be tied to North Korean interests in open-sources and the Silence [38] group.The simultaneous presence of Lazarus and TA505 has already been observed by different sources. In early January 2018, the Vietnamese CERT issued an alert relating to attacks targeting the financial sector, combining indicators of compromise attributed to intrusion sets linked to North Korean interests in open-sources to others attributed to TA505 [39]. According to Lexfo, IOCs found simultaneously on bank networks and Powershell scripts, attributed to TA505 and to Lazarus, seem similar [40]. Comment: As Dridex was used by Lazarus during the Bangladesh Bank heist in 2016, it is legitimate to query the prior opening of access by a cybercriminal group before the intrusion by Lazarus. [41]. In addition, the specific targeting of South Korea by TA505 could indicate an order from a final client such as an intrusion set known to be linked in open-sources to North Korean interests.There are code and infrastructure links between FlawedAmmyy and Truebot (aka Silence.Downloader), a remote administration tool specific to Silence18. According to the Group-IB editor, FlawedAmmyy.downloader and Truebot were developed by the same individual [42]. Furthermore, Silence is thought to have attacked at least one bank in Europe via TA505 in order to compromise its IS [43]. Comment: If Silence does indeed call on TA505 for the initial compromise, it would be to change the TTPs, as Silence, from its beginning, in 2016, is autonomous in the sending of phishing emails and initial compromise.According to the Korean Financial Security Institute (FSI) [20], there are similarities between TA505 and the FIN7 cybercriminal group, the successor to Carbanak and now specialising in the theft of credit card information. The two groups are thought to:Comment: FIN7 and TA505 could in fact be working together. It seems that the FSI observed that an infection chain in line with those of TA505 deployed malware targeting POS terminals (PoS systems), belonging to FIN7. Despite the scale of its activity as an affiliate of Dridex and Locky, TA505 was only identified as such in 2017, at the same time as its first uses of backdoors. Often mistaken for the Evil Corp cybercriminal group (operating the Dridex botnet and BitPaymer ransomware), and sometimes considered to be the operator of the Necurs botnet, TA505 uses a scalable attack arsenal which it implements in varied and sometimes simultaneous campaigns, casting confusion over its motives. As such, the ties it has with Lazarus and Silence suggest that TA505 conducts parallel campaigns for its own behalf and campaigns for its clients. The scale of its campaigns since 2019 and its targeting of several sectors in France, make this intrusion set a threat of special concern in 2020.