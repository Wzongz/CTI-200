{
  "event_id": "127",
  "claim": "SideWinder Uses Server-side Polymorphism to Attack Pakistan Government Officials — and Is Now Targeting Turkey.",
  "original_label": "true",
  "label": "true",
  "explain": "Sangfor FarSight Labs recently captured and analyzed a malware sample used in an attack against the Pakistan government, suspected of being carried out by the SideWinder advanced persistence threat (APT) group. SideWinder, also known as APT-C-17 and T-APT-04, operates from a South Asian nation-state and specializes in cyber espionage against Asian countries such as China and Pakistan, with the aim of stealing sensitive information. The group's activities have been ongoing since at least 2012 and remain highly active. The focus of their attacks are Pakistani government and military organizations. In this latest campaign, the threat actor used targeted spear-phishing emails to attack government organizations. The emails contain a PDF attachment named Adv-16-2023, masquerading as a security advisory issued by the Pakistani Cabinet Division. After the file is opened, the attacker entices the victim to download a password protected RAR file. This compressed file contains a malicious LNK file, which then downloads the second-stage payload. Through the exploitation of DLL side-loading, the attacker hijacks both the local OneDrive program and its update program, leading to the deployment of Cobalt Strike, a commonly used remote control program in penetration testing to take control of the compromised machine.Sangfor FarSight Labs intercepted a spear-phishing attachment used in the attack, named Adv-16-2023.pdf. This file masquerades as a security advisory of the same name, issued by the Cabinet Division of Pakistan and available for download on its official website (cabinet.gov.pk), as shown in the figure below.After opening the malicious PDF file, the victim is lured into downloading a RAR file of the same name. The file claims to be protected by Microsoft Azure cloud security, and a document password is provided for extraction.The unpacked RAR file contains an LNK file disguised as a PDF file using the extension “.pdf.lnk”. The user is tricked into opening the file. The details of this LNK file are as follows,After the LNK file is opened, it uses mshta.exe to download and execute the something.hta file.SideWinder APT Launches New Attacks on Pakistan Government 4 The downloaded HTA file executes VBScript to download subsequent components used in the attack. The details of this HTA file are as follows,version.dll is downloaded and placed in the local OneDrive directory. When the local 64-bit OneDrive.exe and OneDriveStandaloneUpdater.exe are executed, they are hijacked using DLL side-loading to load version.dll. Additionally, the scheduled task for updating OneDrive is used by the attacker to gain persistence on the system.The downloaded version.dll is stored in the path %LOCALAPPDATA%\\Microsoft\\OneDrive\\ and is a 64-bit file. It requires both the 64-bit version of OneDrive.exe and OneDriveStandaloneUpdater.exe to load. The details of this DLL file are as follows:37E3465D6FCCFAE6E1C29526AA015A766F8FC26CC61ED821F3E0B44D794C99EC.The exported functions, GetFileInfoSize and GetFileVersionInfoSizeW, have their memory addresses located at the same position within the binary file of OneDrive.exe. These functions are called by OneDrive.exe after importing the DLL.Within the GetFileInfoSize and GetFileVersionInfoSizeW functions, the FUN_180001120 function is invoked to decrypt and execute subsequent payloads.This function reads the .text segment of ntdll.dll in the system directory and uses it to replace the .text segment of the currently loaded ntdll.dll, effectively unhooking the functions. Any security software that monitors hooks set by ntdll.dll is rendered ineffective.By performing SHA-256 hash computation on the hardcoded 16-byte data, a 256-bit hash value is generated. This hash value is used as the decryption key for AES-256. The shellcode is decrypted using this key and subsequently executed.The executed shellcode uses a reflective loading technique to dynamically load and execute the Cobalt Strike beacon. This establishes a connection with the attacker's C2 (command-and-control) server (IP address 35.175.135.236) and gives the attacker remote control.The associated domain names finance-govpk.servehttp[.]com and csd-govpk.servehttp[.]com were identified through association analysis.The attack process related to https[:]//csd-govpk.servehttp.com/Advisory-16-2023.rar is consistent with the above analysis. However, finance-govpk.servehttp[.]com differs in that it is associated with a different phishing document, Elligible- Employee-List.xls.Victims are prompted to enable macros in Excel to view its content.Once macros are enabled, the macro code removes the prompt to display the content used to bait the victim into downloading UrlDownloadFileA, which downloads and places version.dll in the OneDrive directory to perform DLL hijacking. The function of UrlDownloadFileA is similar to the previously analyzed something.hta, but it employs a different phishing method.The domain names of ntc-govpk.servehttp[.]com, finance-govpk.servehttp[.]com, and csd-govpk.servehttp[.]com are consistent with the domain name format [xxx]govpk.servehttp.com, which multiple intelligence sources attribute to SideWinder. Additionally, the access controls implemented on the C2 server allow file downloads only from IP addresses in targeted regions such as Pakistan, which also aligns with the characteristics of this threat actor.The SideWinder APT group frequently relies on spear-phishing attacks against specific targets, which is a significant danger. They mainly target government and military organizations to steal high-tech research data and strategic information. Organizations in these sectors must remain vigilant and improve the protection of their network infrastructure. In this latest incident, the suspected SideWinder samples demonstrated a streamlined attack process that leveraged Cobalt Strike. Security vendors need to strengthen their detection capabilities to see such techniques. The Sangfor FarSight Labs APT Team specializes in tracking and analyzing global advanced threat incidents. It possesses a powerful external threat monitoring system with automated analysis and attribution system. This enables the team to rapidly and accurately analyze and correlate attack samples used by APT groups. Additionally, it has built and refined detailed profiles of many APT and hacker groups. The team’s expertise has successfully helped customers mitigate numerous APT and security incidents. As cyber defenses evolve, cybercriminals will research and employ new tactics, techniques, and procedures (TTP). The Sangfor FarSight Labs APT Team is committed to in-depth research and analysis of newly discovered security events worldwide to keep organizations secure.\n\n\n",
  "reports": [
    {
      "link": "https://www.darkreading.com/cyberattacks-data-breaches/sidewinder-strikes-victims-pakistan-turkey-multiphase-polymorphic-attack/",
      "content": "In both cases, targets were instructed to reach out to remote addresses controlled by SideWinder that would download the next-stage payload, “file.rtf,\" a rich text document file that demonstrates the polymorphic nature of the attack and can only be downloaded by users in the Pakistani IP range, the researchers said. In early March, the researchers discovered a new malicious document linked to the earlier attack that was propagated via phishing emails, indicating that the scope of the attack had spread to victims in Turkey — a new target region for SideWinder, researchers said. India's prolific SideWinder advanced persistent threat group (APT) is targeting Pakistani government officials and individuals in Turkey, using polymorphism techniques that allow it to bypass traditional signature-based antivirus (AV) detection to deliver a next-stage payload. The attack can fool defenders because it serves the victim with a new sample each time a link is clicked, Dmitry Bestuzhev, senior director of cyber-threat intelligence at BlackBerry, tells Dark Reading. The attacks use documents with content geared toward their interests, which when opened exploit a remote template injection flaw to deliver malicious payloads, the researchers at the BlackBerry Threat Research and Intelligence team revealed in a blog post on May 8. The first phase of the campaign — discovered in November — uses a server-side polymorphic attack against targets in Pakistan, while a later phase discovered earlier this year uses phishing tactics to deliver malicious lure documents to victims, the researchers said.",
      "domain": "www.darkreading.com",
      "tokenized": [
        {
          "sent":"In both cases, targets were instructed to reach out to remote addresses controlled by SideWinder that would download the next-stage payload, “file.rtf,\" a rich text document file that demonstrates the polymorphic nature of the attack and can only be downloaded by users in the Pakistani IP range, the researchers said.",
          "is_evidence": 1,
          "is_repeat": 0
        },
        {
          "sent":"In early March, the researchers discovered a new malicious document linked to the earlier attack that was propagated via phishing emails, indicating that the scope of the attack had spread to victims in Turkey — a new target region for SideWinder, researchers said.",
          "is_evidence": 0
        },
        {
          "sent": "India's prolific SideWinder advanced persistent threat group (APT) is targeting Pakistani government officials and individuals in Turkey, using polymorphism techniques that allow it to bypass traditional signature-based antivirus (AV) detection to deliver a next-stage payload.",
          "is_evidence": 0
        },
        {
          "sent":"The attack can fool defenders because it serves the victim with a new sample each time a link is clicked, Dmitry Bestuzhev, senior director of cyber-threat intelligence at BlackBerry, tells Dark Reading.",
          "is_evidence": 0
        },
        {
          "sent":"The attacks use documents with content geared toward their interests, which when opened exploit a remote template injection flaw to deliver malicious payloads, the researchers at the BlackBerry Threat Research and Intelligence team revealed in a blog post on May 8.",
          "is_evidence": 0
        },
        {
          "sent": "The first phase of the campaign — discovered in November — uses a server-side polymorphic attack against targets in Pakistan, while a later phase discovered earlier this year uses phishing tactics to deliver malicious lure documents to victims, the researchers said.",
          "is_evidence": 0
        }
      ]
    },
    {
      "link": "https://www.infosecurity-magazine.com/news/sidewinder-apt-attacks-regional/",
      "content": "During the six-month period, the threat intelligence firm discovered SideWinder threat actors attempted to attack 61 government, military, law enforcement and other targets in Afghanistan, Bhutan, Myanmar, Nepal and Sri Lanka. If a victim clicks on a malicious link in the phishing email, it will subsequently download a malicious document, an LNK file or a malicious payload. Security researchers have discovered dozens of new regional targets and new cyber-attack tools linked to Indian APT group SideWinder. SideWinder’s threat vector of choice remains spear-phishing emails, which it fired at these targets during the period. The payload itself could be a reverse shell, a remote access Trojan (RAT) or an information stealer, the report claimed. Two campaigns featured emails in which the APT group spoofed a cryptocurrency firm, Group-IB said.",
      "domain": "www.infosecurity-magazine.com",
      "tokenized": [
        {
          "sent": "During the six-month period, the threat intelligence firm discovered SideWinder threat actors attempted to attack 61 government, military, law enforcement and other targets in Afghanistan, Bhutan, Myanmar, Nepal and Sri Lanka.",
          "is_evidence": 1,
          "is_repeat": 0
        },
        {
          "sent":"If a victim clicks on a malicious link in the phishing email, it will subsequently download a malicious document, an LNK file or a malicious payload.",
          "is_evidence": 0
        },
        {
          "sent": "Security researchers have discovered dozens of new regional targets and new cyber-attack tools linked to Indian APT group SideWinder.",
          "is_evidence": 1,
          "is_repeat": 0
        },
        {
          "sent":"SideWinder’s threat vector of choice remains spear-phishing emails, which it fired at these targets during the period.",
          "is_evidence": 1,
          "is_repeat": 0
        },
        {
          "sent":"The payload itself could be a reverse shell, a remote access Trojan (RAT) or an information stealer, the report claimed.",
          "is_evidence": 0
        },
        {
          "sent":"Two campaigns featured emails in which the APT group spoofed a cryptocurrency firm, Group-IB said.",
          "is_evidence": 1,
          "is_repeat": 0
        }
      ]
    },
    {
      "link": "https://blogs.blackberry.com/en/2023/05/sidewinder-uses-server-side-polymorphism-to-target-pakistan/",
      "content": "In this campaign, the SideWinder advanced persistent threat (APT) group used a server-based polymorphism technique to deliver the next stage payload. SideWinder primarily makes use of email spear-phishing, document exploitation, and DLL side-loading techniques in an attempt to avoid detection and deliver targeted implants. The BlackBerry Threat Research and Intelligence team has been actively tracking and monitoring the SideWinder APT group, which has led to the discovery of their latest campaign targeting Pakistan government organizations. The malicious documents used in this campaign were created to target Pakistan government officials. The “GUIDELINES FOR JOURNAL - 2023 PAKISTAN NAVY WAR COLLEGE (PNWC).doc“ malicious lure template was instructed to reach out to the remote address of “hxxps[:]//pnwc[.]bol-north[.]com/5808/1/3686/2/0/0/0/m/files-a2e589d2/file[.]rtf”. This report discussed the SideWinder group’s targeted attack carried out in early December 2022.",
      "domain": "blogs.blackberry.com",
      "tokenized": [
        {
          "sent": "In this campaign, the SideWinder advanced persistent threat (APT) group used a server-based polymorphism technique to deliver the next stage payload.",
          "is_evidence": 1,
          "is_repeat": 0
        },
        {
          "sent":"SideWinder primarily makes use of email spear-phishing, document exploitation, and DLL side-loading techniques in an attempt to avoid detection and deliver targeted implants.",
          "is_evidence": 0
        },
        {
          "sent": "The BlackBerry Threat Research and Intelligence team has been actively tracking and monitoring the SideWinder APT group, which has led to the discovery of their latest campaign targeting Pakistan government organizations.",
          "is_evidence": 0
        },
        {
          "sent":  "The malicious documents used in this campaign were created to target Pakistan government officials.",
          "is_evidence": 0
        },
        {
          "sent":"The “GUIDELINES FOR JOURNAL - 2023 PAKISTAN NAVY WAR COLLEGE (PNWC).doc“ malicious lure template was instructed to reach out to the remote address of “hxxps[:]//pnwc[.]bol-north[.]com/5808/1/3686/2/0/0/0/m/files-a2e589d2/file[.]rtf”.",
          "is_evidence": 0
        },
        {
          "sent": "This report discussed the SideWinder group’s targeted attack carried out in early December 2022.",
          "is_evidence": 0
        }
      ]
    },
    {
      "link": "https://thehackernews.com/2023/05/state-sponsored-sidewinder-hacker.html/",
      "content": "\"Like many other APT groups, SideWinder relies on targeted spear-phishing as the initial vector,\" the researchers said. Also uncovered is a Windows shortcut (LNK) file that was uploaded to VirusTotal from Beijing in late November 2022. Cybersecurity researchers have unearthed previously undocumented attack infrastructure used by the prolific state-sponsored group SideWinder to strike entities located in Pakistan and China. Earlier this February, Group-IB brought to light evidence that SideWinder may have targeted 61 government, military, law enforcement, and other organizations across Asia between June and November 2021. More recently, the nation-state group was observed leveraging a technique known as server-based polymorphism in evasive attacks targeting Pakistani government organizations. SideWinder has been known to be active since at least 2012, with attack chains primarily leveraging spear-phishing as an intrusion mechanism to obtain a foothold into targeted environments.",
      "domain": "thehackernews.com",
      "tokenized": [
        {
          "sent": "\"Like many other APT groups, SideWinder relies on targeted spear-phishing as the initial vector,\" the researchers said.",
          "is_evidence": 1,
          "is_repeat": 0
        },
        {
          "sent":"Also uncovered is a Windows shortcut (LNK) file that was uploaded to VirusTotal from Beijing in late November 2022.",
          "is_evidence": 0
        },
        {
          "sent":"Cybersecurity researchers have unearthed previously undocumented attack infrastructure used by the prolific state-sponsored group SideWinder to strike entities located in Pakistan and China.",
          "is_evidence": 0
        },
        {
          "sent":"Earlier this February, Group-IB brought to light evidence that SideWinder may have targeted 61 government, military, law enforcement, and other organizations across Asia between June and November 2021.",
          "is_evidence": 1,
          "is_repeat": 0
        },
        {
          "sent": "More recently, the nation-state group was observed leveraging a technique known as server-based polymorphism in evasive attacks targeting Pakistani government organizations.",
          "is_evidence": 0
        },
        {
          "sent":"SideWinder has been known to be active since at least 2012, with attack chains primarily leveraging spear-phishing as an intrusion mechanism to obtain a foothold into targeted environments.",
          "is_evidence": 1,
          "is_repeat": 0
        }
      ]
    }
  ]
}