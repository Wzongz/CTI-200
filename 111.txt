{
  "event_id": "111",
  "claim": "Carbanak is the name we use for an APT-style campaign targeting (but not limited to) financial institutions.",
  "original_label": "true",
  "label": "true",
  "explain": "The story of Carbanak began when a bank from Ukraine asked us to help with a forensic investigation. Money was being mysteriously stolen from ATMs. Our initial thoughts tended towards the Tyupkin malware. However, upon investigating the hard disk of the ATM system we couldn’t find anything except a rather odd VPN configuration (the netmask was set to 172.0.0.0). At this time we regarded it as just another malware attack. Little did we know then that a few months later one of our colleagues would receive a call at 3 a.m. in the middle of the night. On the phone was an account manager, asking us to call a certain number as matter of urgency. The person at the end of the line was the CSO of a Russian bank. One of their systems was alerting that data was being sent from their Domain Controller to the People’s Republic of China.When we arrived on site we were quickly able to find the malware on the system. We wrote a batch script that removed the malware from an infected PC, and ran this script on all the computers at the bank. This was done multiple times until we were sure that all the machines were clean. Of course, samples were saved and through them we encountered the Carbanak malware for the first time.Further forensic analysis took us to the point of initial infection: a spear phishing e-mail with a CPL attachment; although in other cases Word documents exploiting known vulnerabilities were used. After executing the shellcode, a backdoor based on Carberp, is installed on the system. This backdoor is what we know today as Carbanak. It is designed for espionage, data exfiltration and remote control.Once the attackers are inside the victim´s network, they perform a manual reconnaissance, trying to compromise relevant computers (such as those of administrators’) and use lateral movement tools. In short, having gained access, they will jump through the network until they find their point of interest. What this point of interest is, varies according to the attack. What they all have in common, however, is that from this point it is possible to extract money from the infected entity. The gang behind Carbanak does not necessarily have prior knowledge of the inner workings of each bank targeted, since these vary per organisation. So in order to understand how a particular bank operates, infected computers were used to record videos that were then sent to the Command and Control servers. Even though the quality of the videos was relatively poor, they were still good enough for the attackers, armed also with the keylogged data for that particular machine to understand what the victim was doing. This provided them with the knowledge they needed to cash out the money.During our investigation we found several ways of cashing out: ATMs were instructed remotely to dispense cash without any interaction with the ATM itself, with the cash then collected by mules; the SWIFT network was used to transfer money out of the organisation and into criminals’ accounts; and databases with account information were altered so that fake accounts could be created with a relatively high balance, with mule services being used to collect the money.Since we started investigating this campaign we have worked very closely with the law enforcement agencies (LEAs) tracking the Carbanak group. As a result of this cooperation we know that up to 100 targets have been hit. When it comes to financial institutions, In at least half of the cases the criminals were able to extract money from the infected institution. Losses per bank range from $2.5 million to approximately $10 million. However, according to information provided by LEAs and the victims themselves, total financial losses could be as a high as $1 billion, making this by far the most successful criminal cyber campaign we have ever seen.Our investigation began in Ukraine and then moved to Moscow, with most of the financial entities targeted by the group located in Eastern Europe. However thanks to KSN data and data obtained from the Command and Control servers, we know that Carbanak also targets victims in the USA, Germany and China. Now the group is expanding its operations to new areas. These include Malaysia, Nepal, Kuwait and several regions in Africa, among others. The group is still active, and we urge all financial organizations to carefully scan their networks for the presence of Carbanak. If detected, report the intrusion to law enforcement immediately.Carbanak is the name we use for an APT-style campaign targeting (but not limited to) financial institutions. The main difference with other APT attacks is that attackers do not see data but money as their primary target. We say APT-like, however the attack is not strictly speaking Advanced. Strictly speaking, the main feature defining the attackers is Persistence. We name the backdoor Carbanak since it is based on Carberp and the name of the configuration file is “anak.cfg”.The attackers infiltrate the victim´s network looking for the critical system they can use for cashing money out. Once they have stolen a significant amount of money (from 2.5 to 10 MM USD per entity), they abandon the victim.Banking entities have always been a primary target for cybercriminals. However it was almost always through their customers. This time attackers are targeting financial entities directly in an unprecedented, determined, highly professional and coordinated attack, and using any means from the target to cash as much money out as possible, up to an apparently auto-imposed limit.According to what we know, the first malicious samples were compiled in August, 2013 when the cybercriminals started to test the Carbanak malware. The first infections were detected in December, 2013. On average, each bank robbery took between two and four months, from infecting the first computer at the bank’s corporate network to cashing the money out. We believe that the gang was able to successfully steal from their first victims during the period of February-April 2014. The peak of infections was recorded in June 2014. Currently the campaign is still active.Since we started working on this campaign we have collaborated with the different LEAs involved in the investigation and helped them as much as possible. As it remains an open investigation, we were asked not to share any details until it was safe to do so.Yes, this investigation turned into a joint operation between Kaspersky Lab’s Global Research and Analysis Team and international organizations, national and regional law enforcement agencies and a number of Computer Emergency Response Teams (CERTs) worldwide. One of our main goals was to disseminate our knowledge of the campaign and IOCs among all detected and potential victims. We used national CERTs and LEAs as the distribution channel.We’re helping to assist in investigations and countermeasures that disrupt malware operations and cybercriminal activity. During the investigations we provide technical expertise such as analyzing infection vectors, malicious programs, supported Command & Control infrastructure and exploitation methods.Attackers used spear phishing emails with malicious attachments against employees of the targeted financial institutions, in some cases sending them to their personal email addresses. We believe the attackers also used drive by download attacks, but this second assumption is still not 100% confirmed.Based on what the attackers stole from victims, a new victim faces potential losses of up to 10 million $. However this figure is arbitrary based on what we know: nothing limits the potential loss once an institution is infected.Victims are mainly institutions in the financial industry; however we have also found traces of infections in POS terminals and PR agencies. For a sense of the scale of the attack please see the different charts and maps we provide in our report. As with many malware campaigns there are a variety of companies/individuals analyzing the malware, resulting in requests to the Command and Control server. When we analyze those servers, all we see are the IPs and possibly some additional information. When this additional information is not present, and when the IP cannot be traced back to its owner, we mark it as an infection. Based on this approach our analysis concludes that Russia, the US, Germany and China are the most affected countries in number of traces of infection (IP addresses).Yes, we detect Carbanak samples as Backdoor.Win32.Carbanak and Backdoor.Win32.CarbanakCmd. All Kaspersky Lab’s corporate products and solutions detect known Carbanak samples. To raise the level of protection, it is recommended to switch on Kaspersky’s Proactive Defense Module included in each modern product and solution. We also have some general recommendations: Do not open suspicious emails, especially if they have an attachment; Update your software (in this campaign no 0days were used); Turn on heuristics in your security suites, this way it is more likely that such new samples will be detected and stopped from the beginning.\n\n\n",
  "reports": [
    {
      "link": "https://www.kaspersky.com/blog/the-great-bank-robbery-carbanak-apt/3598/",
      "content": "In November 2017 we reported on malicious documents that were downloaded from the domain zmwardrobe[.]com and subsequently executed a payload referred to as MY24. Multiple organizations have been affected or found to be hosting the malware used by BITTER, including the Pakistan government, an engineering company, and an electrical provider. Palo Alto Networks has shared our findings, including file samples and indicators of compromise, in this report with our fellow Cyber Threat Alliance members. Several malicious documents have been identified, all communicating with likely compromised, legitimate Pakistan websites to retrieve the payload. Since at least 2015, a suspected South Asian threat grouping known as BITTER has been targeting Pakistan and Chinese organizations using variants of a previously unreported downloader. They are observed targeting Pakistan, China, and Saudi Arabia using a customized downloader malware family named ArtraDownloader.",
      "domain": "www.kaspersky.com",
      "tokenized": [
        {
          "sent": "All Kaspersky Lab’s corporate products and solutions detect and block known Carbanak samples.",
          "is_evidence": 1,
          "is_repeat": 0
        },
        {
          "sent": "Coming back to the point, Carbanak investigation started in Ukraine where money had been siphoned mysteriously straight from the ATM.",
          "is_evidence": 0
        },
        {
          "sent":"Interestingly, attacker then proceed on performing a manual reconnaissance, trying to detect and compromise “relevant” computers, such as those of administrators.",
          "is_evidence": 0
        },
        {
          "sent":"Kaspersky Lab has discovered an ultra-massive money-stealing campaign codenamed Carbanak APT with total losses summing up to $1 bn so far.",
          "is_evidence": 0
        },
        {
          "sent":"To understand how a particular bank operates, infected computers were used to record videos that were then sent to the Command and Control servers.",
          "is_evidence": 0
        }
      ]
    },
    {
      "link": "https://www.trendmicro.com/en_us/research/21/d/carbanak-and-fin7-attack-techniques.html/",
      "content": "Among these cybercriminals are financially motivated threat groups Carbanak and FIN7. At the collection phase, Carbanak and FIN7 campaigns harvest data from local system sources and through input and screen capture (as performed in a related campaign using the Tirion malware). In Carbanak attacks, the groups’ attacks can involve logging into services that accept remote connections and using stolen password hashes through the “pass the hash” method. In both Carbanak and FIN7 attacks, communication with users’ compromised systems is done through bypassing firewalls or network detection systems via commonly used ports, using connection proxies to avoid direct connections to the threat group’s infrastructure, employing the command-and-control channel to remotely copy files from an external system, blending in with existing network traffic by using standard application layer protocol, and taking advantage of standard cryptographic protocol to disguise command-and-control traffic. We detected a variant of the Carbanak malware that adds registry entries and keys as an autostart technique. What happens in Carbanak and FIN7 attacks?",
      "domain": "www.trendmicro.com",
      "tokenized": [
        {
          "sent": "Among these cybercriminals are financially motivated threat groups Carbanak and FIN7.",
          "is_evidence": 1,
          "is_repeat": 0
        },
        {
          "sent": "At the collection phase, Carbanak and FIN7 campaigns harvest data from local system sources and through input and screen capture (as performed in a related campaign using the Tirion malware).",
          "is_evidence": 0
        },
        {
          "sent": "In Carbanak attacks, the groups’ attacks can involve logging into services that accept remote connections and using stolen password hashes through the “pass the hash” method.",
          "is_evidence": 1,
          "is_repeat": 0
        },
        {
          "sent":"In both Carbanak and FIN7 attacks, communication with users’ compromised systems is done through bypassing firewalls or network detection systems via commonly used ports, using connection proxies to avoid direct connections to the threat group’s infrastructure, employing the command-and-control channel to remotely copy files from an external system, blending in with existing network traffic by using standard application layer protocol, and taking advantage of standard cryptographic protocol to disguise command-and-control traffic.",
          "is_evidence": 1,
          "is_repeat": 0
        },
        {
          "sent":"We detected a variant of the Carbanak malware that adds registry entries and keys as an autostart technique.",
          "is_evidence": 0
        },
        {
          "sent": "What happens in Carbanak and FIN7 attacks?",
          "is_evidence": 1,
          "is_repeat": 0
        }
      ]
    },
    {
      "link": "https://attack.mitre.org/groups/G0008/",
      "content": "Among these cybercriminals are financially motivated threat groups Carbanak and FIN7. At the collection phase, Carbanak and FIN7 campaigns harvest data from local system sources and through input and screen capture (as performed in a related campaign using the Tirion malware). However, the groups use not just the Carbanak backdoor but also other types of malware such as Pillowmint, a point-of-sale malware, and Tirion, which is said to be geared to replace Carbanak. In Carbanak attacks, the groups’ attacks can involve logging into services that accept remote connections and using stolen password hashes through the “pass the hash” method. In both Carbanak and FIN7 attacks, communication with users’ compromised systems is done through bypassing firewalls or network detection systems via commonly used ports, using connection proxies to avoid direct connections to the threat group’s infrastructure, employing the command-and-control channel to remotely copy files from an external system, blending in with existing network traffic by using standard application layer protocol, and taking advantage of standard cryptographic protocol to disguise command-and-control traffic. We detected a variant of the Carbanak malware that adds registry entries and keys as an autostart technique.",
      "domain": "attack.mitre.org",
      "tokenized": [
        {
          "sent":"Among these cybercriminals are financially motivated threat groups Carbanak and FIN7.",
          "is_evidence": 1,
          "is_repeat": 0
        },
        {
          "sent":"At the collection phase, Carbanak and FIN7 campaigns harvest data from local system sources and through input and screen capture (as performed in a related campaign using the Tirion malware).",
          "is_evidence": 0
        },
        {
          "sent":"However, the groups use not just the Carbanak backdoor but also other types of malware such as Pillowmint, a point-of-sale malware, and Tirion, which is said to be geared to replace Carbanak.",
          "is_evidence": 0
        },
        {
          "sent":"In Carbanak attacks, the groups’ attacks can involve logging into services that accept remote connections and using stolen password hashes through the “pass the hash” method.",
          "is_evidence": 0
        },
        {
          "sent":"In both Carbanak and FIN7 attacks, communication with users’ compromised systems is done through bypassing firewalls or network detection systems via commonly used ports, using connection proxies to avoid direct connections to the threat group’s infrastructure, employing the command-and-control channel to remotely copy files from an external system, blending in with existing network traffic by using standard application layer protocol, and taking advantage of standard cryptographic protocol to disguise command-and-control traffic.",
          "is_evidence": 0
        },
        {
          "sent": "We detected a variant of the Carbanak malware that adds registry entries and keys as an autostart technique.",
          "is_evidence": 0
        }
      ]
    },
    {
      "link": "https://securityintelligence.com/carbanak-how-would-you-have-stopped-a-1-billion-apt-attack/",
      "content": "According to reports on this large-scale APT attack thus far, Carbanak is a very well-orchestrated crime operation, but it is not as sophisticated on a technical level — nor is it impossible to protect against. The attackers did the following: Infected computers attached to ATMs so the machines dispensed cash at the same time the gang’s mules were there to pick it up; Compromised internal Oracle databases, created fraudulent accounts, issued cards and modified account balances to wire out more money each time; Abused the Society for Worldwide Interbank Financial Telecommunication system to move large amounts of money into accounts they controlled; Used the online banking vector for e-pay fraud and fraudulent transactions. The proper operation of bank systems that run proprietary software and specific hardware was compromised because attackers were able to study it. The use of keyloggers and data-stealing malware capabilities provided the hostile watch team with all the necessary access credentials and user rights to eventually launch the next phase of this attack, which included a variety of ways to steal large sums of money from the banks they targeted. To begin, the criminals bought access to bank employee computers that were already compromised by massively distributed opportunistic malware. Unlike the usual cybercriminal method of stealing consumer credentials or compromising individual online banking sessions with malware, the brazen Carbanak gang targeted banks’ internal systems and operations, resulting in a multichannel robbery that averaged $8 million per bank.",
      "domain": "securityintelligence.com",
      "tokenized": [
        {
          "sent":"According to reports on this large-scale APT attack thus far, Carbanak is a very well-orchestrated crime operation, but it is not as sophisticated on a technical level — nor is it impossible to protect against.",
          "is_evidence": 1,
          "is_repeat": 0
        },
        {
          "sent":"The attackers did the following: Infected computers attached to ATMs so the machines dispensed cash at the same time the gang’s mules were there to pick it up; Compromised internal Oracle databases, created fraudulent accounts, issued cards and modified account balances to wire out more money each time; Abused the Society for Worldwide Interbank Financial Telecommunication system to move large amounts of money into accounts they controlled; Used the online banking vector for e-pay fraud and fraudulent transactions.",
          "is_evidence": 0
        },
        {
          "sent":"The proper operation of bank systems that run proprietary software and specific hardware was compromised because attackers were able to study it.",
          "is_evidence": 0
        },
        {
          "sent":"The use of keyloggers and data-stealing malware capabilities provided the hostile watch team with all the necessary access credentials and user rights to eventually launch the next phase of this attack, which included a variety of ways to steal large sums of money from the banks they targeted.",
          "is_evidence": 1,
          "is_repeat": 0
        },
        {
          "sent": "To begin, the criminals bought access to bank employee computers that were already compromised by massively distributed opportunistic malware.",
          "is_evidence": 0
        },
        {
          "sent":"Unlike the usual cybercriminal method of stealing consumer credentials or compromising individual online banking sessions with malware, the brazen Carbanak gang targeted banks’ internal systems and operations, resulting in a multichannel robbery that averaged $8 million per bank.",
          "is_evidence": 0
        }
      ]
    }
  ]
}