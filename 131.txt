{
  "event_id": "131",
  "claim": "Cycldek is an example of an actor that has broader capability than publicly perceived. ",
  "original_label": "true",
  "label": "true",
  "explain": "While investigating attacks related to a group named Cycldek post 2018, we were able to uncover various pieces of information on its activities that were not known thus far. In this blog post we aim to bridge the knowledge gap on this group and provide a more thorough insight into its latest activities and modus operandi. Here are some key insights that will be described in this publication:Cycldek is a long-known Chinese-speaking threat actor. Based on the group’s past activity, it has a strong interest in Southeast Asian targets, with a primary focus on large organizations and government institutions in Vietnam. This is evident from a series of targeted campaigns that are publicly attributed to the group, as outlined below:Most attacks that we observed after 2018 start with a politically themed RTF document built with the 8.t document builder (also known as ‘Royal Road’) and sent as a phishing mail to the victims. These documents are bundled with 1-day exploits (e.g. CVE-2012-0158, CVE-2017-11882, CVE-2018-0802) which in turn run a dropper for three files:The final payload that is run in memory is malware known as NewCore RAT. It is based on an open-source framework named PcShare or PcClient that used to be prevalent in Chinese hacker forums more than a decade ago. Today, the software is fully available on Github, allowing attackers to leverage and modify it for their needs. In the case of Cycldek, the first public accounts of the group’s usage of NewCore date back to 2017. As described in a blog post by Fortinet, the malware provides the attacker with broad capabilities such as conducting a range of operations on files, taking screenshots, controlling the machine via a remote shell and shutting down or restarting the system.When inspecting the NewCore RAT malware delivered during the various attacks we investigated, we were able to distinguish between two variants. Both were deployed as side-loaded DLLs and shared multiple similarities, both in code and behavior. At the same time, we noticed differences that indicate the variants could have been used by different operators. Our analysis shows that the underlying pieces of malware and the way they were used form two clusters of activity. As a result, we named the variants BlueCore and RedCore and examined the artifacts we found around each one in order to profile their related clusters. Notable characteristics of each cluster’s implant are summarized in the table below.As demonstrated by the table, the variants share similar behavior. For example, both use DLL load order hijacking to run code from DLLs impersonating dependencies of legitimate AV utilities and both share a mutex naming convention of random UUIDs, where mutexes are used for synchronization of thread execution. By comparing code in both implants, we can find multiple functions that originate from the PCShare RAT; however, several others (like the injection code in the figure below) are proprietary and demonstrate identical code that may have been written by a shared developer.Moreover, both implants leverage similar injected shellcode used to load the RedCore and BlueCore implants. This shellcode, which resides in the files ‘stdole.tlb’ and ‘msgsm64.acm’, contains a routine used to decrypt the implants’ raw executable from an embedded blob, map it to memory and execute it from its entry point in a new thread. Since both pieces of shellcode are identical for the two variants and cannot be attributed to any open source project, we estimate that they originate from a proprietary shared resource. Having said that, it is also evident that there are differences between the variants. The clearest distinctions can be made by looking at malware functionality that is unique to one type of implant and absent from the other. The following are examples of features that could be found only in RedCore implants, suggesting that despite their similarity with BlueCore, they were likely used by a different entity for different purposes: Perhaps the most notable difference between the two implants is the URL scheme they use to connect and beacon their C&C servers. By looking for requests made using similar URL patterns in our telemetry, we were able to find multiple C&C servers and divide the underlying infrastructure based on the aforementioned two clusters. The requests by each malware type were issued only by legitimate and signed applications that were either leveraged to side-load a malicious DLL or injected with malicious code. All of the discovered domains were used to download further samples. The conclusion that we were able to reach from this is that while all targets were diplomatic and government entities, each cluster of activity had a different geographical focus. The operators behind the BlueCore cluster invested most of their efforts on Vietnamese targets with several outliers in Laos and Thailand, while the operators of the RedCore cluster started out with a focus on Vietnam and diverted to Laos by the end of 2018. The statistics of these activities, based on the number of detected samples we witnessed downloaded from each cluster of C&Cs, are outlined in the figures below.Furthermore, considering both differences and similarities, we are able to conclude that the activities we saw are affiliated to a single actor, which we refer to as Cycldek. In several instances, we spotted unique tools crafted by the group that were downloaded from servers of both groups. One example of this, which can be seen in the figure below, is a tool custom built by the group named USBCulprit. Two samples of it were downloaded from both BlueCore and RedCore servers. A more comprehensive list can be found in the Appendix. All in all, this suggests the entities operating behind those clusters are sharing multiple resources – both code and infrastructure – and operating under a single organizational umbrella. During the analysis, we were able to observe a variety of tools downloaded from both BlueCore and RedCore implants used for either lateral movement in the compromised networks or information stealing from infected nodes. There were several types of these tools – some were proprietary and formerly unseen in the wild; others were pieces of software copied from open-source post-exploitation frameworks, some of which were customized to complete specific tasks by the attackers. As in the cases of RedCore and BlueCore, the downloaded tools were all invoked as side-loaded DLLs of legitimate signed applications. Such applications included AV components like wsc_proxy.exe (Avast remediation service), qcconsol.exe and mcvsshld.exe (McAfee components), as well as legitimate Microsoft and Google utilities like the resource compiler (rc.exe) and Google Updates (googleupdate.exe). These tools could be used in order to bypass weak security mechanisms like application whitelisting, grant the malware additional permissions during execution or complicate incident response. As already mentioned, the bulk of these tools are common and widespread among attackers, sometimes referred to as living-off-the-land binaries, or LOLbins. Such tools can be part of open-source and legitimate software, abused to conduct malicious activities. Examples include BrowserHistoryView (a Nirsoft utility to obtain browsing history from common browsers), ProcDump (Sysinternals tools used to dump memory, possibly to obtain passwords from running processes), Nbtscan (command line utility intended to scan IP networks for NetBIOS information) and PsExec (Sysinternals tools used to execute commands remotely in the network, typically used for lateral movement). The rest of the tools were either developed fully by the attackers or made use of known tools that were customized to accommodate particular attack scenarios. The following are several notable examples: One of the most notable examples in Cycldek’s toolset that demonstrates both data stealing and lateral movement capabilities is a malware we discovered and dubbed USBCulrpit. This tool, which we saw downloaded by RedCore implants in several instances, is capable of scanning various paths in victim machines, collecting documents with particular extensions and passing them on to USB drives when they are connected to the system. It can also selectively copy itself to a removable drive in the presence of a particular file, suggesting it can be spread laterally by having designated drives infected and the executable in them opened manually. During the time the malware was active, it showed little change in functionality. Based on Kaspersky’s telemetry, USBCulprit has been seen in the wild since 2014, with the latest samples emerging at the end of 2019. The most prominent addition incorporated to samples detected after 2017 is the capability to execute files with a given name from a connected USB. This suggests that the malware can be extended with other modules. However, we were not able to capture any such files and their purpose remains unknown. Another change we saw is the loading scheme used for variants spotted after 2017. The older versions made use of a dropper that wrote a configuration file to disk and extracted an embedded cabinet archive containing a legitimate binary and a malicious side-loaded DLL. This was improved in the newer versions, where an additional stage was added, such that the side-loaded DLL decrypts and loads a third file from the archive containing the malicious payload. As a result, the latter can be found in its decrypted form only in memory. This loading scheme demonstrates that the actor behind it makes use of similar TTPs seen in the previously described implants attributed to Cycldek. For example, binaries mimicking AV components are leveraged for conducting DLL load-order hijacking. In this case, one of the files dropped from the cabinet archive named ‘wrapper.exe’ (originally named ‘PtUserSessionWrapper.exe’ and belonging to Trend Micro) forces the execution of a malicious DLL named ‘TmDbgLog.dll’. Also, the malware makes use of an encrypted blob that is decrypted using RC4 and executed using a custom PE loader. The full chain is depicted in the figure below. The chosen files are then grouped into encrypted RAR archives. To achieve that, the malware extracts a ‘rar.exe’ command line utility, hardcoded as a cabinet archive in its binary, and runs it against every list created in the former step. The password for the archive is initialized at the beginning of the malware’s execution, and is set to ‘abcd!@#$’ for most variants that we observed. It is worth noting that sought documents can be filtered by their modification date. Several variants of USBCulprit perform a check for a file named ‘time’ within the directory from which the malware is executed. This file is expected to have a date-time value that specifies the modification timestamp beyond which files are considered of interest and should be collected. If the ‘time’ file doesn’t exist, it is created with the default value ‘20160601000000’ corresponding to 01/06/2016 00:00:00. When a USB is connected, the malware will verify if stolen data should be exfiltrated to it or it already contains existing data that should be copied locally. To do this, a directory named ‘$Recyc1e.Bin’ will be searched in the drive and if not found, will be created. This directory will be used as the target path for copying files to the drive or source path for obtaining them from it. To understand which direction of file copy should take place, a special marker file named ‘1.txt’ is searched locally. If it exists, the malware would expect to find the aforementioned ‘$Recyc1e.Bin’ directory in the drive with previously stolen document archives and attempt to copy it to the disk. Otherwise, the local archive files will be copied to the same directory from the disk to the drive. The characteristics of the malware can give rise to several assumptions about its purpose and use cases, one of which is to reach and obtain data from air-gapped machines. This would explain the lack of any network communication in the malware, and the use of only removable media as a means of transferring inbound and outbound data. Also, we witnessed some variants issue commands to gather various pieces of host network information. These are logged to a file that is later transferred along with the stolen data to the USB and can help attackers profile whether the machine in which the malware was executed is indeed part of a segregated network. Another explanation is that the malware was handled manually by operators on the ground. As mentioned earlier, there is no evident mechanism for automatically executing USBCulprit from infected media, and yet we saw that the same sample was executed from various drive locations, suggesting it was indeed spread around. This, along with the very specific files that the malware seeks as executable extensions and could not be found as artifacts elsewhere in our investigation, point to a human factor being required to assist deployment of the malware in victim networks.Cycldek is an example of an actor that has broader capability than publicly perceived. While most known descriptions of its activity give the impression of a marginal group with sub-par capabilities, the range of tools and timespan of operations show that the group has an extensive foothold inside the networks of high-profile targets in Southeast Asia. Furthermore, our analysis of the implants affiliated to the group give an insight into its organizational structure. As already stated, the similarities and differences in various traits of these pieces of malware indicate that they likely originated from different arms of a single organization. Perhaps it’s worth noting that we noted multiple points where such entities didn’t work in a well-coordinated manner, for example, infecting machines using the BlueCore implant when they were already infected with RedCore. Lastly, we believe that such attacks will continue in Southeast Asian countries. The use of different tools to reach air-gapped networks in the same countries and attempts to steal data from them have been witnessed in the past. Our analysis shows this type of activity has not ceased – it has merely evolved and changed shape, in terms of malware and actors. We continue to track the actor and report on its activity in our Threat Intelligence Portal.\n\n\n",
  "reports": [
    {
      "link": "https://www.crowdstrike.com/blog/meet-crowdstrikes-adversary-of-the-month-for-august-goblin-panda/",
      "content": "Analysis of command and control infrastructure suggests that GOBLIN PANDA is targeting entities in Laos, as well. As part of this campaign, new exploit documents were identified with Vietnamese-language lures and themes, as well as Vietnam-themed, adversary-controlled infrastructure. Decoy content displayed in these incidents used Vietnamese-language Microsoft Office Word documents with training-related themes. This actor focuses a significant amount of its targeting activity on entities in Southeast Asia, particularly Vietnam. Two exploit documents with Vietnamese-language file names were observed with file metadata unique to the GOBLIN PANDA adversary. When opened, both documents use CVE-2012-0158 exploit code to drop malicious files associated with a previously identified side-loading malware implant, tracked as QCRat by CrowdStrike Falcon® Intelligence™.",
      "domain": "www.crowdstrike.com",
      "tokenized": [
        {
          "sent": "Analysis of command and control infrastructure suggests that GOBLIN PANDA is targeting entities in Laos, as well.",
          "is_evidence": 1,
          "is_repeat": 0
        },
        {
          "sent":"As part of this campaign, new exploit documents were identified with Vietnamese-language lures and themes, as well as Vietnam-themed, adversary-controlled infrastructure.",
          "is_evidence": 0
        },
        {
          "sent":  "Decoy content displayed in these incidents used Vietnamese-language Microsoft Office Word documents with training-related themes.",
          "is_evidence": 0
        },
        {
          "sent":"This actor focuses a significant amount of its targeting activity on entities in Southeast Asia, particularly Vietnam.",
          "is_evidence": 0
        },
        {
          "sent": "Two exploit documents with Vietnamese-language file names were observed with file metadata unique to the GOBLIN PANDA adversary.",
          "is_evidence": 0
        },
        {
          "sent": "When opened, both documents use CVE-2012-0158 exploit code to drop malicious files associated with a previously identified side-loading malware implant, tracked as QCRat by CrowdStrike Falcon® Intelligence™.",
          "is_evidence": 0
        }
      ]
    },
    {
      "link": "https://medium.com/@Sebdraven/gobelin-panda-against-the-bears-1f462d00e3a4/",
      "content": "103.255.45.200 Theses addresses can permit to found others domains: Sd123.eicp.net with new IP 180.131.58.9 and cv3sa.gicp.net with new IP 1.188.233.201.Goblin Panda used Sisfader RAT to target the Telecom Firms russian with the same exploitation techniques for Vietnameses Officials. And the infrastructure is very interesting this domains resolved on three IPs: 122.158.140.100, 122.158.140.100 and. During my last investigation (here), I’ve found two RTFs malware documents with the same techniques of exploitation of CVE-2017– 11882:With the behaviour graph of Joe Sandbox, we can recognize the same interactions with operating system than my last article and the paper of NCC Group. If we check the domain contacted by EQNEDT32.exe is kmbk8.hicp.net. They updated theirs technics than the report of NCC group.",
      "domain": "medium.com",
      "tokenized": [
        {
          "sent":"103.255.45.200 Theses addresses can permit to found others domains: Sd123.eicp.net with new IP 180.131.58.9 and cv3sa.gicp.net with new IP 1.188.233.201.Goblin Panda used Sisfader RAT to target the Telecom Firms russian with the same exploitation techniques for Vietnameses Officials.",
          "is_evidence": 1,
          "is_repeat": 0
        },
        {
          "sent":"And the infrastructure is very interesting this domains resolved on three IPs: 122.158.140.100, 122.158.140.100 and",
          "is_evidence": 0
        },
        {
          "sent":"During my last investigation (here), I’ve found two RTFs malware documents with the same techniques of exploitation of CVE-2017– 11882:With the behaviour graph of Joe Sandbox, we can recognize the same interactions with operating system than my last article and the paper of NCC Group.",
          "is_evidence": 1,
          "is_repeat": 0
        },
        {
          "sent":"If we check the domain contacted by EQNEDT32.exe is kmbk8.hicp.net.",
          "is_evidence": 1,
          "is_repeat": 0
        },
        {
          "sent":"They updated theirs technics than the report of NCC group.",
          "is_evidence": 0
        },
        {
          "sent":"This address is a real good pivot.",
          "is_evidence": 1,
          "is_repeat": 0
        }
      ]
    },
    {
      "link": "https://sebdraven.medium.com/goblin-panda-targets-cambodia-sharing-capacities-with-another-chinese-group-hackers-temp-periscope-7871382ffcc0/",
      "content": "And like Vietnamese, it’s the exploit toolset and drops the same rat. Goblin Panda against the Bears During my last investigation (here), I’ve found two RTFs malware documents with the same techniques of exploitation of…medium.com. The c2 that is contacted by the dll is weather.gbaycruise.com has the same IP used during the Vietnamese campaign 103.193.4.106. The rtfs documents for dropping the backdoor has build by the same exploit rtf kits used by Goblin Panda and all domains are registered in NAMECHEAP INC. This IP has many overlaps with domains using another IP 103.193.4.115 used by the Vietnamese campaign. This post deals with only the Cambodia The first document 9d0c4ec62abe79e754eaa2fd7696f98441bc783781d8656065cddfae3dbf503e is a rtf and uses the same technics to drop on disk a legit file 77361b1ca09d6857d68cea052a0bb857e03d776d3e1943897315a80a19f20fc2 and a new core RAT. 4a5bf0df9ee222dac87e2f1b38b18660ebb92de8ba3f1cbc845f945a766dd6a6.",
      "domain": "sebdraven.medium.com",
      "tokenized": [
        {
          "sent": "And like Vietnamese, it’s the exploit toolset and drops the same rat.",
          "is_evidence": 1,
          "is_repeat": 0
        },
        {
          "sent":"Goblin Panda against the Bears During my last investigation (here), I’ve found two RTFs malware documents with the same techniques of exploitation of…medium.com",
          "is_evidence": 0
        },
        {
          "sent":"The c2 that is contacted by the dll is weather.gbaycruise.com has the same IP used during the Vietnamese campaign 103.193.4.106.",
          "is_evidence": 0
        },
        {
          "sent": "The rtfs documents for dropping the backdoor has build by the same exploit rtf kits used by Goblin Panda and all domains are registered in NAMECHEAP INC.",
          "is_evidence": 0
        },
        {
          "sent":"This IP has many overlaps with domains using another IP 103.193.4.115 used by the Vietnamese campaign.",
          "is_evidence": 0
        },
        {
          "sent": "This post deals with only the Cambodia The first document 9d0c4ec62abe79e754eaa2fd7696f98441bc783781d8656065cddfae3dbf503e is a rtf and uses the same technics to drop on disk a legit file 77361b1ca09d6857d68cea052a0bb857e03d776d3e1943897315a80a19f20fc2 and a new core RAT. 4a5bf0df9ee222dac87e2f1b38b18660ebb92de8ba3f1cbc845f945a766dd6a6.",
          "is_evidence": 0
        }
      ]
    },
    {
      "link": "https://sebdraven.medium.com/malicious-document-targets-vietnamese-officials-acb3b9d8b80a/",
      "content": "In this article, we’ll detail the infection chains and the infrastructures of the attackers and the TTPs of this campaign. The Chinese hacking group 1937CN continues to target Vietnam officials with the same TTPs with a refreshing on the tools used. The infrastructures and TTPs during this campaign seem to the Chinese hacking group 1937CN.Joe sandbox has a good representation of the behaviour of the infection. The offset where store the file is 00434EF8 and the pe decompressed is stored at 025D0020Expansion of domains There are two domains really interesting: Halong.dulichculao.com is already used in the campaign targeting Vietnameses organizations. The toolset used by this group to create RTF malicious document has the same properpy of the SideWinder. We found a document written in Vietnamese dealing with a summary about differents projects in the district Hải Châu of Đà Nẵng.",
      "domain": "https://sebdraven.medium.com/malicious-document-targets-vietnamese-officials-acb3b9d8b80a",
      "tokenized": [
        {
          "sent":"In this article, we’ll detail the infection chains and the infrastructures of the attackers and the TTPs of this campaign.",
          "is_evidence": 1,
          "is_repeat": 0
        },
        {
          "sent": "The Chinese hacking group 1937CN continues to target Vietnam officials with the same TTPs with a refreshing on the tools used.",
          "is_evidence": 0
        },
        {
          "sent": "The infrastructures and TTPs during this campaign seem to the Chinese hacking group 1937CN.Joe sandbox has a good representation of the behaviour of the infection.",
          "is_evidence": 0
        },
        {
          "sent": "The offset where store the file is 00434EF8 and the pe decompressed is stored at 025D0020Expansion of domains There are two domains really interesting: Halong.dulichculao.com is already used in the campaign targeting Vietnameses organizations.",
          "is_evidence": 1,
          "is_repeat": 0
        },
        {
          "sent":"The toolset used by this group to create RTF malicious document has the same properpy of the SideWinder.",
          "is_evidence": 0
        },
        {
          "sent":"We found a document written in Vietnamese dealing with a summary about differents projects in the district Hải Châu of Đà Nẵng.",
          "is_evidence": 1,
          "is_repeat": 0
        }
      ]
    }
  ]
}