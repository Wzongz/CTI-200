{
    "event_id": "024",
    "claim": "The advanced persistent threat (APT) APT34 group with a new malware variant accompanying a phishing attack comparatively similar to the SideTwist backdoor malware. Following the campaign, the group abused a fake license registration form of an African government agency to target a victim in Saudi Arabia.",
    "original_label": "true",
    "label": "true",
    "explain": "We analyzed a new malware, which we attribute to the APT34 advanced persistent threat (APT) group, that was involved in a phishing attack. In August, our threat hunting activities identified a malicious document we investigated to have been used during a targeted phishing attack by the group. The malicious document is responsible for dropping a new malware we have called Menorah (taken from the malicious document’s dropped executable, detected by Trend Micro as Trojan.W97M.SIDETWIST.AB), and for creating a scheduled task for persistence. The malware was designed for cyberespionage, capable of identifying the machine, reading and uploading files from the machine, and downloading another file or malware. During our investigation, there was little information about the victims targeted by this malware. But the file that APT34 used for this attack is called “MyCv.doc,” a license registration form related to the Seychelles Licensing Authority. However, we noted that the document contained pricing information in Saudi Riyal, which might indicate that the targeted victim was an organization inside the Kingdom of Saudi Arabia. This blog post provides an analysis of the group’s latest malware and its capabilities, shows the attack process, and details the attackers’ infrastructure. APT34 is a covert cyberespionage group that specializes in targeting organizations and illicit activities within the Middle East. As we’ve previously covered, APT34 primarily focuses on collecting sensitive intelligence, employing spear phishing campaigns, and abusing advanced techniques to infiltrate and maintain access within targeted networks. Our monitoring suggests this group operates with a high degree of sophistication and seemingly vast resources, posing a significant cybersecurity challenge regionally and beyond. Notably, APT34 has been involved in high-profile cyberattacks against a diverse range of targets in the Middle East, including government agencies, critical infrastructure, telecommunications, and key regional entities. The group consistently develops and enhances tools, aiming to reduce security solutions and researchers’ detection. In this research on APT34, we observed the group transitioning to the employment of novel data exfiltration methods. Researchers from NSFOCUS published a report on a new variant of the SideTwist malware utilized by APT34. The infection starts with a malicious document dropping a hardcoded malware and creates a scheduled task for persistence once the targeted victim opens the document. The malicious document contains hidden macros responsible for dropping a .NET malware into the <%ALLUSERSPROFILE%\\Office356> directory, naming it Menorah.exe. It then creates a scheduled task named “”OneDriveStandaloneUpdater” to execute the Menorah.exe malware. The image in Figure 2 shows a portion of the macros' functions responsible for string transformation, decoding, and the creation of the scheduled task. The .NET-written malware delivered through the malicious document is primarily deployed for cyberespionage and possesses multifaceted capabilities. The malware can fingerprint the targeted machine, list directories and files, upload selected files from the compromised system, execute shell commends, and download files to the system. Compared to the previous variant of SideTwist, the new variant has more functions to hash the traffic to the command and control (C&C) server and make it stealthier to avoid detection. Initially, the malware conducts a specific argument check during execution to ensure the correct flow of its operations. In the absence of the specified argument, the malware will terminate and stop its execution. The regular check ensures the routine’s and components’ stealth, and detects if the malware is in an analytic environment like a sandbox. If the argument determines that it’s running inside a sandbox, the malware will run without the argument and terminate itself. We identified the C&C server, http[:]//tecforsc-001-site1[.]gtempurl.com/ads.asp, as a string subsequently used for HTTP communication and to create a timer to repeat a specific code every 32,000 milliseconds (or every 32 seconds) as a way to organize communication with the C&C server. Then, the malware fingerprints the machine by getting the machine name and username in this format: {MachineNameUsername}. The malware continues to encode the string into ASCII then calculates for the MD5 hash from it. The MD5 hash is combined with the {MachineNameUsername} in the format {‘d@{MD5 hash}@MachineName|Username} XOR with a hardcoded string and encoded in Base64, creating a fingerprint for the compromised system. This fingerprint is sent to the C&C server as the content of an HTTP request, as shown in the figure below. Unfortunately, the C&C server was inactive at the time of analysis. However, from the analysis for functions responsible for parsing the C&C, we expected that the response returned will be an encrypted massage and further encoded in Base64. The decrypted and decoded message split into an array, and each value inside it represents part of the message received from the C&C server. Based on these values, the malware will have specific actions on the machine. From static analysis, we observed the malware capable of executing a command received from the C&C server, list directory and files on the compromised system, and upload specific files to server and download files. The following are the malware’s commands, values, and actions: In 2021, Checkpoint published an article about SideTwist malware written in native language. After comparing both malware variants, we found that there are significant similarities between the two in terms of functionality, especially in the way the malware fingerprints the compromised system and C&C communication. Moreover, SideTwist malware uses the computer name and username to create the unique ID for the victim machine, but the variant in 2021 uses a 4-byte hash instead of MD5 during the ID creation. Both malware variants provide similar backdoor functionalities to execute the shell command, as well as upload and download files. The similarities to the SideTwist backdoor suggests that APT34 is in continuous-development mode, changing up and trying which routines and techniques will work. Typical of APT groups, APT34 demonstrates their vast resources and varied skills, and will likely persist in customizing routines and social engineering techniques to use per targeted organization to ensure success in intrusions, stealth, and cyber espionage. The earlier variant of SideTwist is written in C, and this latest variant has a very similar set of functions but in a .NET implementation. While the techniques and malware infection routine in this sample are not on the same level of sophistication as the previously documented attacks of the group, the techniques still work as they continue to redo and depend on them. As previous reports on APT34 have noted, the group uses simple routines and changes that, for security analysts and researchers, don’t take long to track and analyze. But the group’s arsenal and skills enable them to rapidly create new pieces of malware and tools, allowing the group to continuously deploy in successive cycles. Organizations should continuously warn and keep their employees aware of the different techniques that attackers employ to target systems, proprietary, and personal information.\n\n\n",
    "reports": [
        {
            "link": "https://nsfocusglobal.com/apt34-unleashes-new-wave-of-phishing-attack-with-variant-of-sidetwist-trojan/",
            "content":   "During the campaign, APT34 attackers disguised as a marketing services company called GGMS launched attacks against enterprise targets and released a variant of SideTwist Trojan to achieve long-term control of the victim host. In this event, APT34 followed an attack process that has been in use since 2021, but with some variations in details. Recently, NSFOCUS Security Labs captured a new APT34 phishing attack. The called Trojan program SystemFailureReporter.exe is a variant of SideTwist, the main Trojan tool used by APT34 in recent operations. The malicious macro then creates a scheduled task called SystemFailureReporter that calls up the Trojan every 5 minutes, through which it runs repeatedly. The variant Trojan presented in this campaign is similar to the SideTwist Trojan used by APT34 in previous campaigns, with the main difference that it is compiled using GCC.",
            "domain": "nsfocusglobal.com",
            "tokenized": [
                {
                    "sent":   "During the campaign, APT34 attackers disguised as a marketing services company called GGMS launched attacks against enterprise targets and released a variant of SideTwist Trojan to achieve long-term control of the victim host.",
                    "is_evidence": 1,
                    "is_repeat": 0
                },
                {
                    "sent":  "In this event, APT34 followed an attack process that has been in use since 2021, but with some variations in details.",
                    "is_evidence": 0
                },
                {
                    "sent": "Recently, NSFOCUS Security Labs captured a new APT34 phishing attack.",
                    "is_evidence": 0
                },
                {
                    "sent": "The called Trojan program SystemFailureReporter.exe is a variant of SideTwist, the main Trojan tool used by APT34 in recent operations.",
                    "is_evidence": 0
                },
                {
                    "sent":  "The malicious macro then creates a scheduled task called SystemFailureReporter that calls up the Trojan every 5 minutes, through which it runs repeatedly.",
                    "is_evidence": 0
                },
                {
                    "sent":  "The variant Trojan presented in this campaign is similar to the SideTwist Trojan used by APT34 in previous campaigns, with the main difference that it is compiled using GCC.",
                     "is_evidence": 0
                }
            ]
        },
        {
            "link": "https://therecord.media/oilrig-apt34-iran-linked-hackers-new-downloaders-israel/",
            "content": "A cyber-espionage group linked to the Iranian government developed several new malware downloaders over the past two years and has recently been using them to target organizations in Israel. ESET researchers labeled the three new malware downloaders as ODAgent, OilCheck and OilBooster. OilRig typically uses the malware to send in other malicious software and exfiltrate files. Researchers at the Slovakia-based company ESET attributed the newly discovered downloaders to the Iranian advanced persistent threat group OilRig, also known as APT34. The hackers also released an updated version of their previous downloader, dubbed SampleCheck5000. The researchers couldn’t identify the initial attack vector used by hackers to compromise Israeli networks.",
            "domain": "therecord.media",
            "tokenized": [
                {
                    "sent":  "A cyber-espionage group linked to the Iranian government developed several new malware downloaders over the past two years and has recently been using them to target organizations in Israel.",
                    "is_evidence": 1,
                    "is_repeat": 0
                },
                {
                    "sent":  "ESET researchers labeled the three new malware downloaders as ODAgent, OilCheck and OilBooster.",
                    "is_evidence": 0
                },
                {
                    "sent": "OilRig typically uses the malware to send in other malicious software and exfiltrate files.",
                    "is_evidence": 1,
                    "is_repeat": 0
                },
                {
                    "sent":  "Researchers at the Slovakia-based company ESET attributed the newly discovered downloaders to the Iranian advanced persistent threat group OilRig, also known as APT34.",
                    "is_evidence": 1,
                    "is_repeat": 0
                },
                {
                    "sent":  "The hackers also released an updated version of their previous downloader, dubbed SampleCheck5000.",
                    "is_evidence": 1,
                    "is_repeat": 0
                },
                {
                    "sent":   "The researchers couldn’t identify the initial attack vector used by hackers to compromise Israeli networks.",
                    "is_evidence": 1,
                    "is_repeat": 0
                }
            ]
        },
        {
            "link": "https://www.darkreading.com/cyberattacks-data-breaches/iran-apt34-uae-supply-chain-attack/",
            "content":  "APT34 (aka OilRig) created a fake website to masquerade as an IT company in the UAE, sent the recruitment form to a target IT company, and when the victim opened the malicious document to presumably apply for the advertised IT job, info-stealing malware executed. According to research by Mandiant, APT34 has been operational since at least 2014, uses a mix of public and nonpublic tools, often conducting spear-phishing operations using compromised accounts, sometimes coupled with social engineering tactics. According to the research by Kaspersky, the malware samples used in the UAE campaign resembled those used in a previous APT34 supply chain intrusion in Jordan that used similar tactics, techniques, and procedures (TTPs), including targeting government entities. Actions From a Repeat Cyberattack Offender APT34 is an Iranian threat group operating primarily in the Middle East by targeting organizations in this region that are in a variety of different industries. The Iran-linked advanced persistent threat known as APT34 is at it again, this time mounting a supply chain attack with the ultimate goal of gaining access to government targets inside the United Arab Emirates (UAE). Yamout says the malware collected sensitive information and credentials that allowed APT34 to access the IT company clients' networks.",
            "domain": "www.darkreading.com",
            "tokenized": [
                {
                    "sent": "APT34 (aka OilRig) created a fake website to masquerade as an IT company in the UAE, sent the recruitment form to a target IT company, and when the victim opened the malicious document to presumably apply for the advertised IT job, info-stealing malware executed.",
                    "is_evidence": 1,
                    "is_repeat": 0
                },
                {
                    "sent":"According to research by Mandiant, APT34 has been operational since at least 2014, uses a mix of public and nonpublic tools, often conducting spear-phishing operations using compromised accounts, sometimes coupled with social engineering tactics.",
                    "is_evidence": 0
                },
                {
                    "sent": "According to the research by Kaspersky, the malware samples used in the UAE campaign resembled those used in a previous APT34 supply chain intrusion in Jordan that used similar tactics, techniques, and procedures (TTPs), including targeting government entities.",
                    "is_evidence": 0
                },
                {
                    "sent": "Actions From a Repeat Cyberattack Offender APT34 is an Iranian threat group operating primarily in the Middle East by targeting organizations in this region that are in a variety of different industries.",
                    "is_evidence": 0
                },
                {
                    "sent":  "The Iran-linked advanced persistent threat known as APT34 is at it again, this time mounting a supply chain attack with the ultimate goal of gaining access to government targets inside the United Arab Emirates (UAE).",
                    "is_evidence": 0
                },
                {
                    "sent":  "Yamout says the malware collected sensitive information and credentials that allowed APT34 to access the IT company clients' networks.",
                    "is_evidence": 0
                }
            ]
         },
         {
            "link": "https://www.trendmicro.com/en_us/research/23/b/new-apt34-malware-targets-the-middle-east.html/",
            "content":  "Documented as a group primarily involved for cyberespionage, APT34 has been previously recorded targeting government offices and show no signs of stopping with their intrusions. From three previously documented attacks, we observed that while the group uses simple malware families, these deployments show the group's flexibility to write new malware based on researched customer environments and levels of access. On December 2022, we identified a suspicious executable (detected by Trend Micro as Trojan.MSIL.REDCAP.AD) that was dropped and executed on multiple machines. Our investigation led us to link this attack to advanced persistent threat (APT) group APT34, and the main goal is to steal users’ credentials. There are several data points and indicators that suggest APT34 carried out this attack, and that this group is still active in targeting countries in the Middle East with a special focus on compromising government entities. dropper malware called MrPerfectInstaller (detected by Trend Micro as Trojan.MSIL.REDCAP.AD) responsible for dropping four different files, with each component stored in a Base64 buffer inside the main dropper.",
            "domain": "www.trendmicro.com",
            "tokenized": [
                {
                    "sent":  "Documented as a group primarily involved for cyberespionage, APT34 has been previously recorded targeting government offices and show no signs of stopping with their intrusions.",
                    "is_evidence": 1,
                    "is_repeat": 0
                },
                {
                    "sent":  "From three previously documented attacks, we observed that while the group uses simple malware families, these deployments show the group's flexibility to write new malware based on researched customer environments and levels of access.",
                    "is_evidence": 0
                },
                {
                    "sent":  "On December 2022, we identified a suspicious executable (detected by Trend Micro as Trojan.MSIL.REDCAP.AD) that was dropped and executed on multiple machines.",
                    "is_evidence": 0
                },
                {
                    "sent":  "Our investigation led us to link this attack to advanced persistent threat (APT) group APT34, and the main goal is to steal users’ credentials.",
                    "is_evidence": 0
                },
                {
                    "sent":   "There are several data points and indicators that suggest APT34 carried out this attack, and that this group is still active in targeting countries in the Middle East with a special focus on compromising government entities.",
                    "is_evidence": 0
                },
                {
                    "sent":  "dropper malware called MrPerfectInstaller (detected by Trend Micro as Trojan.MSIL.REDCAP.AD) responsible for dropping four different files, with each component stored in a Base64 buffer inside the main dropper.",
                    "is_evidence": 0
                }
            ]
        }
    ]
}